import{S as Sx,i as Ax,s as Px,e as oe,t as dr,c as ae,a as Me,h as pr,d as de,b as Ot,g as Xs,J as Ft,K as Dn,j as Lx,k as Nr,m as br,L as Gr,n as Md,M as Mx,N as Dx,w as Fx,O as Nx,P as Wl}from"../chunks/index-3eeb7155.js";var bx=function(){function i(){this.disposed=!1}return i.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},i.prototype.disposeInternal=function(){},i}(),Lh=bx;function Gx(i,e,t){for(var n,r,o=t||Si,u=0,l=i.length,h=!1;u<l;)n=u+(l-u>>1),r=+o(i[n],e),r<0?u=n+1:(l=n,h=!r);return h?u:~u}function Si(i,e){return i>e?1:i<e?-1:0}function Xl(i,e){return i.indexOf(e)>=0}function Mh(i,e,t){var n=i.length;if(i[0]<=e)return 0;if(e<=i[n-1])return n-1;var r=void 0;if(t>0){for(r=1;r<n;++r)if(i[r]<e)return r-1}else if(t<0){for(r=1;r<n;++r)if(i[r]<=e)return r}else for(r=1;r<n;++r){if(i[r]==e)return r;if(i[r]<e)return typeof t=="function"?t(e,i[r-1],i[r])>0?r-1:r:i[r-1]-e<e-i[r]?r-1:r}return n-1}function kx(i,e,t){for(;e<t;){var n=i[e];i[e]=i[t],i[t]=n,++e,--t}}function Nn(i,e){for(var t=Array.isArray(e)?e:[e],n=t.length,r=0;r<n;r++)i[i.length]=t[r]}function bi(i,e){var t=i.length;if(t!==e.length)return!1;for(var n=0;n<t;n++)if(i[n]!==e[n])return!1;return!0}function Ux(i,e,t){var n=e||Si;return i.every(function(r,o){if(o===0)return!0;var u=n(i[o-1],r);return!(u>0||t&&u===0)})}function $r(){return!0}function Ca(){return!1}function Ai(){}function Wx(i){var e=!1,t,n,r;return function(){var o=Array.prototype.slice.call(arguments);return(!e||this!==r||!bi(o,n))&&(e=!0,r=this,n=o,t=i.apply(this,arguments)),t}}function ot(){return function(){throw new Error("Unimplemented abstract method.")}()}var Xx=0;function Mt(i){return i.ol_uid||(i.ol_uid=String(++Xx))}var Bx="6.14.1",Qr=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"?navigator.userAgent.toLowerCase():"",Yx=Qr.indexOf("firefox")!==-1,Zx=Qr.indexOf("safari")!==-1&&Qr.indexOf("chrom")==-1;Zx&&(Qr.indexOf("version/15.4")>=0||Qr.match(/cpu (os|iphone os) 15_4 like mac os x/));var zx=Qr.indexOf("webkit")!==-1&&Qr.indexOf("edge")==-1,jx=Qr.indexOf("macintosh")!==-1,bp=typeof devicePixelRatio!="undefined"?devicePixelRatio:1,_u=typeof WorkerGlobalScope!="undefined"&&typeof OffscreenCanvas!="undefined"&&self instanceof WorkerGlobalScope,Vx=typeof Image!="undefined"&&Image.prototype.decode,Gp=function(){var i=!1;try{var e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return i}(),Kx=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hx=function(i){Kx(e,i);function e(t){var n=this,r="v"+Bx.split("-")[0],o="Assertion failed. See https://openlayers.org/en/"+r+"/doc/errors/#"+t+" for details.";return n=i.call(this,o)||this,n.code=t,n.name="AssertionError",n.message=o,n}return e}(Error),kp=Hx;function Pt(i,e){if(!i)throw new kp(e)}new Array(6);function jn(){return[1,0,0,1,0,0]}function $x(i,e,t,n,r,o,u){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i[4]=o,i[5]=u,i}function qx(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i}function pe(i,e){var t=e[0],n=e[1];return e[0]=i[0]*t+i[2]*n+i[4],e[1]=i[1]*t+i[3]*n+i[5],e}function Jx(i,e,t){return $x(i,e,0,0,t,0,0)}function Tr(i,e,t,n,r,o,u,l){var h=Math.sin(o),c=Math.cos(o);return i[0]=n*c,i[1]=r*h,i[2]=-n*h,i[3]=r*c,i[4]=u*n*c-l*n*h+e,i[5]=u*r*h+l*r*c+t,i}function Dh(i,e){var t=Qx(e);Pt(t!==0,32);var n=e[0],r=e[1],o=e[2],u=e[3],l=e[4],h=e[5];return i[0]=u/t,i[1]=-r/t,i[2]=-o/t,i[3]=n/t,i[4]=(o*h-u*l)/t,i[5]=-(n*h-r*l)/t,i}function Qx(i){return i[0]*i[3]-i[1]*i[2]}var Dd;function Up(i){var e="matrix("+i.join(", ")+")";if(_u)return e;var t=Dd||(Dd=document.createElement("div"));return t.style.transform=e,t.style.transform}var na={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Re={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Fd(i){for(var e=En(),t=0,n=i.length;t<n;++t)sa(e,i[t]);return e}function Fh(i,e,t){return t?(t[0]=i[0]-e,t[1]=i[1]-e,t[2]=i[2]+e,t[3]=i[3]+e,t):[i[0]-e,i[1]-e,i[2]+e,i[3]+e]}function Wp(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i.slice()}function Gi(i,e,t){var n,r;return e<i[0]?n=i[0]-e:i[2]<e?n=e-i[2]:n=0,t<i[1]?r=i[1]-t:i[3]<t?r=t-i[3]:r=0,n*n+r*r}function Ia(i,e){return Nh(i,e[0],e[1])}function vo(i,e){return i[0]<=e[0]&&e[2]<=i[2]&&i[1]<=e[1]&&e[3]<=i[3]}function Nh(i,e,t){return i[0]<=e&&e<=i[2]&&i[1]<=t&&t<=i[3]}function rh(i,e){var t=i[0],n=i[1],r=i[2],o=i[3],u=e[0],l=e[1],h=Re.UNKNOWN;return u<t?h=h|Re.LEFT:u>r&&(h=h|Re.RIGHT),l<n?h=h|Re.BELOW:l>o&&(h=h|Re.ABOVE),h===Re.UNKNOWN&&(h=Re.INTERSECTING),h}function En(){return[1/0,1/0,-1/0,-1/0]}function xr(i,e,t,n,r){return r?(r[0]=i,r[1]=e,r[2]=t,r[3]=n,r):[i,e,t,n]}function Oa(i){return xr(1/0,1/0,-1/0,-1/0,i)}function tw(i,e){var t=i[0],n=i[1];return xr(t,n,t,n,e)}function Xp(i,e,t,n,r){var o=Oa(r);return Yp(o,i,e,t,n)}function la(i,e){return i[0]==e[0]&&i[2]==e[2]&&i[1]==e[1]&&i[3]==e[3]}function Bp(i,e){return e[0]<i[0]&&(i[0]=e[0]),e[2]>i[2]&&(i[2]=e[2]),e[1]<i[1]&&(i[1]=e[1]),e[3]>i[3]&&(i[3]=e[3]),i}function sa(i,e){e[0]<i[0]&&(i[0]=e[0]),e[0]>i[2]&&(i[2]=e[0]),e[1]<i[1]&&(i[1]=e[1]),e[1]>i[3]&&(i[3]=e[1])}function Yp(i,e,t,n,r){for(;t<n;t+=r)ew(i,e[t],e[t+1]);return i}function ew(i,e,t){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}function Zp(i,e){var t;return t=e(gu(i)),t||(t=e(yu(i)),t)||(t=e(mu(i)),t)||(t=e(ki(i)),t)?t:!1}function ih(i){var e=0;return bh(i)||(e=se(i)*bn(i)),e}function gu(i){return[i[0],i[1]]}function yu(i){return[i[2],i[1]]}function Pi(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function nw(i,e){var t;return e===na.BOTTOM_LEFT?t=gu(i):e===na.BOTTOM_RIGHT?t=yu(i):e===na.TOP_LEFT?t=ki(i):e===na.TOP_RIGHT?t=mu(i):Pt(!1,13),t}function oh(i,e,t,n,r){var o=e*n[0]/2,u=e*n[1]/2,l=Math.cos(t),h=Math.sin(t),c=o*l,d=o*h,_=u*l,v=u*h,y=i[0],m=i[1],w=y-c+v,C=y-c-v,P=y+c-v,I=y+c+v,A=m-d-_,L=m-d+_,F=m+d+_,U=m+d-_;return xr(Math.min(w,C,P,I),Math.min(A,L,F,U),Math.max(w,C,P,I),Math.max(A,L,F,U),r)}function bn(i){return i[3]-i[1]}function ua(i,e,t){var n=t||En();return Ke(i,e)?(i[0]>e[0]?n[0]=i[0]:n[0]=e[0],i[1]>e[1]?n[1]=i[1]:n[1]=e[1],i[2]<e[2]?n[2]=i[2]:n[2]=e[2],i[3]<e[3]?n[3]=i[3]:n[3]=e[3]):Oa(n),n}function ki(i){return[i[0],i[3]]}function mu(i){return[i[2],i[3]]}function se(i){return i[2]-i[0]}function Ke(i,e){return i[0]<=e[2]&&i[2]>=e[0]&&i[1]<=e[3]&&i[3]>=e[1]}function bh(i){return i[2]<i[0]||i[3]<i[1]}function rw(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i}function iw(i,e,t){var n=!1,r=rh(i,e),o=rh(i,t);if(r===Re.INTERSECTING||o===Re.INTERSECTING)n=!0;else{var u=i[0],l=i[1],h=i[2],c=i[3],d=e[0],_=e[1],v=t[0],y=t[1],m=(y-_)/(v-d),w=void 0,C=void 0;!!(o&Re.ABOVE)&&!(r&Re.ABOVE)&&(w=v-(y-c)/m,n=w>=u&&w<=h),!n&&!!(o&Re.RIGHT)&&!(r&Re.RIGHT)&&(C=y-(v-h)*m,n=C>=l&&C<=c),!n&&!!(o&Re.BELOW)&&!(r&Re.BELOW)&&(w=v-(y-l)/m,n=w>=u&&w<=h),!n&&!!(o&Re.LEFT)&&!(r&Re.LEFT)&&(C=y-(v-u)*m,n=C>=l&&C<=c)}return n}function ow(i,e){var t=e.getExtent(),n=Pi(i);if(e.canWrapX()&&(n[0]<t[0]||n[0]>=t[2])){var r=se(t),o=Math.floor((n[0]-t[0])/r),u=o*r;i[0]-=u,i[2]-=u}return i}function _e(i,e,t){return Math.min(Math.max(i,e),t)}var aw=function(){var i;return"cosh"in Math?i=Math.cosh:i=function(e){var t=Math.exp(e);return(t+1/t)/2},i}(),sw=function(){var i;return"log2"in Math?i=Math.log2:i=function(e){return Math.log(e)*Math.LOG2E},i}();function uw(i,e,t,n,r,o){var u=r-t,l=o-n;if(u!==0||l!==0){var h=((i-t)*u+(e-n)*l)/(u*u+l*l);h>1?(t=r,n=o):h>0&&(t+=u*h,n+=l*h)}return Ci(i,e,t,n)}function Ci(i,e,t,n){var r=t-i,o=n-e;return r*r+o*o}function lw(i){for(var e=i.length,t=0;t<e;t++){for(var n=t,r=Math.abs(i[t][t]),o=t+1;o<e;o++){var u=Math.abs(i[o][t]);u>r&&(r=u,n=o)}if(r===0)return null;var l=i[n];i[n]=i[t],i[t]=l;for(var h=t+1;h<e;h++)for(var c=-i[h][t]/i[t][t],d=t;d<e+1;d++)t==d?i[h][d]=0:i[h][d]+=c*i[t][d]}for(var _=new Array(e),v=e-1;v>=0;v--){_[v]=i[v][e]/i[v][v];for(var y=v-1;y>=0;y--)i[y][e]-=i[y][v]*_[v]}return _}function Bs(i){return i*Math.PI/180}function yo(i,e){var t=i%e;return t*e<0?t+e:t}function gr(i,e,t){return i+t*(e-i)}function zp(i,e){var t=Math.pow(10,e);return Math.round(i*t)/t}function Ss(i,e){return Math.floor(zp(i,e))}function As(i,e){return Math.ceil(zp(i,e))}var hw=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,fw=/^([a-z]*)$|^hsla?\(.*\)$/i;function jp(i){return typeof i=="string"?i:Vp(i)}function cw(i){var e=document.createElement("div");if(e.style.color=i,e.style.color!==""){document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}else return""}var dw=function(){var i=1024,e={},t=0;return function(n){var r;if(e.hasOwnProperty(n))r=e[n];else{if(t>=i){var o=0;for(var u in e)(o++&3)===0&&(delete e[u],--t)}r=pw(n),e[n]=r,++t}return r}}();function Ys(i){return Array.isArray(i)?i:dw(i)}function pw(i){var e,t,n,r,o;if(fw.exec(i)&&(i=cw(i)),hw.exec(i)){var u=i.length-1,l=void 0;u<=4?l=1:l=2;var h=u===4||u===8;e=parseInt(i.substr(1+0*l,l),16),t=parseInt(i.substr(1+1*l,l),16),n=parseInt(i.substr(1+2*l,l),16),h?r=parseInt(i.substr(1+3*l,l),16):r=255,l==1&&(e=(e<<4)+e,t=(t<<4)+t,n=(n<<4)+n,h&&(r=(r<<4)+r)),o=[e,t,n,r/255]}else i.indexOf("rgba(")==0?(o=i.slice(5,-1).split(",").map(Number),Nd(o)):i.indexOf("rgb(")==0?(o=i.slice(4,-1).split(",").map(Number),o.push(1),Nd(o)):Pt(!1,14);return o}function Nd(i){return i[0]=_e(i[0]+.5|0,0,255),i[1]=_e(i[1]+.5|0,0,255),i[2]=_e(i[2]+.5|0,0,255),i[3]=_e(i[3],0,1),i}function Vp(i){var e=i[0];e!=(e|0)&&(e=e+.5|0);var t=i[1];t!=(t|0)&&(t=t+.5|0);var n=i[2];n!=(n|0)&&(n=n+.5|0);var r=i[3]===void 0?1:Math.round(i[3]*100)/100;return"rgba("+e+","+t+","+n+","+r+")"}var vw=function(){function i(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return i.prototype.clear=function(){this.cache_={},this.cacheSize_=0},i.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},i.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var n=this.cache_[t];(e++&3)===0&&!n.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}},i.prototype.get=function(e,t,n){var r=bd(e,t,n);return r in this.cache_?this.cache_[r]:null},i.prototype.set=function(e,t,n,r){var o=bd(e,t,n);this.cache_[o]=r,++this.cacheSize_},i.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},i}();function bd(i,e,t){var n=t?jp(t):"null";return e+":"+i+":"+n}var Zs=new vw,_w=function(){function i(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return i.prototype.preventDefault=function(){this.defaultPrevented=!0},i.prototype.stopPropagation=function(){this.propagationStopped=!0},i}(),xn=_w,Eo={PROPERTYCHANGE:"propertychange"},ve=typeof Object.assign=="function"?Object.assign:function(i,e){if(i==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(i),n=1,r=arguments.length;n<r;++n){var o=arguments[n];if(o!=null)for(var u in o)o.hasOwnProperty(u)&&(t[u]=o[u])}return t};function Co(i){for(var e in i)delete i[e]}var Kp=typeof Object.values=="function"?Object.values:function(i){var e=[];for(var t in i)e.push(i[t]);return e};function To(i){var e;for(e in i)return!1;return!e}var gw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),yw=function(i){gw(e,i);function e(t){var n=i.call(this)||this;return n.eventTarget_=t,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return e.prototype.addEventListener=function(t,n){if(!(!t||!n)){var r=this.listeners_||(this.listeners_={}),o=r[t]||(r[t]=[]);o.indexOf(n)===-1&&o.push(n)}},e.prototype.dispatchEvent=function(t){var n=typeof t=="string",r=n?t:t.type,o=this.listeners_&&this.listeners_[r];if(!!o){var u=n?new xn(t):t;u.target||(u.target=this.eventTarget_||this);var l=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});r in l||(l[r]=0,h[r]=0),++l[r];for(var c,d=0,_=o.length;d<_;++d)if("handleEvent"in o[d]?c=o[d].handleEvent(u):c=o[d].call(this,u),c===!1||u.propagationStopped){c=!1;break}if(--l[r]===0){var v=h[r];for(delete h[r];v--;)this.removeEventListener(r,Ai);delete l[r]}return c}},e.prototype.disposeInternal=function(){this.listeners_&&Co(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,n){var r=this.listeners_&&this.listeners_[t];if(r){var o=r.indexOf(n);o!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(r[o]=Ai,++this.pendingRemovals_[t]):(r.splice(o,1),r.length===0&&delete this.listeners_[t]))}},e}(Lh),Io=yw,yt={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Gt(i,e,t,n,r){if(n&&n!==i&&(t=t.bind(n)),r){var o=t;t=function(){i.removeEventListener(e,t),o.apply(this,arguments)}}var u={target:i,type:e,listener:t};return i.addEventListener(e,t),u}function zs(i,e,t,n){return Gt(i,e,t,n,!0)}function qt(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),Co(i))}var mw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Eu=function(i){mw(e,i);function e(){var t=i.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(yt.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,n){if(Array.isArray(t)){for(var r=t.length,o=new Array(r),u=0;u<r;++u)o[u]=Gt(this,t[u],n);return o}else return Gt(this,t,n)},e.prototype.onceInternal=function(t,n){var r;if(Array.isArray(t)){var o=t.length;r=new Array(o);for(var u=0;u<o;++u)r[u]=zs(this,t[u],n)}else r=zs(this,t,n);return n.ol_key=r,r},e.prototype.unInternal=function(t,n){var r=n.ol_key;if(r)Ew(r);else if(Array.isArray(t))for(var o=0,u=t.length;o<u;++o)this.removeEventListener(t[o],n);else this.removeEventListener(t,n)},e}(Io);Eu.prototype.on;Eu.prototype.once;Eu.prototype.un;function Ew(i){if(Array.isArray(i))for(var e=0,t=i.length;e<t;++e)qt(i[e]);else qt(i)}var Hp=Eu,$p=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gd=function(i){$p(e,i);function e(t,n,r){var o=i.call(this,t)||this;return o.key=n,o.oldValue=r,o}return e}(xn),Tw=function(i){$p(e,i);function e(t){var n=i.call(this)||this;return n.on,n.once,n.un,Mt(n),n.values_=null,t!==void 0&&n.setProperties(t),n}return e.prototype.get=function(t){var n;return this.values_&&this.values_.hasOwnProperty(t)&&(n=this.values_[t]),n},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&ve({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,n){var r;r="change:".concat(t),this.hasListener(r)&&this.dispatchEvent(new Gd(r,t,n)),r=Eo.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new Gd(r,t,n))},e.prototype.addChangeListener=function(t,n){this.addEventListener("change:".concat(t),n)},e.prototype.removeChangeListener=function(t,n){this.removeEventListener("change:".concat(t),n)},e.prototype.set=function(t,n,r){var o=this.values_||(this.values_={});if(r)o[t]=n;else{var u=o[t];o[t]=n,u!==n&&this.notify(t,u)}},e.prototype.setProperties=function(t,n){for(var r in t)this.set(r,t[r],n)},e.prototype.applyProperties=function(t){!t.values_||ve(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,n){if(this.values_&&t in this.values_){var r=this.values_[t];delete this.values_[t],To(this.values_)&&(this.values_=null),n||this.notify(t,r)}},e}(Hp),Gn=Tw,Bt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"},xw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ww=function(i){xw(e,i);function e(t){var n=i.call(this)||this;n.on,n.once,n.un,n.background_=t.background;var r=ve({},t);return typeof t.properties=="object"&&(delete r.properties,ve(r,t.properties)),r[Bt.OPACITY]=t.opacity!==void 0?t.opacity:1,Pt(typeof r[Bt.OPACITY]=="number",64),r[Bt.VISIBLE]=t.visible!==void 0?t.visible:!0,r[Bt.Z_INDEX]=t.zIndex,r[Bt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,r[Bt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,r[Bt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,r[Bt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,n.className_=r.className!==void 0?r.className:"ol-layer",delete r.className,n.setProperties(r),n.state_=null,n}return e.prototype.getBackground=function(){return this.background_},e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var n=this.state_||{layer:this,managed:t===void 0?!0:t},r=this.getZIndex();return n.opacity=_e(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=r===void 0&&!n.managed?1/0:r,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n},e.prototype.getLayersArray=function(t){return ot()},e.prototype.getLayerStatesArray=function(t){return ot()},e.prototype.getExtent=function(){return this.get(Bt.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(Bt.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(Bt.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(Bt.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(Bt.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(Bt.OPACITY)},e.prototype.getSourceState=function(){return ot()},e.prototype.getVisible=function(){return this.get(Bt.VISIBLE)},e.prototype.getZIndex=function(){return this.get(Bt.Z_INDEX)},e.prototype.setBackground=function(t){this.background_=t,this.changed()},e.prototype.setExtent=function(t){this.set(Bt.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(Bt.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(Bt.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(Bt.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(Bt.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){Pt(typeof t=="number",64),this.set(Bt.OPACITY,t)},e.prototype.setVisible=function(t){this.set(Bt.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(Bt.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),i.prototype.disposeInternal.call(this)},e}(Gn),qp=ww,qr={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},ti={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},Rw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Cw=function(i){Rw(e,i);function e(t){var n=this,r=ve({},t);delete r.source,n=i.call(this,r)||this,n.on,n.once,n.un,n.mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,n.rendered=!1,t.render&&(n.render=t.render),t.map&&n.setMap(t.map),n.addChangeListener(Bt.SOURCE,n.handleSourcePropertyChange_);var o=t.source?t.source:null;return n.setSource(o),n}return e.prototype.getLayersArray=function(t){var n=t||[];return n.push(this),n},e.prototype.getLayerStatesArray=function(t){var n=t||[];return n.push(this.getLayerState()),n},e.prototype.getSource=function(){return this.get(Bt.SOURCE)||null},e.prototype.getRenderSource=function(){return this.getSource()},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():ti.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(qt(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Gt(t,yt.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(n){return n([])})},e.prototype.getData=function(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)},e.prototype.render=function(t,n){var r=this.getRenderer();if(r.prepareFrame(t))return this.rendered=!0,r.renderFrame(t,n)},e.prototype.unrender=function(){this.rendered=!1},e.prototype.setMapInternal=function(t){t||this.unrender(),this.set(Bt.MAP,t)},e.prototype.getMapInternal=function(){return this.get(Bt.MAP)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(qt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(qt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Gt(t,qr.PRECOMPOSE,function(n){var r=n,o=r.frameState.layerStatesArray,u=this.getLayerState(!1);Pt(!o.some(function(l){return l.layer===u.layer}),67),o.push(u)},this),this.mapRenderKey_=Gt(this,yt.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Bt.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),i.prototype.disposeInternal.call(this)},e}(qp);function js(i,e){if(!i.visible)return!1;var t=e.resolution;if(t<i.minResolution||t>=i.maxResolution)return!1;var n=e.zoom;return n>i.minZoom&&n<=i.maxZoom}var Sa=Cw;function Iw(i,e){return i[0]+=+e[0],i[1]+=+e[1],i}function Vs(i,e){for(var t=!0,n=i.length-1;n>=0;--n)if(i[n]!=e[n]){t=!1;break}return t}function Gh(i,e){var t=Math.cos(e),n=Math.sin(e),r=i[0]*t-i[1]*n,o=i[1]*t+i[0]*n;return i[0]=r,i[1]=o,i}function Ow(i,e){return i[0]*=e,i[1]*=e,i}function Jp(i,e){if(e.canWrapX()){var t=se(e.getExtent()),n=Sw(i,e,t);n&&(i[0]-=n*t)}return i}function Sw(i,e,t){var n=e.getExtent(),r=0;if(e.canWrapX()&&(i[0]<n[0]||i[0]>n[2])){var o=t||se(n);r=Math.floor((i[0]-n[0])/o)}return r}var Aw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Pw=function(i){Aw(e,i);function e(t){var n=i.call(this)||this;return n.map_=t,n}return e.prototype.dispatchRenderEvent=function(t,n){ot()},e.prototype.calculateMatrices2D=function(t){var n=t.viewState,r=t.coordinateToPixelTransform,o=t.pixelToCoordinateTransform;Tr(r,t.size[0]/2,t.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),Dh(o,r)},e.prototype.forEachFeatureAtCoordinate=function(t,n,r,o,u,l,h,c){var d,_=n.viewState;function v(H,Q,K,nt){return u.call(l,Q,H?K:null,nt)}var y=_.projection,m=Jp(t.slice(),y),w=[[0,0]];if(y.canWrapX()&&o){var C=y.getExtent(),P=se(C);w.push([-P,0],[P,0])}for(var I=n.layerStatesArray,A=I.length,L=[],F=[],U=0;U<w.length;U++)for(var G=A-1;G>=0;--G){var X=I[G],B=X.layer;if(B.hasRenderer()&&js(X,_)&&h.call(c,B)){var Z=B.getRenderer(),j=B.getSource();if(Z&&j){var V=j.getWrapX()?m:t,tt=v.bind(null,X.managed);F[0]=V[0]+w[U][0],F[1]=V[1]+w[U][1],d=Z.forEachFeatureAtCoordinate(F,n,r,tt,L)}if(d)return d}}if(L.length!==0){var rt=1/L.length;return L.forEach(function(H,Q){return H.distanceSq+=Q*rt}),L.sort(function(H,Q){return H.distanceSq-Q.distanceSq}),L.some(function(H){return d=H.callback(H.feature,H.layer,H.geometry)}),d}},e.prototype.forEachLayerAtPixel=function(t,n,r,o,u){return ot()},e.prototype.hasFeatureAtCoordinate=function(t,n,r,o,u,l){var h=this.forEachFeatureAtCoordinate(t,n,r,o,$r,this,u,l);return h!==void 0},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){ot()},e.prototype.scheduleExpireIconCache=function(t){Zs.canExpireCache()&&t.postRenderFunctions.push(Lw)},e}(Lh);function Lw(i,e){Zs.expire()}var Mw=Pw,Dw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fw=function(i){Dw(e,i);function e(t,n,r,o){var u=i.call(this,t)||this;return u.inversePixelTransform=n,u.frameState=r,u.context=o,u}return e}(xn),Qp=Fw,Ps="ol-hidden",Tu="ol-unselectable",kh="ol-control",kd="ol-collapsed",Nw=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Ud=["style","variant","weight","size","lineHeight","family"],tv=function(i){var e=i.match(Nw);if(!e)return null;for(var t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},n=0,r=Ud.length;n<r;++n){var o=e[n+1];o!==void 0&&(t[Ud[n]]=o)}return t.families=t.family.split(/,\s?/),t};function ev(i){return i===1?"":String(Math.round(i*100)/100)}function Tn(i,e,t,n){var r;return t&&t.length?r=t.shift():_u?r=new OffscreenCanvas(i||300,e||300):r=document.createElement("canvas"),i&&(r.width=i),e&&(r.height=e),r.getContext("2d",n)}function Wd(i,e){var t=e.parentNode;t&&t.replaceChild(i,e)}function ah(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function bw(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function Gw(i,e){for(var t=i.childNodes,n=0;;++n){var r=t[n],o=e[n];if(!r&&!o)break;if(r!==o){if(!r){i.appendChild(o);continue}if(!o){i.removeChild(r),--n;continue}i.insertBefore(o,r)}}}var nv="10px sans-serif",yr="#000",Ks="round",ha=[],fa=0,xo="round",ca=10,da="#000",pa="center",Hs="middle",Ti=[0,0,0,0],va=1,vr=new Gn,kw=new Io;kw.setSize=function(){console.warn("labelCache is deprecated.")};var lo=null,sh,uh={},Uw=function(){var i=100,e="32px ",t=["monospace","serif"],n=t.length,r="wmytzilWMYTZIL@#/&?$%10\uF013",o,u;function l(c,d,_){for(var v=!0,y=0;y<n;++y){var m=t[y];if(u=$s(c+" "+d+" "+e+m,r),_!=m){var w=$s(c+" "+d+" "+e+_+","+m,r);v=v&&w!=u}}return!!v}function h(){for(var c=!0,d=vr.getKeys(),_=0,v=d.length;_<v;++_){var y=d[_];vr.get(y)<i&&(l.apply(this,y.split(`
`))?(Co(uh),lo=null,sh=void 0,vr.set(y,i)):(vr.set(y,vr.get(y)+1,!0),c=!1))}c&&(clearInterval(o),o=void 0)}return function(c){var d=tv(c);if(!!d)for(var _=d.families,v=0,y=_.length;v<y;++v){var m=_[v],w=d.style+`
`+d.weight+`
`+m;vr.get(w)===void 0&&(vr.set(w,i,!0),l(d.style,d.weight,m)||(vr.set(w,0,!0),o===void 0&&(o=setInterval(h,32))))}}}(),Ww=function(){var i;return function(e){var t=uh[e];if(t==null){if(_u){var n=tv(e),r=rv(e,"\u017Dg"),o=isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight);t=o*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=e,document.body.appendChild(i),t=i.offsetHeight,document.body.removeChild(i);uh[e]=t}return t}}();function rv(i,e){return lo||(lo=Tn(1,1)),i!=sh&&(lo.font=i,sh=lo.font),lo.measureText(e)}function $s(i,e){return rv(i,e).width}function Xd(i,e,t){if(e in t)return t[e];var n=$s(i,e);return t[e]=n,n}function Xw(i,e){for(var t=[],n=[],r=[],o=0,u=0,l=0,h=0,c=0,d=e.length;c<=d;c+=2){var _=e[c];if(_===`
`||c===d){o=Math.max(o,u),r.push(u),u=0,l+=h;continue}var v=e[c+1]||i.font,y=$s(v,_);t.push(y),u+=y;var m=Ww(v);n.push(m),h=Math.max(h,m)}return{width:o,height:l,widths:t,heights:n,lineWidths:r}}function Bw(i,e,t,n,r,o,u,l,h,c,d){i.save(),t!==1&&(i.globalAlpha*=t),e&&i.setTransform.apply(i,e),n.contextInstructions?(i.translate(h,c),i.scale(d[0],d[1]),Yw(n,i)):d[0]<0||d[1]<0?(i.translate(h,c),i.scale(d[0],d[1]),i.drawImage(n,r,o,u,l,0,0,u,l)):i.drawImage(n,r,o,u,l,h,c,u*d[0],l*d[1]),i.restore()}function Yw(i,e){for(var t=i.contextInstructions,n=0,r=t.length;n<r;n+=2)Array.isArray(t[n+1])?e[t[n]].apply(e,t[n+1]):e[t[n]]=t[n+1]}var Zw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zw=function(i){Zw(e,i);function e(t){var n=i.call(this,t)||this;n.fontChangeListenerKey_=Gt(vr,Eo.PROPERTYCHANGE,t.redrawText.bind(t)),n.element_=document.createElement("div");var r=n.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",n.element_.className=Tu+" ol-layers";var o=t.getViewport();return o.insertBefore(n.element_,o.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return e.prototype.dispatchRenderEvent=function(t,n){var r=this.getMap();if(r.hasListener(t)){var o=new Qp(t,void 0,n);r.dispatchEvent(o)}},e.prototype.disposeInternal=function(){qt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),i.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(qr.PRECOMPOSE,t);var n=t.layerStatesArray.sort(function(y,m){return y.zIndex-m.zIndex}),r=t.viewState;this.children_.length=0;for(var o=[],u=null,l=0,h=n.length;l<h;++l){var c=n[l];t.layerIndex=l;var d=c.layer,_=d.getSourceState();if(!js(c,r)||_!=ti.READY&&_!=ti.UNDEFINED){d.unrender();continue}var v=d.render(t,u);!v||(v!==u&&(this.children_.push(v),u=v),"getDeclutter"in d&&o.push(d))}for(var l=o.length-1;l>=0;--l)o[l].renderDeclutter(t);Gw(this.element_,this.children_),this.dispatchRenderEvent(qr.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)},e.prototype.forEachLayerAtPixel=function(t,n,r,o,u){for(var l=n.viewState,h=n.layerStatesArray,c=h.length,d=c-1;d>=0;--d){var _=h[d],v=_.layer;if(v.hasRenderer()&&js(_,l)&&u(v)){var y=v.getRenderer(),m=y.getDataAtPixel(t,n,r);if(m){var w=o(v,m);if(w)return w}}}},e}(Mw),jw=zw,Ce={ADD:"add",REMOVE:"remove"},iv=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bd={LENGTH:"length"},Ls=function(i){iv(e,i);function e(t,n,r){var o=i.call(this,t)||this;return o.element=n,o.index=r,o}return e}(xn),Vw=function(i){iv(e,i);function e(t,n){var r=i.call(this)||this;r.on,r.once,r.un;var o=n||{};if(r.unique_=!!o.unique,r.array_=t||[],r.unique_)for(var u=0,l=r.array_.length;u<l;++u)r.assertUnique_(r.array_[u],u);return r.updateLength_(),r}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var n=0,r=t.length;n<r;++n)this.push(t[n]);return this},e.prototype.forEach=function(t){for(var n=this.array_,r=0,o=n.length;r<o;++r)t(n[r],r,n)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Bd.LENGTH)},e.prototype.insertAt=function(t,n){this.unique_&&this.assertUnique_(n),this.array_.splice(t,0,n),this.updateLength_(),this.dispatchEvent(new Ls(Ce.ADD,n,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var n=this.getLength();return this.insertAt(n,t),this.getLength()},e.prototype.remove=function(t){for(var n=this.array_,r=0,o=n.length;r<o;++r)if(n[r]===t)return this.removeAt(r)},e.prototype.removeAt=function(t){var n=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ls(Ce.REMOVE,n,t)),n},e.prototype.setAt=function(t,n){var r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(n,t);var o=this.array_[t];this.array_[t]=n,this.dispatchEvent(new Ls(Ce.REMOVE,o,t)),this.dispatchEvent(new Ls(Ce.ADD,n,t))}else{for(var u=r;u<t;++u)this.insertAt(u,void 0);this.insertAt(t,n)}},e.prototype.updateLength_=function(){this.set(Bd.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,n){for(var r=0,o=this.array_.length;r<o;++r)if(this.array_[r]===t&&r!==n)throw new kp(58)},e}(Gn),sn=Vw,ov=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zr=function(i){ov(e,i);function e(t,n){var r=i.call(this,t)||this;return r.layer=n,r}return e}(xn),Bl={LAYERS:"layers"},Kw=function(i){ov(e,i);function e(t){var n=this,r=t||{},o=ve({},r);delete o.layers;var u=r.layers;return n=i.call(this,o)||this,n.on,n.once,n.un,n.layersListenerKeys_=[],n.listenerKeys_={},n.addChangeListener(Bl.LAYERS,n.handleLayersChanged_),u?Array.isArray(u)?u=new sn(u.slice(),{unique:!0}):Pt(typeof u.getArray=="function",43):u=new sn(void 0,{unique:!0}),n.setLayers(u),n}return e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(qt),this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(Gt(t,Ce.ADD,this.handleLayersAdd_,this),Gt(t,Ce.REMOVE,this.handleLayersRemove_,this));for(var n in this.listenerKeys_)this.listenerKeys_[n].forEach(qt);Co(this.listenerKeys_);for(var r=t.getArray(),o=0,u=r.length;o<u;o++){var l=r[o];this.registerLayerListeners_(l),this.dispatchEvent(new Zr("addlayer",l))}this.changed()},e.prototype.registerLayerListeners_=function(t){var n=[Gt(t,Eo.PROPERTYCHANGE,this.handleLayerChange_,this),Gt(t,yt.CHANGE,this.handleLayerChange_,this)];t instanceof e&&n.push(Gt(t,"addlayer",this.handleLayerGroupAdd_,this),Gt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Mt(t)]=n},e.prototype.handleLayerGroupAdd_=function(t){this.dispatchEvent(new Zr("addlayer",t.layer))},e.prototype.handleLayerGroupRemove_=function(t){this.dispatchEvent(new Zr("removelayer",t.layer))},e.prototype.handleLayersAdd_=function(t){var n=t.element;this.registerLayerListeners_(n),this.dispatchEvent(new Zr("addlayer",n)),this.changed()},e.prototype.handleLayersRemove_=function(t){var n=t.element,r=Mt(n);this.listenerKeys_[r].forEach(qt),delete this.listenerKeys_[r],this.dispatchEvent(new Zr("removelayer",n)),this.changed()},e.prototype.getLayers=function(){return this.get(Bl.LAYERS)},e.prototype.setLayers=function(t){var n=this.getLayers();if(n)for(var r=n.getArray(),o=0,u=r.length;o<u;++o)this.dispatchEvent(new Zr("removelayer",r[o]));this.set(Bl.LAYERS,t)},e.prototype.getLayersArray=function(t){var n=t!==void 0?t:[];return this.getLayers().forEach(function(r){r.getLayersArray(n)}),n},e.prototype.getLayerStatesArray=function(t){var n=t!==void 0?t:[],r=n.length;this.getLayers().forEach(function(d){d.getLayerStatesArray(n)});var o=this.getLayerState(),u=o.zIndex;!t&&o.zIndex===void 0&&(u=0);for(var l=r,h=n.length;l<h;l++){var c=n[l];c.opacity*=o.opacity,c.visible=c.visible&&o.visible,c.maxResolution=Math.min(c.maxResolution,o.maxResolution),c.minResolution=Math.max(c.minResolution,o.minResolution),c.minZoom=Math.max(c.minZoom,o.minZoom),c.maxZoom=Math.min(c.maxZoom,o.maxZoom),o.extent!==void 0&&(c.extent!==void 0?c.extent=ua(c.extent,o.extent):c.extent=o.extent),c.zIndex===void 0&&(c.zIndex=u)}return n},e.prototype.getSourceState=function(){return ti.READY},e}(qp),xu=Kw,Hw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$w=function(i){Hw(e,i);function e(t,n,r){var o=i.call(this,t)||this;return o.map=n,o.frameState=r!==void 0?r:null,o}return e}(xn),ho=$w,qw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Jw=function(i){qw(e,i);function e(t,n,r,o,u){var l=i.call(this,t,n,u)||this;return l.originalEvent=r,l.pixel_=null,l.coordinate_=null,l.dragging=o!==void 0?o:!1,l}return Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){i.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){i.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(ho),Br=Jw,jt={SINGLECLICK:"singleclick",CLICK:yt.CLICK,DBLCLICK:yt.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},lh={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Qw=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),t1=function(i){Qw(e,i);function e(t,n){var r=i.call(this,t)||this;r.map_=t,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=n===void 0?1:n,r.down_=null;var o=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=o,r.pointerdownListenerKey_=Gt(o,lh.POINTERDOWN,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=Gt(o,lh.POINTERMOVE,r.relayEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(yt.TOUCHMOVE,r.boundHandleTouchMove_,Gp?{passive:!1}:!1),r}return e.prototype.emulateClick_=function(t){var n=new Br(jt.CLICK,this.map_,t);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new Br(jt.DBLCLICK,this.map_,t),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var r=new Br(jt.SINGLECLICK,this.map_,t);this.dispatchEvent(r)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var n=t;n.type==jt.POINTERUP||n.type==jt.POINTERCANCEL?delete this.trackedTouches_[n.pointerId]:n.type==jt.POINTERDOWN&&(this.trackedTouches_[n.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var n=new Br(jt.POINTERUP,this.map_,t);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_===0&&(this.dragListenerKeys_.forEach(qt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return t.button===0},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_===0,this.updateActivePointers_(t);var n=new Br(jt.POINTERDOWN,this.map_,t);this.dispatchEvent(n),this.down_={};for(var r in t){var o=t[r];this.down_[r]=typeof o=="function"?Ai:o}if(this.dragListenerKeys_.length===0){var u=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Gt(u,jt.POINTERMOVE,this.handlePointerMove_,this),Gt(u,jt.POINTERUP,this.handlePointerUp_,this),Gt(this.element_,jt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==u&&this.dragListenerKeys_.push(Gt(this.element_.getRootNode(),jt.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var n=new Br(jt.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(n)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var n=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new Br(t.type,this.map_,t,n))},e.prototype.handleTouchMove_=function(t){var n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(qt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(yt.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(qt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(qt),this.dragListenerKeys_.length=0,this.element_=null,i.prototype.disposeInternal.call(this)},e}(Io),e1=t1,Yr={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},De={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},qs=1/0,n1=function(){function i(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return i.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Co(this.queuedElements_)},i.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,n=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var r=this.keyFunction_(n);return delete this.queuedElements_[r],n},i.prototype.enqueue=function(e){Pt(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=qs?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},i.prototype.getCount=function(){return this.elements_.length},i.prototype.getLeftChildIndex_=function(e){return e*2+1},i.prototype.getRightChildIndex_=function(e){return e*2+2},i.prototype.getParentIndex_=function(e){return e-1>>1},i.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)},i.prototype.isEmpty=function(){return this.elements_.length===0},i.prototype.isKeyQueued=function(e){return e in this.queuedElements_},i.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},i.prototype.siftUp_=function(e){for(var t=this.elements_,n=this.priorities_,r=t.length,o=t[e],u=n[e],l=e;e<r>>1;){var h=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),d=c<r&&n[c]<n[h]?c:h;t[e]=t[d],n[e]=n[d],e=d}t[e]=o,n[e]=u,this.siftDown_(l,e)},i.prototype.siftDown_=function(e,t){for(var n=this.elements_,r=this.priorities_,o=n[t],u=r[t];t>e;){var l=this.getParentIndex_(t);if(r[l]>u)n[t]=n[l],r[t]=r[l],t=l;else break}n[t]=o,r[t]=u},i.prototype.reprioritize=function(){var e=this.priorityFunction_,t=this.elements_,n=this.priorities_,r=0,o=t.length,u,l,h;for(l=0;l<o;++l)u=t[l],h=e(u),h==qs?delete this.queuedElements_[this.keyFunction_(u)]:(n[r]=h,t[r++]=u);t.length=r,n.length=r,this.heapify_()},i}(),r1=n1,ht={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},i1=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),o1=function(i){i1(e,i);function e(t,n){var r=i.call(this,function(o){return t.apply(null,o)},function(o){return o[0].getKey()})||this;return r.boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=n,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return e.prototype.enqueue=function(t){var n=i.prototype.enqueue.call(this,t);if(n){var r=t[0];r.addEventListener(yt.CHANGE,this.boundHandleTileChange_)}return n},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var n=t.target,r=n.getState();if(r===ht.LOADED||r===ht.ERROR||r===ht.EMPTY){n.removeEventListener(yt.CHANGE,this.boundHandleTileChange_);var o=n.getKey();o in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[o],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,n){for(var r=0,o,u,l;this.tilesLoading_<t&&r<n&&this.getCount()>0;)u=this.dequeue()[0],l=u.getKey(),o=u.getState(),o===ht.IDLE&&!(l in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[l]=!0,++this.tilesLoading_,++r,u.load())},e}(r1),a1=o1;function s1(i,e,t,n,r){if(!i||!(t in i.wantedTiles)||!i.wantedTiles[t][e.getKey()])return qs;var o=i.viewState.center,u=n[0]-o[0],l=n[1]-o[1];return 65536*Math.log(r)+Math.sqrt(u*u+l*l)/r}var Y={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Oo={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Kn={};Kn[Oo.RADIANS]=6370997/(2*Math.PI);Kn[Oo.DEGREES]=2*Math.PI*6370997/360;Kn[Oo.FEET]=.3048;Kn[Oo.METERS]=1;Kn[Oo.USFEET]=1200/3937;var mr=Oo,Fe={ANIMATING:0,INTERACTING:1},Ln={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},u1=42,Uh=256,l1=function(){function i(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return i.prototype.canWrapX=function(){return this.canWrapX_},i.prototype.getCode=function(){return this.code_},i.prototype.getExtent=function(){return this.extent_},i.prototype.getUnits=function(){return this.units_},i.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Kn[this.units_]},i.prototype.getWorldExtent=function(){return this.worldExtent_},i.prototype.getAxisOrientation=function(){return this.axisOrientation_},i.prototype.isGlobal=function(){return this.global_},i.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},i.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},i.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},i.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},i.prototype.setWorldExtent=function(e){this.worldExtent_=e},i.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},i.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},i}(),av=l1,h1=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Aa=6378137,_o=Math.PI*Aa,f1=[-_o,-_o,_o,_o],c1=[-180,-85,180,85],Ms=Aa*Math.log(Math.tan(Math.PI/2)),oo=function(i){h1(e,i);function e(t){return i.call(this,{code:t,units:mr.METERS,extent:f1,global:!0,worldExtent:c1,getPointResolution:function(n,r){return n/aw(r[1]/Aa)}})||this}return e}(av),Yd=[new oo("EPSG:3857"),new oo("EPSG:102100"),new oo("EPSG:102113"),new oo("EPSG:900913"),new oo("http://www.opengis.net/def/crs/EPSG/0/3857"),new oo("http://www.opengis.net/gml/srs/epsg.xml#3857")];function d1(i,e,t){var n=i.length,r=t>1?t:2,o=e;o===void 0&&(r>2?o=i.slice():o=new Array(n));for(var u=0;u<n;u+=r){o[u]=_o*i[u]/180;var l=Aa*Math.log(Math.tan(Math.PI*(+i[u+1]+90)/360));l>Ms?l=Ms:l<-Ms&&(l=-Ms),o[u+1]=l}return o}function p1(i,e,t){var n=i.length,r=t>1?t:2,o=e;o===void 0&&(r>2?o=i.slice():o=new Array(n));for(var u=0;u<n;u+=r)o[u]=180*i[u]/_o,o[u+1]=360*Math.atan(Math.exp(i[u+1]/Aa))/Math.PI-90;return o}var v1=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_1=6378137,Zd=[-180,-90,180,90],g1=Math.PI*_1/180,_i=function(i){v1(e,i);function e(t,n){return i.call(this,{code:t,units:mr.DEGREES,extent:Zd,axisOrientation:n,global:!0,metersPerUnit:g1,worldExtent:Zd})||this}return e}(av),zd=[new _i("CRS:84"),new _i("EPSG:4326","neu"),new _i("urn:ogc:def:crs:OGC:1.3:CRS84"),new _i("urn:ogc:def:crs:OGC:2:84"),new _i("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new _i("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new _i("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],hh={};function y1(i){return hh[i]||hh[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function m1(i,e){hh[i]=e}var mo={};function Js(i,e,t){var n=i.getCode(),r=e.getCode();n in mo||(mo[n]={}),mo[n][r]=t}function E1(i,e){var t;return i in mo&&e in mo[i]&&(t=mo[i][e]),t}var T1=63710088e-1;function jd(i,e,t){var n=t||T1,r=Bs(i[1]),o=Bs(e[1]),u=(o-r)/2,l=Bs(e[0]-i[0])/2,h=Math.sin(u)*Math.sin(u)+Math.sin(l)*Math.sin(l)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}var fh=!0;function sv(i){var e=i===void 0?!0:i;fh=!e}function Wh(i,e,t){var n;if(e!==void 0){for(var r=0,o=i.length;r<o;++r)e[r]=i[r];n=e}else n=i.slice();return n}function uv(i,e,t){if(e!==void 0&&i!==e){for(var n=0,r=i.length;n<r;++n)e[n]=i[n];i=e}return i}function x1(i){m1(i.getCode(),i),Js(i,i,Wh)}function w1(i){i.forEach(x1)}function me(i){return typeof i=="string"?y1(i):i||null}function Vd(i,e,t,n){i=me(i);var r,o=i.getPointResolutionFunc();if(o){if(r=o(e,t),n&&n!==i.getUnits()){var u=i.getMetersPerUnit();u&&(r=r*u/Kn[n])}}else{var l=i.getUnits();if(l==mr.DEGREES&&!n||n==mr.DEGREES)r=e;else{var h=Bh(i,me("EPSG:4326"));if(h===uv&&l!==mr.DEGREES)r=e*i.getMetersPerUnit();else{var c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=h(c,c,2);var d=jd(c.slice(0,2),c.slice(2,4)),_=jd(c.slice(4,6),c.slice(6,8));r=(d+_)/2}var u=n?Kn[n]:i.getMetersPerUnit();u!==void 0&&(r/=u)}}return r}function Kd(i){w1(i),i.forEach(function(e){i.forEach(function(t){e!==t&&Js(e,t,Wh)})})}function R1(i,e,t,n){i.forEach(function(r){e.forEach(function(o){Js(r,o,t),Js(o,r,n)})})}function Xh(i,e){return i?typeof i=="string"?me(i):i:me(e)}function C1(i,e){return sv(),lv(i,"EPSG:4326",e!==void 0?e:"EPSG:3857")}function Ei(i,e){if(i===e)return!0;var t=i.getUnits()===e.getUnits();if(i.getCode()===e.getCode())return t;var n=Bh(i,e);return n===Wh&&t}function Bh(i,e){var t=i.getCode(),n=e.getCode(),r=E1(t,n);return r||(r=uv),r}function Qs(i,e){var t=me(i),n=me(e);return Bh(t,n)}function lv(i,e,t){var n=Qs(e,t);return n(i,void 0,i.length)}var I1=null;function O1(){return I1}function ch(i,e){return i}function _r(i,e){return fh&&!Vs(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(fh=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function hv(i,e){return i}function xi(i,e){return i}function S1(){Kd(Yd),Kd(zd),R1(zd,Yd,d1,p1)}S1();function Hd(i,e,t){return function(n,r,o,u,l){if(!!n){if(!r&&!e)return n;var h=e?0:o[0]*r,c=e?0:o[1]*r,d=l?l[0]:0,_=l?l[1]:0,v=i[0]+h/2+d,y=i[2]-h/2+d,m=i[1]+c/2+_,w=i[3]-c/2+_;v>y&&(v=(y+v)/2,y=v),m>w&&(m=(w+m)/2,w=m);var C=_e(n[0],v,y),P=_e(n[1],m,w);if(u&&t&&r){var I=30*r;C+=-I*Math.log(1+Math.max(0,v-n[0])/I)+I*Math.log(1+Math.max(0,n[0]-y)/I),P+=-I*Math.log(1+Math.max(0,m-n[1])/I)+I*Math.log(1+Math.max(0,n[1]-w)/I)}return[C,P]}}}function A1(i){return i}function Yh(i,e,t,n){var r=se(e)/t[0],o=bn(e)/t[1];return n?Math.min(i,Math.max(r,o)):Math.min(i,Math.min(r,o))}function Zh(i,e,t){var n=Math.min(i,e),r=50;return n*=Math.log(1+r*Math.max(0,i/e-1))/r+1,t&&(n=Math.max(n,t),n/=Math.log(1+r*Math.max(0,t/i-1))/r+1),_e(n,t/2,e*2)}function P1(i,e,t,n){return function(r,o,u,l){if(r!==void 0){var h=i[0],c=i[i.length-1],d=t?Yh(h,t,u,n):h;if(l){var _=e!==void 0?e:!0;return _?Zh(r,d,c):_e(r,c,d)}var v=Math.min(d,r),y=Math.floor(Mh(i,v,o));return i[y]>d&&y<i.length-1?i[y+1]:i[y]}else return}}function L1(i,e,t,n,r,o){return function(u,l,h,c){if(u!==void 0){var d=r?Yh(e,r,h,o):e,_=t!==void 0?t:0;if(c){var v=n!==void 0?n:!0;return v?Zh(u,d,_):_e(u,_,d)}var y=1e-9,m=Math.ceil(Math.log(e/d)/Math.log(i)-y),w=-l*(.5-y)+.5,C=Math.min(d,u),P=Math.floor(Math.log(e/C)/Math.log(i)+w),I=Math.max(m,P),A=e/Math.pow(i,I);return _e(A,_,d)}else return}}function $d(i,e,t,n,r){return function(o,u,l,h){if(o!==void 0){var c=n?Yh(i,n,l,r):i,d=t!==void 0?t:!0;return!d||!h?_e(o,e,c):Zh(o,c,e)}else return}}function zh(i){if(i!==void 0)return 0}function qd(i){if(i!==void 0)return i}function M1(i){var e=2*Math.PI/i;return function(t,n){if(n)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function D1(i){var e=i||Bs(5);return function(t,n){if(n)return t;if(t!==void 0)return Math.abs(t)<=e?0:t}}function fv(i){return Math.pow(i,3)}function So(i){return 1-fv(1-i)}function F1(i){return 3*i*i-2*i*i*i}function N1(i){return i}var fe={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};function Ii(i,e,t,n,r,o){for(var u=o||[],l=0,h=e;h<t;h+=n){var c=i[h],d=i[h+1];u[l++]=r[0]*c+r[2]*d+r[4],u[l++]=r[1]*c+r[3]*d+r[5]}return o&&u.length!=l&&(u.length=l),u}function cv(i,e,t,n,r,o,u){for(var l=u||[],h=Math.cos(r),c=Math.sin(r),d=o[0],_=o[1],v=0,y=e;y<t;y+=n){var m=i[y]-d,w=i[y+1]-_;l[v++]=d+m*h-w*c,l[v++]=_+m*c+w*h;for(var C=y+2;C<y+n;++C)l[v++]=i[C]}return u&&l.length!=v&&(l.length=v),l}function b1(i,e,t,n,r,o,u,l){for(var h=l||[],c=u[0],d=u[1],_=0,v=e;v<t;v+=n){var y=i[v]-c,m=i[v+1]-d;h[_++]=c+r*y,h[_++]=d+o*m;for(var w=v+2;w<v+n;++w)h[_++]=i[w]}return l&&h.length!=_&&(h.length=_),h}function G1(i,e,t,n,r,o,u){for(var l=u||[],h=0,c=e;c<t;c+=n){l[h++]=i[c]+r,l[h++]=i[c+1]+o;for(var d=c+2;d<c+n;++d)l[h++]=i[d]}return u&&l.length!=h&&(l.length=h),l}var k1=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Jd=jn(),U1=function(i){k1(e,i);function e(){var t=i.call(this)||this;return t.extent_=En(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=Wx(function(n,r,o){if(!o)return this.getSimplifiedGeometry(r);var u=this.clone();return u.applyTransform(o),u.getSimplifiedGeometry(r)}),t}return e.prototype.simplifyTransformed=function(t,n){return this.simplifyTransformedInternal(this.getRevision(),t,n)},e.prototype.clone=function(){return ot()},e.prototype.closestPointXY=function(t,n,r,o){return ot()},e.prototype.containsXY=function(t,n){var r=this.getClosestPoint([t,n]);return r[0]===t&&r[1]===n},e.prototype.getClosestPoint=function(t,n){var r=n||[NaN,NaN];return this.closestPointXY(t[0],t[1],r,1/0),r},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return ot()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&Oa(n),this.extentRevision_=this.getRevision()}return rw(this.extent_,t)},e.prototype.rotate=function(t,n){ot()},e.prototype.scale=function(t,n,r){ot()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return ot()},e.prototype.getType=function(){return ot()},e.prototype.applyTransform=function(t){ot()},e.prototype.intersectsExtent=function(t){return ot()},e.prototype.translate=function(t,n){ot()},e.prototype.transform=function(t,n){var r=me(t),o=r.getUnits()==mr.TILE_PIXELS?function(u,l,h){var c=r.getExtent(),d=r.getWorldExtent(),_=bn(d)/bn(c);return Tr(Jd,d[0],d[3],_,-_,0,0,0),Ii(u,0,u.length,h,Jd,l),Qs(r,n)(u,l,h)}:Qs(r,n);return this.applyTransform(o),this},e}(Gn),dv=U1,W1=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),X1=function(i){W1(e,i);function e(){var t=i.call(this)||this;return t.layout=fe.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return Xp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return ot()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var n=this.getSimplifiedGeometryInternal(t),r=n.getFlatCoordinates();return r.length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,n){this.stride=Qd(t),this.layout=t,this.flatCoordinates=n},e.prototype.setCoordinates=function(t,n){ot()},e.prototype.setLayout=function(t,n,r){var o;if(t)o=Qd(t);else{for(var u=0;u<r;++u)if(n.length===0){this.layout=fe.XY,this.stride=2;return}else n=n[0];o=n.length,t=B1(o)}this.layout=t,this.stride=o},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,n){var r=this.getFlatCoordinates();if(r){var o=this.getStride();cv(r,0,r.length,o,t,n,r),this.changed()}},e.prototype.scale=function(t,n,r){var o=n;o===void 0&&(o=t);var u=r;u||(u=Pi(this.getExtent()));var l=this.getFlatCoordinates();if(l){var h=this.getStride();b1(l,0,l.length,h,t,o,u,l),this.changed()}},e.prototype.translate=function(t,n){var r=this.getFlatCoordinates();if(r){var o=this.getStride();G1(r,0,r.length,o,t,n,r),this.changed()}},e}(dv);function B1(i){var e;return i==2?e=fe.XY:i==3?e=fe.XYZ:i==4&&(e=fe.XYZM),e}function Qd(i){var e;return i==fe.XY?e=2:i==fe.XYZ||i==fe.XYM?e=3:i==fe.XYZM&&(e=4),e}function Y1(i,e,t){var n=i.getFlatCoordinates();if(n){var r=i.getStride();return Ii(n,0,n.length,r,e,t)}else return null}var Ui=X1;function tp(i,e,t,n,r,o,u){var l=i[e],h=i[e+1],c=i[t]-l,d=i[t+1]-h,_;if(c===0&&d===0)_=e;else{var v=((r-l)*c+(o-h)*d)/(c*c+d*d);if(v>1)_=t;else if(v>0){for(var y=0;y<n;++y)u[y]=gr(i[e+y],i[t+y],v);u.length=n;return}else _=e}for(var y=0;y<n;++y)u[y]=i[_+y];u.length=n}function jh(i,e,t,n,r){var o=i[e],u=i[e+1];for(e+=n;e<t;e+=n){var l=i[e],h=i[e+1],c=Ci(o,u,l,h);c>r&&(r=c),o=l,u=h}return r}function Vh(i,e,t,n,r){for(var o=0,u=t.length;o<u;++o){var l=t[o];r=jh(i,e,l,n,r),e=l}return r}function Z1(i,e,t,n,r){for(var o=0,u=t.length;o<u;++o){var l=t[o];r=Vh(i,e,l,n,r),e=l[l.length-1]}return r}function Kh(i,e,t,n,r,o,u,l,h,c,d){if(e==t)return c;var _,v;if(r===0)if(v=Ci(u,l,i[e],i[e+1]),v<c){for(_=0;_<n;++_)h[_]=i[e+_];return h.length=n,v}else return c;for(var y=d||[NaN,NaN],m=e+n;m<t;)if(tp(i,m-n,m,n,u,l,y),v=Ci(u,l,y[0],y[1]),v<c){for(c=v,_=0;_<n;++_)h[_]=y[_];h.length=n,m+=n}else m+=n*Math.max((Math.sqrt(v)-Math.sqrt(c))/r|0,1);if(o&&(tp(i,t-n,e,n,u,l,y),v=Ci(u,l,y[0],y[1]),v<c)){for(c=v,_=0;_<n;++_)h[_]=y[_];h.length=n}return c}function Hh(i,e,t,n,r,o,u,l,h,c,d){for(var _=d||[NaN,NaN],v=0,y=t.length;v<y;++v){var m=t[v];c=Kh(i,e,m,n,r,o,u,l,h,c,_),e=m}return c}function z1(i,e,t,n,r,o,u,l,h,c,d){for(var _=d||[NaN,NaN],v=0,y=t.length;v<y;++v){var m=t[v];c=Hh(i,e,m,n,r,o,u,l,h,c,_),e=m[m.length-1]}return c}function j1(i,e,t,n){for(var r=0,o=t.length;r<o;++r)i[e++]=t[r];return e}function wu(i,e,t,n){for(var r=0,o=t.length;r<o;++r)for(var u=t[r],l=0;l<n;++l)i[e++]=u[l];return e}function $h(i,e,t,n,r){for(var o=r||[],u=0,l=0,h=t.length;l<h;++l){var c=wu(i,e,t[l],n);o[u++]=c,e=c}return o.length=u,o}function V1(i,e,t,n,r){for(var o=r||[],u=0,l=0,h=t.length;l<h;++l){var c=$h(i,e,t[l],n,o[u]);o[u++]=c,e=c[c.length-1]}return o.length=u,o}function qh(i,e,t,n,r,o,u){var l=(t-e)/n;if(l<3){for(;e<t;e+=n)o[u++]=i[e],o[u++]=i[e+1];return u}var h=new Array(l);h[0]=1,h[l-1]=1;for(var c=[e,t-n],d=0;c.length>0;){for(var _=c.pop(),v=c.pop(),y=0,m=i[v],w=i[v+1],C=i[_],P=i[_+1],I=v+n;I<_;I+=n){var A=i[I],L=i[I+1],F=uw(A,L,m,w,C,P);F>y&&(d=I,y=F)}y>r&&(h[(d-e)/n]=1,v+n<d&&c.push(v,d),d+n<_&&c.push(d,_))}for(var I=0;I<l;++I)h[I]&&(o[u++]=i[e+I*n],o[u++]=i[e+I*n+1]);return u}function K1(i,e,t,n,r,o,u,l){for(var h=0,c=t.length;h<c;++h){var d=t[h];u=qh(i,e,d,n,r,o,u),l.push(u),e=d}return u}function mi(i,e){return e*Math.round(i/e)}function H1(i,e,t,n,r,o,u){if(e==t)return u;var l=mi(i[e],r),h=mi(i[e+1],r);e+=n,o[u++]=l,o[u++]=h;var c,d;do if(c=mi(i[e],r),d=mi(i[e+1],r),e+=n,e==t)return o[u++]=c,o[u++]=d,u;while(c==l&&d==h);for(;e<t;){var _=mi(i[e],r),v=mi(i[e+1],r);if(e+=n,!(_==c&&v==d)){var y=c-l,m=d-h,w=_-l,C=v-h;if(y*C==m*w&&(y<0&&w<y||y==w||y>0&&w>y)&&(m<0&&C<m||m==C||m>0&&C>m)){c=_,d=v;continue}o[u++]=c,o[u++]=d,l=c,h=d,c=_,d=v}}return o[u++]=c,o[u++]=d,u}function pv(i,e,t,n,r,o,u,l){for(var h=0,c=t.length;h<c;++h){var d=t[h];u=H1(i,e,d,n,r,o,u),l.push(u),e=d}return u}function $1(i,e,t,n,r,o,u,l){for(var h=0,c=t.length;h<c;++h){var d=t[h],_=[];u=pv(i,e,d,n,r,o,u,_),l.push(_),e=d[d.length-1]}return u}function Kr(i,e,t,n,r){for(var o=r!==void 0?r:[],u=0,l=e;l<t;l+=n)o[u++]=i.slice(l,l+n);return o.length=u,o}function _a(i,e,t,n,r){for(var o=r!==void 0?r:[],u=0,l=0,h=t.length;l<h;++l){var c=t[l];o[u++]=Kr(i,e,c,n,o[u]),e=c}return o.length=u,o}function dh(i,e,t,n,r){for(var o=r!==void 0?r:[],u=0,l=0,h=t.length;l<h;++l){var c=t[l];o[u++]=_a(i,e,c,n,o[u]),e=c[c.length-1]}return o.length=u,o}function vv(i,e,t,n){for(var r=0,o=i[t-n],u=i[t-n+1];e<t;e+=n){var l=i[e],h=i[e+1];r+=u*l-o*h,o=l,u=h}return r/2}function _v(i,e,t,n){for(var r=0,o=0,u=t.length;o<u;++o){var l=t[o];r+=vv(i,e,l,n),e=l}return r}function q1(i,e,t,n){for(var r=0,o=0,u=t.length;o<u;++o){var l=t[o];r+=_v(i,e,l,n),e=l[l.length-1]}return r}var J1=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Q1=function(i){J1(e,i);function e(t,n){var r=i.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(t[0])?r.setFlatCoordinates(n,t):r.setCoordinates(t,n),r}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,n,r,o){return o<Gi(this.getExtent(),t,n)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Kh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,n,r,o))},e.prototype.getArea=function(){return vv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Kr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=qh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,fe.XY)},e.prototype.getType=function(){return Y.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=wu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ui),ep=Q1,tR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),eR=function(i){tR(e,i);function e(t,n){var r=i.call(this)||this;return r.setCoordinates(t,n),r}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,r,o){var u=this.flatCoordinates,l=Ci(t,n,u[0],u[1]);if(l<o){for(var h=this.stride,c=0;c<h;++c)r[c]=u[c];return r.length=h,l}else return o},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return tw(this.flatCoordinates,t)},e.prototype.getType=function(){return Y.POINT},e.prototype.intersectsExtent=function(t){return Nh(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=j1(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ui),tu=eR;function nR(i,e,t,n,r){var o=Zp(r,function(u){return!wi(i,e,t,n,u[0],u[1])});return!o}function wi(i,e,t,n,r,o){for(var u=0,l=i[t-n],h=i[t-n+1];e<t;e+=n){var c=i[e],d=i[e+1];h<=o?d>o&&(c-l)*(o-h)-(r-l)*(d-h)>0&&u++:d<=o&&(c-l)*(o-h)-(r-l)*(d-h)<0&&u--,l=c,h=d}return u!==0}function Jh(i,e,t,n,r,o){if(t.length===0||!wi(i,e,t[0],n,r,o))return!1;for(var u=1,l=t.length;u<l;++u)if(wi(i,t[u-1],t[u],n,r,o))return!1;return!0}function rR(i,e,t,n,r,o){if(t.length===0)return!1;for(var u=0,l=t.length;u<l;++u){var h=t[u];if(Jh(i,e,h,n,r,o))return!0;e=h[h.length-1]}return!1}function gv(i,e,t,n,r,o,u){for(var l,h,c,d,_,v,y,m=r[o+1],w=[],C=0,P=t.length;C<P;++C){var I=t[C];for(d=i[I-n],v=i[I-n+1],l=e;l<I;l+=n)_=i[l],y=i[l+1],(m<=v&&y<=m||v<=m&&m<=y)&&(c=(m-v)/(y-v)*(_-d)+d,w.push(c)),d=_,v=y}var A=NaN,L=-1/0;for(w.sort(Si),d=w[0],l=1,h=w.length;l<h;++l){_=w[l];var F=Math.abs(_-d);F>L&&(c=(d+_)/2,Jh(i,e,t,n,c,m)&&(A=c,L=F)),d=_}return isNaN(A)&&(A=r[o]),u?(u.push(A,m,L),u):[A,m,L]}function iR(i,e,t,n,r){for(var o=[],u=0,l=t.length;u<l;++u){var h=t[u];o=gv(i,e,h,n,r,2*u,o),e=h[h.length-1]}return o}function yv(i,e,t,n,r){var o;for(e+=n;e<t;e+=n)if(o=r(i.slice(e-n,e),i.slice(e,e+n)),o)return o;return!1}function Ru(i,e,t,n,r){var o=Yp(En(),i,e,t,n);return Ke(r,o)?vo(r,o)||o[0]>=r[0]&&o[2]<=r[2]||o[1]>=r[1]&&o[3]<=r[3]?!0:yv(i,e,t,n,function(u,l){return iw(r,u,l)}):!1}function oR(i,e,t,n,r){for(var o=0,u=t.length;o<u;++o){if(Ru(i,e,t[o],n,r))return!0;e=t[o]}return!1}function aR(i,e,t,n,r){return!!(Ru(i,e,t,n,r)||wi(i,e,t,n,r[0],r[1])||wi(i,e,t,n,r[0],r[3])||wi(i,e,t,n,r[2],r[1])||wi(i,e,t,n,r[2],r[3]))}function mv(i,e,t,n,r){if(!aR(i,e,t[0],n,r))return!1;if(t.length===1)return!0;for(var o=1,u=t.length;o<u;++o)if(nR(i,t[o-1],t[o],n,r)&&!Ru(i,t[o-1],t[o],n,r))return!1;return!0}function sR(i,e,t,n,r){for(var o=0,u=t.length;o<u;++o){var l=t[o];if(mv(i,e,l,n,r))return!0;e=l[l.length-1]}return!1}function uR(i,e,t,n){for(;e<t-n;){for(var r=0;r<n;++r){var o=i[e+r];i[e+r]=i[t-n+r],i[t-n+r]=o}e+=n,t-=n}}function Ev(i,e,t,n){for(var r=0,o=i[t-n],u=i[t-n+1];e<t;e+=n){var l=i[e],h=i[e+1];r+=(l-o)*(h+u),o=l,u=h}return r===0?void 0:r>0}function Tv(i,e,t,n,r){for(var o=r!==void 0?r:!1,u=0,l=t.length;u<l;++u){var h=t[u],c=Ev(i,e,h,n);if(u===0){if(o&&c||!o&&!c)return!1}else if(o&&!c||!o&&c)return!1;e=h}return!0}function lR(i,e,t,n,r){for(var o=0,u=t.length;o<u;++o){var l=t[o];if(!Tv(i,e,l,n,r))return!1;l.length&&(e=l[l.length-1])}return!0}function ph(i,e,t,n,r){for(var o=r!==void 0?r:!1,u=0,l=t.length;u<l;++u){var h=t[u],c=Ev(i,e,h,n),d=u===0?o&&c||!o&&!c:o&&!c||!o&&c;d&&uR(i,e,h,n),e=h}return e}function np(i,e,t,n,r){for(var o=0,u=t.length;o<u;++o)e=ph(i,e,t[o],n,r);return e}var hR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ga=function(i){hR(e,i);function e(t,n,r){var o=i.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,n!==void 0&&r?(o.setFlatCoordinates(n,t),o.ends_=r):o.setCoordinates(t,n),o}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?Nn(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,r,o){return o<Gi(this.getExtent(),t,n)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hh(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,n,r,o))},e.prototype.containsXY=function(t,n){return Jh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,n)},e.prototype.getArea=function(){return _v(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var n;return t!==void 0?(n=this.getOrientedFlatCoordinates().slice(),ph(n,0,this.ends_,this.stride,t)):n=this.flatCoordinates,_a(n,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Pi(this.getExtent());this.flatInteriorPoint_=gv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new tu(this.getFlatInteriorPoint(),fe.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new ep(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,n=this.flatCoordinates,r=this.ends_,o=[],u=0,l=0,h=r.length;l<h;++l){var c=r[l],d=new ep(n.slice(u,c),t);o.push(d),u=c}return o},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Tv(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=ph(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],r=[];return n.length=pv(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),n,0,r),new e(n,fe.XY,r)},e.prototype.getType=function(){return Y.POLYGON},e.prototype.intersectsExtent=function(t){return mv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=$h(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()},e}(Ui);function rp(i){var e=i[0],t=i[1],n=i[2],r=i[3],o=[e,t,e,r,n,r,n,t,e,t];return new ga(o,fe.XY,[o.length])}var fR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yl=0,cR=function(i){fR(e,i);function e(t){var n=i.call(this)||this;n.on,n.once,n.un;var r=ve({},t);return n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=Xh(r.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,r.projection&&sv(),r.center&&(r.center=_r(r.center,n.projection_)),r.extent&&(r.extent=xi(r.extent,n.projection_)),n.applyOptions_(r),n}return e.prototype.applyOptions_=function(t){var n=ve({},t);for(var r in Ln)delete n[r];this.setProperties(n,!0);var o=pR(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=o.minZoom;var u=dR(t),l=o.constraint,h=vR(t);this.constraints_={center:u,resolution:l,rotation:h},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var n=this.padding_;this.padding_=t;var r=this.getCenter();if(r){var o=t||[0,0,0,0];n=n||[0,0,0,0];var u=this.getResolution(),l=u/2*(o[3]-n[3]+n[1]-o[1]),h=u/2*(o[0]-n[0]+n[2]-o[2]);this.setCenterInternal([r[0]+l,r[1]-h])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),ve({},n,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var n=new Array(arguments.length),r=0;r<n.length;++r){var o=arguments[r];o.center&&(o=ve({},o),o.center=_r(o.center,this.getProjection())),o.anchor&&(o=ve({},o),o.anchor=_r(o.anchor,this.getProjection())),n[r]=o}this.animateInternal.apply(this,n)},e.prototype.animateInternal=function(t){var n=arguments.length,r;n>1&&typeof arguments[n-1]=="function"&&(r=arguments[n-1],--n);for(var o=0;o<n&&!this.isDef();++o){var u=arguments[o];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(o===n){r&&Ds(r,!0);return}for(var l=Date.now(),h=this.targetCenter_.slice(),c=this.targetResolution_,d=this.targetRotation_,_=[];o<n;++o){var v=arguments[o],y={start:l,complete:!1,anchor:v.anchor,duration:v.duration!==void 0?v.duration:1e3,easing:v.easing||F1,callback:r};if(v.center&&(y.sourceCenter=h,y.targetCenter=v.center.slice(),h=y.targetCenter),v.zoom!==void 0?(y.sourceResolution=c,y.targetResolution=this.getResolutionForZoom(v.zoom),c=y.targetResolution):v.resolution&&(y.sourceResolution=c,y.targetResolution=v.resolution,c=y.targetResolution),v.rotation!==void 0){y.sourceRotation=d;var m=yo(v.rotation-d+Math.PI,2*Math.PI)-Math.PI;y.targetRotation=d+m,d=y.targetRotation}_R(y)?y.complete=!0:l+=y.duration,_.push(y)}this.animations_.push(_),this.setHint(Fe.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Fe.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[Fe.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(Fe.ANIMATING,-this.hints_[Fe.ANIMATING]);for(var t,n=0,r=this.animations_.length;n<r;++n){var o=this.animations_[n];if(o[0].callback&&Ds(o[0].callback,!1),!t)for(var u=0,l=o.length;u<l;++u){var h=o[u];if(!h.complete){t=h.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var t=Date.now(),n=!1,r=this.animations_.length-1;r>=0;--r){for(var o=this.animations_[r],u=!0,l=0,h=o.length;l<h;++l){var c=o[l];if(!c.complete){var d=t-c.start,_=c.duration>0?d/c.duration:1;_>=1?(c.complete=!0,_=1):u=!1;var v=c.easing(_);if(c.sourceCenter){var y=c.sourceCenter[0],m=c.sourceCenter[1],w=c.targetCenter[0],C=c.targetCenter[1];this.nextCenter_=c.targetCenter;var P=y+v*(w-y),I=m+v*(C-m);this.targetCenter_=[P,I]}if(c.sourceResolution&&c.targetResolution){var A=v===1?c.targetResolution:c.sourceResolution+v*(c.targetResolution-c.sourceResolution);if(c.anchor){var L=this.getViewportSize_(this.getRotation()),F=this.constraints_.resolution(A,0,L,!0);this.targetCenter_=this.calculateCenterZoom(F,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=A,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){var U=v===1?yo(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+v*(c.targetRotation-c.sourceRotation);if(c.anchor){var G=this.constraints_.rotation(U,!0);this.targetCenter_=this.calculateCenterRotate(G,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=U}if(this.applyTargetState_(!0),n=!0,!c.complete)break}}if(u){this.animations_[r]=null,this.setHint(Fe.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var X=o[0].callback;X&&Ds(X,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,n){var r,o=this.getCenterInternal();return o!==void 0&&(r=[o[0]-n[0],o[1]-n[1]],Gh(r,t-this.getRotation()),Iw(r,n)),r},e.prototype.calculateCenterZoom=function(t,n){var r,o=this.getCenterInternal(),u=this.getResolution();if(o!==void 0&&u!==void 0){var l=n[0]-t*(n[0]-o[0])/u,h=n[1]-t*(n[1]-o[1])/u;r=[l,h]}return r},e.prototype.getViewportSize_=function(t){var n=this.viewportSize_;if(t){var r=n[0],o=n[1];return[Math.abs(r*Math.cos(t))+Math.abs(o*Math.sin(t)),Math.abs(r*Math.sin(t))+Math.abs(o*Math.cos(t))]}else return n},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&ch(t,this.getProjection())},e.prototype.getCenterInternal=function(){return this.get(Ln.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},e.prototype.getHints=function(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var n=this.calculateExtentInternal(t);return hv(n,this.getProjection())},e.prototype.calculateExtentInternal=function(t){var n=t||this.getViewportSizeMinusPadding_(),r=this.getCenterInternal();Pt(r,1);var o=this.getResolution();Pt(o!==void 0,2);var u=this.getRotation();return Pt(u!==void 0,3),oh(r,o,u,n)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Ln.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,n){return this.getResolutionForExtentInternal(xi(t,this.getProjection()),n)},e.prototype.getResolutionForExtentInternal=function(t,n){var r=n||this.getViewportSizeMinusPadding_(),o=se(t)/r[0],u=bn(t)/r[1];return Math.max(o,u)},e.prototype.getResolutionForValueFunction=function(t){var n=t||2,r=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,u=Math.log(r/o)/Math.log(n);return function(l){var h=r/Math.pow(n,l*u);return h}},e.prototype.getRotation=function(){return this.get(Ln.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var n=Math.log(t||2),r=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,u=Math.log(r/o)/n;return function(l){var h=Math.log(r/l)/n/u;return h}},e.prototype.getViewportSizeMinusPadding_=function(t){var n=this.getViewportSize_(t),r=this.padding_;return r&&(n=[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),n},e.prototype.getState=function(){var t=this.getProjection(),n=this.getResolution(),r=this.getRotation(),o=this.getCenterInternal(),u=this.padding_;if(u){var l=this.getViewportSizeMinusPadding_();o=Zl(o,this.getViewportSize_(),[l[0]/2+u[3],l[1]/2+u[0]],n,r)}return{center:o.slice(0),projection:t!==void 0?t:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,n=this.getResolution();return n!==void 0&&(t=this.getZoomForResolution(n)),t},e.prototype.getZoomForResolution=function(t){var n=this.minZoom_||0,r,o;if(this.resolutions_){var u=Mh(this.resolutions_,t,1);n=u,r=this.resolutions_[u],u==this.resolutions_.length-1?o=2:o=r/this.resolutions_[u+1]}else r=this.maxResolution_,o=this.zoomFactor_;return n+Math.log(r/t)/Math.log(o)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var n=_e(Math.floor(t),0,this.resolutions_.length-2),r=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(r,_e(t-n,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,n){var r;if(Pt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){Pt(!bh(t),25);var o=xi(t,this.getProjection());r=rp(o)}else if(t.getType()===Y.CIRCLE){var o=xi(t.getExtent(),this.getProjection());r=rp(o),r.rotate(this.getRotation(),Pi(o))}else{var u=O1();u?r=t.clone().transform(u,this.getProjection()):r=t}this.fitInternal(r,n)},e.prototype.rotatedExtentForGeometry=function(t){for(var n=this.getRotation(),r=Math.cos(n),o=Math.sin(-n),u=t.getFlatCoordinates(),l=t.getStride(),h=1/0,c=1/0,d=-1/0,_=-1/0,v=0,y=u.length;v<y;v+=l){var m=u[v]*r-u[v+1]*o,w=u[v]*o+u[v+1]*r;h=Math.min(h,m),c=Math.min(c,w),d=Math.max(d,m),_=Math.max(_,w)}return[h,c,d,_]},e.prototype.fitInternal=function(t,n){var r=n||{},o=r.size;o||(o=this.getViewportSizeMinusPadding_());var u=r.padding!==void 0?r.padding:[0,0,0,0],l=r.nearest!==void 0?r.nearest:!1,h;r.minResolution!==void 0?h=r.minResolution:r.maxZoom!==void 0?h=this.getResolutionForZoom(r.maxZoom):h=0;var c=this.rotatedExtentForGeometry(t),d=this.getResolutionForExtentInternal(c,[o[0]-u[1]-u[3],o[1]-u[0]-u[2]]);d=isNaN(d)?h:Math.max(d,h),d=this.getConstrainedResolution(d,l?0:1);var _=this.getRotation(),v=Math.sin(_),y=Math.cos(_),m=Pi(c);m[0]+=(u[1]-u[3])/2*d,m[1]+=(u[0]-u[2])/2*d;var w=m[0]*y-m[1]*v,C=m[1]*y+m[0]*v,P=this.getConstrainedCenter([w,C],d),I=r.callback?r.callback:Ai;r.duration!==void 0?this.animateInternal({resolution:d,center:P,duration:r.duration,easing:r.easing},I):(this.targetResolution_=d,this.targetCenter_=P,this.applyTargetState_(!1,!0),Ds(I,!0))},e.prototype.centerOn=function(t,n,r){this.centerOnInternal(_r(t,this.getProjection()),n,r)},e.prototype.centerOnInternal=function(t,n,r){this.setCenterInternal(Zl(t,n,r,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,n,r,o){var u,l=this.padding_;if(l&&t){var h=this.getViewportSizeMinusPadding_(-r),c=Zl(t,o,[h[0]/2+l[3],h[1]/2+l[0]],n,r);u=[t[0]-c[0],t[1]-c[1]]}return u},e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},e.prototype.adjustCenter=function(t){var n=ch(this.targetCenter_,this.getProjection());this.setCenter([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var n=this.targetCenter_;this.setCenterInternal([n[0]+t[0],n[1]+t[1]])},e.prototype.adjustResolution=function(t,n){var r=n&&_r(n,this.getProjection());this.adjustResolutionInternal(t,r)},e.prototype.adjustResolutionInternal=function(t,n){var r=this.getAnimating()||this.getInteracting(),o=this.getViewportSize_(this.getRotation()),u=this.constraints_.resolution(this.targetResolution_*t,0,o,r);n&&(this.targetCenter_=this.calculateCenterZoom(u,n)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,n){this.adjustResolution(Math.pow(this.zoomFactor_,-t),n)},e.prototype.adjustRotation=function(t,n){n&&(n=_r(n,this.getProjection())),this.adjustRotationInternal(t,n)},e.prototype.adjustRotationInternal=function(t,n){var r=this.getAnimating()||this.getInteracting(),o=this.constraints_.rotation(this.targetRotation_+t,r);n&&(this.targetCenter_=this.calculateCenterRotate(o,n)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(t&&_r(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,n){return this.hints_[t]+=n,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,n){var r=this.getAnimating()||this.getInteracting()||n,o=this.constraints_.rotation(this.targetRotation_,r),u=this.getViewportSize_(o),l=this.constraints_.resolution(this.targetResolution_,0,u,r),h=this.constraints_.center(this.targetCenter_,l,u,r,this.calculateCenterShift(this.targetCenter_,l,o,u));this.get(Ln.ROTATION)!==o&&this.set(Ln.ROTATION,o),this.get(Ln.RESOLUTION)!==l&&(this.set(Ln.RESOLUTION,l),this.set("zoom",this.getZoom(),!0)),(!h||!this.get(Ln.CENTER)||!Vs(this.get(Ln.CENTER),h))&&this.set(Ln.CENTER,h),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,n,r){var o=t!==void 0?t:200,u=n||0,l=this.constraints_.rotation(this.targetRotation_),h=this.getViewportSize_(l),c=this.constraints_.resolution(this.targetResolution_,u,h),d=this.constraints_.center(this.targetCenter_,c,h,!1,this.calculateCenterShift(this.targetCenter_,c,l,h));if(o===0&&!this.cancelAnchor_){this.targetResolution_=c,this.targetRotation_=l,this.targetCenter_=d,this.applyTargetState_();return}var _=r||(o===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==c||this.getRotation()!==l||!this.getCenterInternal()||!Vs(this.getCenterInternal(),d))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:l,center:d,resolution:c,duration:o,easing:So,anchor:_}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Fe.INTERACTING,1)},e.prototype.endInteraction=function(t,n,r){var o=r&&_r(r,this.getProjection());this.endInteractionInternal(t,n,o)},e.prototype.endInteractionInternal=function(t,n,r){this.setHint(Fe.INTERACTING,-1),this.resolveConstraints(t,n,r)},e.prototype.getConstrainedCenter=function(t,n){var r=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,n||this.getResolution(),r)},e.prototype.getConstrainedZoom=function(t,n){var r=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(r,n))},e.prototype.getConstrainedResolution=function(t,n){var r=n||0,o=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,r,o)},e}(Gn);function Ds(i,e){setTimeout(function(){i(e)},0)}function dR(i){if(i.extent!==void 0){var e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return Hd(i.extent,i.constrainOnlyCenter,e)}var t=Xh(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){var n=t.getExtent().slice();return n[0]=-1/0,n[2]=1/0,Hd(n,!1,!1)}return A1}function pR(i){var e,t,n,r=28,o=2,u=i.minZoom!==void 0?i.minZoom:Yl,l=i.maxZoom!==void 0?i.maxZoom:r,h=i.zoomFactor!==void 0?i.zoomFactor:o,c=i.multiWorld!==void 0?i.multiWorld:!1,d=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,_=i.showFullExtent!==void 0?i.showFullExtent:!1,v=Xh(i.projection,"EPSG:3857"),y=v.getExtent(),m=i.constrainOnlyCenter,w=i.extent;if(!c&&!w&&v.isGlobal()&&(m=!1,w=y),i.resolutions!==void 0){var C=i.resolutions;t=C[u],n=C[l]!==void 0?C[l]:C[C.length-1],i.constrainResolution?e=P1(C,d,!m&&w,_):e=$d(t,n,d,!m&&w,_)}else{var P=y?Math.max(se(y),bn(y)):360*Kn[mr.DEGREES]/v.getMetersPerUnit(),I=P/Uh/Math.pow(o,Yl),A=I/Math.pow(o,r-Yl);t=i.maxResolution,t!==void 0?u=0:t=I/Math.pow(h,u),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=t/Math.pow(h,l):n=I/Math.pow(h,l):n=A),l=u+Math.floor(Math.log(t/n)/Math.log(h)),n=t/Math.pow(h,l-u),i.constrainResolution?e=L1(h,t,n,d,!m&&w,_):e=$d(t,n,d,!m&&w,_)}return{constraint:e,maxResolution:t,minResolution:n,minZoom:u,zoomFactor:h}}function vR(i){var e=i.enableRotation!==void 0?i.enableRotation:!0;if(e){var t=i.constrainRotation;return t===void 0||t===!0?D1():t===!1?qd:typeof t=="number"?M1(t):qd}else return zh}function _R(i){return!(i.sourceCenter&&i.targetCenter&&!Vs(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function Zl(i,e,t,n,r){var o=Math.cos(-r),u=Math.sin(-r),l=i[0]*o-i[1]*u,h=i[1]*o+i[0]*u;l+=(e[0]/2-t[0])*n,h+=(t[1]-e[1]/2)*n,u=-u;var c=l*o-h*u,d=h*o+l*u;return[c,d]}var jr=cR;function ip(i){return i[0]>0&&i[1]>0}function gR(i,e,t){return t===void 0&&(t=[0,0]),t[0]=i[0]*e+.5|0,t[1]=i[1]*e+.5|0,t}function an(i,e){return Array.isArray(i)?i:(e===void 0?e=[i,i]:(e[0]=i,e[1]=i),e)}var yR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function xv(i){if(i instanceof Sa){i.setMapInternal(null);return}i instanceof xu&&i.getLayers().forEach(xv)}function wv(i,e){if(i instanceof Sa){i.setMapInternal(e);return}if(i instanceof xu)for(var t=i.getLayers().getArray(),n=0,r=t.length;n<r;++n)wv(t[n],e)}var mR=function(i){yR(e,i);function e(t){var n=i.call(this)||this;n.on,n.once,n.un;var r=ER(t);n.renderComplete_,n.loaded_=!0,n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,n.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:bp,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=jn(),n.pixelToCoordinateTransform_=jn(),n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=t.moveTolerance,n.keyboardEventTarget_=r.keyboardEventTarget,n.targetChangeHandlerKeys_=null,n.controls=r.controls||new sn,n.interactions=r.interactions||new sn,n.overlays_=r.overlays,n.overlayIdIndex_={},n.renderer_=null,n.postRenderFunctions_=[],n.tileQueue_=new a1(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addChangeListener(De.LAYERGROUP,n.handleLayerGroupChanged_),n.addChangeListener(De.VIEW,n.handleViewChanged_),n.addChangeListener(De.SIZE,n.handleSizeChanged_),n.addChangeListener(De.TARGET,n.handleTargetChanged_),n.setProperties(r.values);var o=n;return t.view&&!(t.view instanceof jr)&&t.view.then(function(u){o.setView(new jr(u))}),n.controls.addEventListener(Ce.ADD,function(u){u.element.setMap(this)}.bind(n)),n.controls.addEventListener(Ce.REMOVE,function(u){u.element.setMap(null)}.bind(n)),n.interactions.addEventListener(Ce.ADD,function(u){u.element.setMap(this)}.bind(n)),n.interactions.addEventListener(Ce.REMOVE,function(u){u.element.setMap(null)}.bind(n)),n.overlays_.addEventListener(Ce.ADD,function(u){this.addOverlayInternal_(u.element)}.bind(n)),n.overlays_.addEventListener(Ce.REMOVE,function(u){var l=u.element,h=l.getId();h!==void 0&&delete this.overlayIdIndex_[h.toString()],u.element.setMap(null)}.bind(n)),n.controls.forEach(function(u){u.setMap(this)}.bind(n)),n.interactions.forEach(function(u){u.setMap(this)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n}return e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){var n=this.getLayerGroup().getLayers();n.push(t)},e.prototype.handleLayerAdd_=function(t){wv(t.layer,this)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var n=t.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.setTarget(null),i.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,n,r){if(!(!this.frameState_||!this.renderer_)){var o=this.getCoordinateFromPixelInternal(t);r=r!==void 0?r:{};var u=r.hitTolerance!==void 0?r.hitTolerance:0,l=r.layerFilter!==void 0?r.layerFilter:$r,h=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(o,this.frameState_,u,h,n,null,l,null)}},e.prototype.getFeaturesAtPixel=function(t,n){var r=[];return this.forEachFeatureAtPixel(t,function(o){r.push(o)},n),r},e.prototype.getAllLayers=function(){var t=[];function n(r){r.forEach(function(o){o instanceof xu?n(o.getLayers()):t.push(o)})}return n(this.getLayers()),t},e.prototype.forEachLayerAtPixel=function(t,n,r){if(!(!this.frameState_||!this.renderer_)){var o=r||{},u=o.hitTolerance!==void 0?o.hitTolerance:0,l=o.layerFilter||$r;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,u,n,l)}},e.prototype.hasFeatureAtPixel=function(t,n){if(!this.frameState_||!this.renderer_)return!1;var r=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};var o=n.layerFilter!==void 0?n.layerFilter:$r,u=n.hitTolerance!==void 0?n.hitTolerance:0,l=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,u,l,o,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var n=this.viewport_.getBoundingClientRect(),r="changedTouches"in t?t.changedTouches[0]:t;return[r.clientX-n.left,r.clientY-n.top]},e.prototype.getTarget=function(){return this.get(De.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return ch(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var n=this.frameState_;return n?pe(n.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var n=this.overlayIdIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(De.LAYERGROUP)},e.prototype.setLayers=function(t){var n=this.getLayerGroup();if(t instanceof sn){n.setLayers(t);return}var r=n.getLayers();r.clear(),r.extend(t)},e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t},e.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,r=t.length;n<r;++n){var o=t[n];if(!!o.visible){var u=o.layer.getRenderer();if(u&&!u.ready)return!0;var l=o.layer.getSource();if(l&&l.loading)return!0}}return!1},e.prototype.getPixelFromCoordinate=function(t){var n=_r(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)},e.prototype.getPixelFromCoordinateInternal=function(t){var n=this.frameState_;return n?pe(n.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(De.SIZE)},e.prototype.getView=function(){return this.get(De.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,n,r,o){return s1(this.frameState_,t,n,r,o)},e.prototype.handleBrowserEvent=function(t,n){var r=n||t.type,o=new Br(r,this,t);this.handleMapBrowserEvent(o)},e.prototype.handleMapBrowserEvent=function(t){if(!!this.frameState_){var n=t.originalEvent,r=n.type;if(r===lh.POINTERDOWN||r===yt.WHEEL||r===yt.KEYDOWN){var o=this.getOwnerDocument(),u=this.viewport_.getRootNode?this.viewport_.getRootNode():o,l=n.target;if(this.overlayContainerStopEvent_.contains(l)||!(u===o?o.documentElement:u).contains(l))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1)for(var h=this.getInteractions().getArray().slice(),c=h.length-1;c>=0;c--){var d=h[c];if(!(d.getMap()!==this||!d.getActive()||!this.getTargetElement())){var _=d.handleEvent(t);if(!_||t.propagationStopped)break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){var r=this.maxTilesLoading_,o=r;if(t){var u=t.viewHints;if(u[Fe.ANIMATING]||u[Fe.INTERACTING]){var l=Date.now()-t.time>8;r=l?0:8,o=l?0:2}}n.getTilesLoading()<r&&(n.reprioritize(),n.loadMoreTiles(r,o))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(qr.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(qr.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new ho(Yr.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new ho(Yr.LOADSTART,this,t))));for(var h=this.postRenderFunctions_,c=0,d=h.length;c<d;++c)h[c](this,t);h.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var t=0,n=this.targetChangeHandlerKeys_.length;t<n;++t)qt(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(yt.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(yt.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,ah(this.viewport_)}var r=this.getTargetElement();if(!r)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{r.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new e1(this,this.moveTolerance_);for(var o in jt)this.mapBrowserEventHandler_.addEventListener(jt[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(yt.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(yt.WHEEL,this.boundHandleBrowserEvent_,Gp?{passive:!1}:!1);var u=this.getOwnerDocument().defaultView,l=this.keyboardEventTarget_?this.keyboardEventTarget_:r;this.targetChangeHandlerKeys_=[Gt(l,yt.KEYDOWN,this.handleBrowserEvent,this),Gt(l,yt.KEYPRESS,this.handleBrowserEvent,this),Gt(u,yt.RESIZE,this.updateSize,this)]}this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(qt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(qt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Gt(t,Eo.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Gt(t,yt.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(qt),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Zr("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Gt(t,Eo.PROPERTYCHANGE,this.render,this),Gt(t,yt.CHANGE,this.render,this),Gt(t,"addlayer",this.handleLayerAdd_,this),Gt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,r=t.length;n<r;++n){var o=t[n].layer;o.hasRenderer()&&o.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){var n=this.getLayerGroup().getLayers();return n.remove(t)},e.prototype.handleLayerRemove_=function(t){xv(t.layer)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var n=this,r=this.getSize(),o=this.getView(),u=this.frameState_,l=null;if(r!==void 0&&ip(r)&&o&&o.isDef()){var h=o.getHints(this.frameState_?this.frameState_.viewHints:void 0),c=o.getState();if(l={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:oh(c.center,c.resolution,c.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:c,viewHints:h,wantedTiles:{},mapId:Mt(this),renderTargets:{}},c.nextCenter&&c.nextResolution){var d=isNaN(c.nextRotation)?c.rotation:c.nextRotation;l.nextExtent=oh(c.nextCenter,c.nextResolution,d,r)}}if(this.frameState_=l,this.renderer_.renderFrame(l),l){if(l.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,l.postRenderFunctions),u){var _=!this.previousExtent_||!bh(this.previousExtent_)&&!la(l.extent,this.previousExtent_);_&&(this.dispatchEvent(new ho(Yr.MOVESTART,this,u)),this.previousExtent_=Oa(this.previousExtent_))}var v=this.previousExtent_&&!l.viewHints[Fe.ANIMATING]&&!l.viewHints[Fe.INTERACTING]&&!la(l.extent,this.previousExtent_);v&&(this.dispatchEvent(new ho(Yr.MOVEEND,this,l)),Wp(l.extent,this.previousExtent_))}this.dispatchEvent(new ho(Yr.POSTRENDER,this,l)),this.renderComplete_=this.hasListener(Yr.LOADSTART)||this.hasListener(Yr.LOADEND)||this.hasListener(qr.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){n.postRenderTimeoutHandle_=void 0,n.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){var n=this.getLayerGroup();n&&this.handleLayerRemove_(new Zr("removelayer",n)),this.set(De.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(De.SIZE,t)},e.prototype.setTarget=function(t){this.set(De.TARGET,t)},e.prototype.setView=function(t){if(!t||t instanceof jr){this.set(De.VIEW,t);return}this.set(De.VIEW,new jr);var n=this;t.then(function(r){n.setView(new jr(r))})},e.prototype.updateSize=function(){var t=this.getTargetElement(),n=void 0;if(t){var r=getComputedStyle(t),o=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),u=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(o)&&!isNaN(u)&&(n=[o,u],!ip(n)&&!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(n),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var n=void 0,r=getComputedStyle(this.viewport_);r.width&&r.height&&(n=[parseInt(r.width,10),parseInt(r.height,10)]),t.setViewportSize(n)}},e}(Gn);function ER(i){var e=null;i.keyboardEventTarget!==void 0&&(e=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);var t={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new xu({layers:i.layers});t[De.LAYERGROUP]=n,t[De.TARGET]=i.target,t[De.VIEW]=i.view instanceof jr?i.view:new jr;var r;i.controls!==void 0&&(Array.isArray(i.controls)?r=new sn(i.controls.slice()):(Pt(typeof i.controls.getArray=="function",47),r=i.controls));var o;i.interactions!==void 0&&(Array.isArray(i.interactions)?o=new sn(i.interactions.slice()):(Pt(typeof i.interactions.getArray=="function",48),o=i.interactions));var u;return i.overlays!==void 0?Array.isArray(i.overlays)?u=new sn(i.overlays.slice()):(Pt(typeof i.overlays.getArray=="function",49),u=i.overlays):u=new sn,{controls:r,interactions:o,keyboardEventTarget:e,overlays:u,values:t}}var TR=mR,xR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),wR=function(i){xR(e,i);function e(t){var n=i.call(this)||this,r=t.element;return r&&!t.target&&!r.style.pointerEvents&&(r.style.pointerEvents="auto"),n.element=r||null,n.target_=null,n.map_=null,n.listenerKeys=[],t.render&&(n.render=t.render),t.target&&n.setTarget(t.target),n}return e.prototype.disposeInternal=function(){ah(this.element),i.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&ah(this.element);for(var n=0,r=this.listenerKeys.length;n<r;++n)qt(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=t,t){var o=this.target_?this.target_:t.getOverlayContainerStopEvent();o.appendChild(this.element),this.render!==Ai&&this.listenerKeys.push(Gt(t,Yr.POSTRENDER,this.render,this)),t.render()}},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_=typeof t=="string"?document.getElementById(t):t},e}(Gn),Qh=wR,RR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),CR=function(i){RR(e,i);function e(t){var n=this,r=t||{};n=i.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this,n.ulElement_=document.createElement("ul"),n.collapsed_=r.collapsed!==void 0?r.collapsed:!0,n.userCollapsed_=n.collapsed_,n.overrideCollapsible_=r.collapsible!==void 0,n.collapsible_=r.collapsible!==void 0?r.collapsible:!0,n.collapsible_||(n.collapsed_=!1);var o=r.className!==void 0?r.className:"ol-attribution",u=r.tipLabel!==void 0?r.tipLabel:"Attributions",l=r.expandClassName!==void 0?r.expandClassName:o+"-expand",h=r.collapseLabel!==void 0?r.collapseLabel:"\u203A",c=r.collapseClassName!==void 0?r.collapseClassName:o+"-collapse";typeof h=="string"?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=h,n.collapseLabel_.className=c):n.collapseLabel_=h;var d=r.label!==void 0?r.label:"i";typeof d=="string"?(n.label_=document.createElement("span"),n.label_.textContent=d,n.label_.className=l):n.label_=d;var _=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_;n.toggleButton_=document.createElement("button"),n.toggleButton_.setAttribute("type","button"),n.toggleButton_.setAttribute("aria-expanded",String(!n.collapsed_)),n.toggleButton_.title=u,n.toggleButton_.appendChild(_),n.toggleButton_.addEventListener(yt.CLICK,n.handleClick_.bind(n),!1);var v=o+" "+Tu+" "+kh+(n.collapsed_&&n.collapsible_?" "+kd:"")+(n.collapsible_?"":" ol-uncollapsible"),y=n.element;return y.className=v,y.appendChild(n.toggleButton_),y.appendChild(n.ulElement_),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return e.prototype.collectSourceAttributions_=function(t){for(var n={},r=[],o=!0,u=t.layerStatesArray,l=0,h=u.length;l<h;++l){var c=u[l];if(!!js(c,t.viewState)){var d=c.layer.getSource();if(!!d){var _=d.getAttributions();if(!!_){var v=_(t);if(!!v)if(o=o&&d.getAttributionsCollapsible()!==!1,Array.isArray(v))for(var y=0,m=v.length;y<m;++y)v[y]in n||(r.push(v[y]),n[v[y]]=!0);else v in n||(r.push(v),n[v]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(o),r},e.prototype.updateElement_=function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var n=this.collectSourceAttributions_(t),r=n.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!bi(n,this.renderedAttributions_)){bw(this.ulElement_);for(var o=0,u=n.length;o<u;++o){var l=document.createElement("li");l.innerHTML=n[o],this.ulElement_.appendChild(l)}this.renderedAttributions_=n}},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(kd),this.collapsed_?Wd(this.collapseLabel_,this.label_):Wd(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(Qh),IR=CR,OR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),SR=function(i){OR(e,i);function e(t){var n=this,r=t||{};n=i.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this;var o=r.className!==void 0?r.className:"ol-rotate",u=r.label!==void 0?r.label:"\u21E7",l=r.compassClassName!==void 0?r.compassClassName:"ol-compass";n.label_=null,typeof u=="string"?(n.label_=document.createElement("span"),n.label_.className=l,n.label_.textContent=u):(n.label_=u,n.label_.classList.add(l));var h=r.tipLabel?r.tipLabel:"Reset rotation",c=document.createElement("button");c.className=o+"-reset",c.setAttribute("type","button"),c.title=h,c.appendChild(n.label_),c.addEventListener(yt.CLICK,n.handleClick_.bind(n),!1);var d=o+" "+Tu+" "+kh,_=n.element;return _.className=d,_.appendChild(c),n.callResetNorth_=r.resetNorth?r.resetNorth:void 0,n.duration_=r.duration!==void 0?r.duration:250,n.autoHide_=r.autoHide!==void 0?r.autoHide:!0,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(Ps),n}return e.prototype.handleClick_=function(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap(),n=t.getView();if(!!n){var r=n.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:So}):n.setRotation(0))}},e.prototype.render=function(t){var n=t.frameState;if(!!n){var r=n.viewState.rotation;if(r!=this.rotation_){var o="rotate("+r+"rad)";if(this.autoHide_){var u=this.element.classList.contains(Ps);!u&&r===0?this.element.classList.add(Ps):u&&r!==0&&this.element.classList.remove(Ps)}this.label_.style.transform=o}this.rotation_=r}},e}(Qh),AR=SR,PR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),LR=function(i){PR(e,i);function e(t){var n=this,r=t||{};n=i.call(this,{element:document.createElement("div"),target:r.target})||this;var o=r.className!==void 0?r.className:"ol-zoom",u=r.delta!==void 0?r.delta:1,l=r.zoomInClassName!==void 0?r.zoomInClassName:o+"-in",h=r.zoomOutClassName!==void 0?r.zoomOutClassName:o+"-out",c=r.zoomInLabel!==void 0?r.zoomInLabel:"+",d=r.zoomOutLabel!==void 0?r.zoomOutLabel:"\u2013",_=r.zoomInTipLabel!==void 0?r.zoomInTipLabel:"Zoom in",v=r.zoomOutTipLabel!==void 0?r.zoomOutTipLabel:"Zoom out",y=document.createElement("button");y.className=l,y.setAttribute("type","button"),y.title=_,y.appendChild(typeof c=="string"?document.createTextNode(c):c),y.addEventListener(yt.CLICK,n.handleClick_.bind(n,u),!1);var m=document.createElement("button");m.className=h,m.setAttribute("type","button"),m.title=v,m.appendChild(typeof d=="string"?document.createTextNode(d):d),m.addEventListener(yt.CLICK,n.handleClick_.bind(n,-u),!1);var w=o+" "+Tu+" "+kh,C=n.element;return C.className=w,C.appendChild(y),C.appendChild(m),n.duration_=r.duration!==void 0?r.duration:250,n}return e.prototype.handleClick_=function(t,n){n.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var n=this.getMap(),r=n.getView();if(!!r){var o=r.getZoom();if(o!==void 0){var u=r.getConstrainedZoom(o+t);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:u,duration:this.duration_,easing:So})):r.setZoom(u)}}},e}(Qh),MR=LR;function DR(i){var e=i||{},t=new sn,n=e.zoom!==void 0?e.zoom:!0;n&&t.push(new MR(e.zoomOptions));var r=e.rotate!==void 0?e.rotate:!0;r&&t.push(new AR(e.rotateOptions));var o=e.attribution!==void 0?e.attribution:!0;return o&&t.push(new IR(e.attributionOptions)),t}var op={ACTIVE:"active"},FR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),NR=function(i){FR(e,i);function e(t){var n=i.call(this)||this;return n.on,n.once,n.un,t&&t.handleEvent&&(n.handleEvent=t.handleEvent),n.map_=null,n.setActive(!0),n}return e.prototype.getActive=function(){return this.get(op.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(op.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(Gn);function bR(i,e,t){var n=i.getCenterInternal();if(n){var r=[n[0]+e[0],n[1]+e[1]];i.animateInternal({duration:t!==void 0?t:250,easing:N1,center:i.getConstrainedCenter(r)})}}function tf(i,e,t,n){var r=i.getZoom();if(r!==void 0){var o=i.getConstrainedZoom(r+e),u=i.getResolutionForZoom(o);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:u,anchor:t,duration:n!==void 0?n:250,easing:So})}}var Ao=NR,GR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),kR=function(i){GR(e,i);function e(t){var n=i.call(this)||this,r=t||{};return n.delta_=r.delta?r.delta:1,n.duration_=r.duration!==void 0?r.duration:250,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==jt.DBLCLICK){var r=t.originalEvent,o=t.map,u=t.coordinate,l=r.shiftKey?-this.delta_:this.delta_,h=o.getView();tf(h,l,u,this.duration_),r.preventDefault(),n=!0}return!n},e}(Ao),UR=kR,WR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),XR=function(i){WR(e,i);function e(t){var n=this,r=t||{};return n=i.call(this,r)||this,r.handleDownEvent&&(n.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(n.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(n.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(n.handleUpEvent=r.handleUpEvent),r.stopDown&&(n.stopDown=r.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var n=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==jt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==jt.POINTERUP){var r=this.handleUpEvent(t);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(t.type==jt.POINTERDOWN){var o=this.handleDownEvent(t);this.handlingDownUpSequence=o,n=this.stopDown(o)}else t.type==jt.POINTERMOVE&&this.handleMoveEvent(t);return!n},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(BR(t)){var n=t.originalEvent,r=n.pointerId.toString();t.type==jt.POINTERUP?delete this.trackedPointers_[r]:t.type==jt.POINTERDOWN?this.trackedPointers_[r]=n:r in this.trackedPointers_&&(this.trackedPointers_[r]=n),this.targetPointers=Kp(this.trackedPointers_)}},e}(Ao);function ef(i){for(var e=i.length,t=0,n=0,r=0;r<e;r++)t+=i[r].clientX,n+=i[r].clientY;return[t/e,n/e]}function BR(i){var e=i.type;return e===jt.POINTERDOWN||e===jt.POINTERDRAG||e===jt.POINTERUP}var Pa=XR;function vh(i){var e=arguments;return function(t){for(var n=!0,r=0,o=e.length;r<o&&(n=n&&e[r](t),!!n);++r);return n}}var YR=function(i){var e=i.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ZR=function(i){var e=i.map.getTargetElement(),t=i.map.getOwnerDocument().activeElement;return e.contains(t)},Rv=function(i){return i.map.getTargetElement().hasAttribute("tabindex")?ZR(i):!0},zR=$r,Cv=function(i){var e=i.originalEvent;return e.button==0&&!(zx&&jx&&e.ctrlKey)},ap=Ca,jR=function(i){return i.type==jt.SINGLECLICK},Iv=function(i){var e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Ov=function(i){var e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Sv=function(i){var e=i.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"},zl=function(i){var e=i.originalEvent;return Pt(e!==void 0,56),e.pointerType=="mouse"},VR=function(i){var e=i.originalEvent;return Pt(e!==void 0,56),e.isPrimary&&e.button===0},KR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),HR=function(i){KR(e,i);function e(t){var n=i.call(this,{stopDown:Ca})||this,r=t||{};n.kinetic_=r.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var o=r.condition?r.condition:vh(Iv,VR);return n.condition_=r.onFocusOnly?vh(Rv,o):o,n.noKinetic_=!1,n}return e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,r=ef(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){var o=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],u=t.map,l=u.getView();Ow(o,l.getResolution()),Gh(o,l.getRotation()),l.adjustCenterInternal(o)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var n=t.map,r=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var o=this.kinetic_.getDistance(),u=this.kinetic_.getAngle(),l=r.getCenterInternal(),h=n.getPixelFromCoordinateInternal(l),c=n.getCoordinateFromPixelInternal([h[0]-o*Math.cos(u),h[1]-o*Math.sin(u)]);r.animateInternal({center:r.getConstrainedCenter(c),duration:500,easing:So})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var n=t.map,r=n.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},e}(Pa),$R=HR,qR=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),JR=function(i){qR(e,i);function e(t){var n=this,r=t||{};return n=i.call(this,{stopDown:Ca})||this,n.condition_=r.condition?r.condition:YR,n.lastAngle_=void 0,n.duration_=r.duration!==void 0?r.duration:250,n}return e.prototype.handleDragEvent=function(t){if(!!zl(t)){var n=t.map,r=n.getView();if(r.getConstraints().rotation!==zh){var o=n.getSize(),u=t.pixel,l=Math.atan2(o[1]/2-u[1],u[0]-o[0]/2);if(this.lastAngle_!==void 0){var h=l-this.lastAngle_;r.adjustRotationInternal(-h)}this.lastAngle_=l}}},e.prototype.handleUpEvent=function(t){if(!zl(t))return!0;var n=t.map,r=n.getView();return r.endInteraction(this.duration_),!1},e.prototype.handleDownEvent=function(t){if(!zl(t))return!1;if(Cv(t)&&this.condition_(t)){var n=t.map;return n.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},e}(Pa),QR=JR,tC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),eC=function(i){tC(e,i);function e(t){var n=i.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+t,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,n=this.endPixel_,r="px",o=this.element_.style;o.left=Math.min(t[0],n[0])+r,o.top=Math.min(t[1],n[1])+r,o.width=Math.abs(n[0]-t[0])+r,o.height=Math.abs(n[1]-t[1])+r},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,n){this.startPixel_=t,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,n=this.endPixel_,r=[t,[t[0],n[1]],n,[n[0],t[1]]],o=r.map(this.map_.getCoordinateFromPixelInternal,this.map_);o[4]=o[0].slice(),this.geometry_?this.geometry_.setCoordinates([o]):this.geometry_=new ga([o])},e.prototype.getGeometry=function(){return this.geometry_},e}(Lh),nC=eC,Av=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fs={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},jl=function(i){Av(e,i);function e(t,n,r){var o=i.call(this,t)||this;return o.coordinate=n,o.mapBrowserEvent=r,o}return e}(xn),rC=function(i){Av(e,i);function e(t){var n=i.call(this)||this;n.on,n.once,n.un;var r=t||{};return n.box_=new nC(r.className||"ol-dragbox"),n.minArea_=r.minArea!==void 0?r.minArea:64,r.onBoxEnd&&(n.onBoxEnd=r.onBoxEnd),n.startPixel_=null,n.condition_=r.condition?r.condition:Cv,n.boxEndCondition_=r.boxEndCondition?r.boxEndCondition:n.defaultBoxEndCondition,n}return e.prototype.defaultBoxEndCondition=function(t,n,r){var o=r[0]-n[0],u=r[1]-n[1];return o*o+u*u>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new jl(Fs.BOXDRAG,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var n=this.boxEndCondition_(t,this.startPixel_,t.pixel);return n&&this.onBoxEnd(t),this.dispatchEvent(new jl(n?Fs.BOXEND:Fs.BOXCANCEL,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new jl(Fs.BOXSTART,t.coordinate,t)),!0):!1},e.prototype.onBoxEnd=function(t){},e}(Pa),iC=rC,oC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),aC=function(i){oC(e,i);function e(t){var n=this,r=t||{},o=r.condition?r.condition:Ov;return n=i.call(this,{condition:o,className:r.className||"ol-dragzoom",minArea:r.minArea})||this,n.duration_=r.duration!==void 0?r.duration:200,n.out_=r.out!==void 0?r.out:!1,n}return e.prototype.onBoxEnd=function(t){var n=this.getMap(),r=n.getView(),o=this.getGeometry();if(this.out_){var u=r.rotatedExtentForGeometry(o),l=r.getResolutionForExtentInternal(u),h=r.getResolution()/l;o=o.clone(),o.scale(h*h)}r.fitInternal(o,{duration:this.duration_,easing:So})},e}(iC),sC=aC,gi={LEFT:37,UP:38,RIGHT:39,DOWN:40},uC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lC=function(i){uC(e,i);function e(t){var n=i.call(this)||this,r=t||{};return n.defaultCondition_=function(o){return Iv(o)&&Sv(o)},n.condition_=r.condition!==void 0?r.condition:n.defaultCondition_,n.duration_=r.duration!==void 0?r.duration:100,n.pixelDelta_=r.pixelDelta!==void 0?r.pixelDelta:128,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==yt.KEYDOWN){var r=t.originalEvent,o=r.keyCode;if(this.condition_(t)&&(o==gi.DOWN||o==gi.LEFT||o==gi.RIGHT||o==gi.UP)){var u=t.map,l=u.getView(),h=l.getResolution()*this.pixelDelta_,c=0,d=0;o==gi.DOWN?d=-h:o==gi.LEFT?c=-h:o==gi.RIGHT?c=h:d=h;var _=[c,d];Gh(_,l.getRotation()),bR(l,_,this.duration_),r.preventDefault(),n=!0}}return!n},e}(Ao),hC=lC,fC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cC=function(i){fC(e,i);function e(t){var n=i.call(this)||this,r=t||{};return n.condition_=r.condition?r.condition:Sv,n.delta_=r.delta?r.delta:1,n.duration_=r.duration!==void 0?r.duration:100,n}return e.prototype.handleEvent=function(t){var n=!1;if(t.type==yt.KEYDOWN||t.type==yt.KEYPRESS){var r=t.originalEvent,o=r.charCode;if(this.condition_(t)&&(o=="+".charCodeAt(0)||o=="-".charCodeAt(0))){var u=t.map,l=o=="+".charCodeAt(0)?this.delta_:-this.delta_,h=u.getView();tf(h,l,void 0,this.duration_),r.preventDefault(),n=!0}}return!n},e}(Ao),dC=cC,pC=function(){function i(e,t,n){this.decay_=e,this.minVelocity_=t,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return i.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},i.prototype.update=function(e,t){this.points_.push(e,t,Date.now())},i.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var n=t-3;n>0&&this.points_[n+2]>e;)n-=3;var r=this.points_[t+2]-this.points_[n+2];if(r<1e3/60)return!1;var o=this.points_[t]-this.points_[n],u=this.points_[t+1]-this.points_[n+1];return this.angle_=Math.atan2(u,o),this.initialVelocity_=Math.sqrt(o*o+u*u)/r,this.initialVelocity_>this.minVelocity_},i.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},i.prototype.getAngle=function(){return this.angle_},i}(),vC=pC,_C=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vl={TRACKPAD:"trackpad",WHEEL:"wheel"},gC=function(i){_C(e,i);function e(t){var n=this,r=t||{};n=i.call(this,r)||this,n.totalDelta_=0,n.lastDelta_=0,n.maxDelta_=r.maxDelta!==void 0?r.maxDelta:1,n.duration_=r.duration!==void 0?r.duration:250,n.timeout_=r.timeout!==void 0?r.timeout:80,n.useAnchor_=r.useAnchor!==void 0?r.useAnchor:!0,n.constrainResolution_=r.constrainResolution!==void 0?r.constrainResolution:!1;var o=r.condition?r.condition:zR;return n.condition_=r.onFocusOnly?vh(Rv,o):o,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.deltaPerZoom_=300,n}return e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap().getView();t.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var n=t.type;if(n!==yt.WHEEL)return!0;var r=t.map,o=t.originalEvent;o.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);var u;if(t.type==yt.WHEEL&&(u=o.deltaY,Yx&&o.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(u/=bp),o.deltaMode===WheelEvent.DOM_DELTA_LINE&&(u*=40)),u===0)return!1;this.lastDelta_=u;var l=Date.now();this.startTime_===void 0&&(this.startTime_=l),(!this.mode_||l-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(u)<4?Vl.TRACKPAD:Vl.WHEEL);var h=r.getView();if(this.mode_===Vl.TRACKPAD&&!(h.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(h.getAnimating()&&h.cancelAnimations(),h.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),h.adjustZoom(-u/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=l,!1;this.totalDelta_+=u;var c=Math.max(this.timeout_-(l-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),c),!1},e.prototype.handleWheelZoom_=function(t){var n=t.getView();n.getAnimating()&&n.cancelAnimations();var r=-_e(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),tf(n,r,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Ao),yC=gC,mC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),EC=function(i){mC(e,i);function e(t){var n=this,r=t||{},o=r;return o.stopDown||(o.stopDown=Ca),n=i.call(this,o)||this,n.anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=r.threshold!==void 0?r.threshold:.3,n.duration_=r.duration!==void 0?r.duration:250,n}return e.prototype.handleDragEvent=function(t){var n=0,r=this.targetPointers[0],o=this.targetPointers[1],u=Math.atan2(o.clientY-r.clientY,o.clientX-r.clientX);if(this.lastAngle_!==void 0){var l=u-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=l}this.lastAngle_=u;var h=t.map,c=h.getView();if(c.getConstraints().rotation!==zh){var d=h.getViewport().getBoundingClientRect(),_=ef(this.targetPointers);_[0]-=d.left,_[1]-=d.top,this.anchor_=h.getCoordinateFromPixelInternal(_),this.rotating_&&(h.render(),c.adjustRotationInternal(n,this.anchor_))}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,r=n.getView();return r.endInteraction(this.duration_),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(Pa),TC=EC,xC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),wC=function(i){xC(e,i);function e(t){var n=this,r=t||{},o=r;return o.stopDown||(o.stopDown=Ca),n=i.call(this,o)||this,n.anchor_=null,n.duration_=r.duration!==void 0?r.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return e.prototype.handleDragEvent=function(t){var n=1,r=this.targetPointers[0],o=this.targetPointers[1],u=r.clientX-o.clientX,l=r.clientY-o.clientY,h=Math.sqrt(u*u+l*l);this.lastDistance_!==void 0&&(n=this.lastDistance_/h),this.lastDistance_=h;var c=t.map,d=c.getView();n!=1&&(this.lastScaleDelta_=n);var _=c.getViewport().getBoundingClientRect(),v=ef(this.targetPointers);v[0]-=_.left,v[1]-=_.top,this.anchor_=c.getCoordinateFromPixelInternal(v),c.render(),d.adjustResolutionInternal(n,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map,r=n.getView(),o=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,o),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},e}(Pa),RC=wC,fo={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},CC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),IC=function(i){CC(e,i);function e(t){var n=i.call(this)||this;if(n.on,n.once,n.un,n.id_=void 0,n.geometryName_="geometry",n.style_=null,n.styleFunction_=void 0,n.geometryChangeKey_=null,n.addChangeListener(n.geometryName_,n.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){var r=t;n.setGeometry(r)}else{var o=t;n.setProperties(o)}return n}return e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var n=this.getGeometry();n&&t.setGeometry(n.clone());var r=this.getStyle();return r&&t.setStyle(r),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(qt(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Gt(t,yt.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?OC(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Gn);function OC(i){if(typeof i=="function")return i;var e;if(Array.isArray(i))e=i;else{Pt(typeof i.getZIndex=="function",41);var t=i;e=[t]}return function(){return e}}var SC=IC;function Pv(i,e,t,n,r,o,u){var l,h,c=(t-e)/n;if(c===1)l=e;else if(c===2)l=e,h=r;else if(c!==0){for(var d=i[e],_=i[e+1],v=0,y=[0],m=e+n;m<t;m+=n){var w=i[m],C=i[m+1];v+=Math.sqrt((w-d)*(w-d)+(C-_)*(C-_)),y.push(v),d=w,_=C}var P=r*v,I=Gx(y,P);I<0?(h=(P-y[-I-2])/(y[-I-1]-y[-I-2]),l=e+(-I-2)*n):l=e+I*n}for(var A=u>1?u:2,L=o||new Array(A),m=0;m<A;++m)L[m]=l===void 0?NaN:h===void 0?i[l+m]:gr(i[l+m],i[l+n+m],h);return L}function _h(i,e,t,n,r,o){if(t==e)return null;var u;if(r<i[e+n-1])return o?(u=i.slice(e,e+n),u[n-1]=r,u):null;if(i[t-1]<r)return o?(u=i.slice(t-n,t),u[n-1]=r,u):null;if(r==i[e+n-1])return i.slice(e,e+n);for(var l=e/n,h=t/n;l<h;){var c=l+h>>1;r<i[(c+1)*n-1]?h=c:l=c+1}var d=i[l*n-1];if(r==d)return i.slice((l-1)*n,(l-1)*n+n);var _=i[(l+1)*n-1],v=(r-d)/(_-d);u=[];for(var y=0;y<n-1;++y)u.push(gr(i[(l-1)*n+y],i[l*n+y],v));return u.push(r),u}function AC(i,e,t,n,r,o,u){if(u)return _h(i,e,t[t.length-1],n,r,o);var l;if(r<i[n-1])return o?(l=i.slice(0,n),l[n-1]=r,l):null;if(i[i.length-1]<r)return o?(l=i.slice(i.length-n),l[n-1]=r,l):null;for(var h=0,c=t.length;h<c;++h){var d=t[h];if(e!=d){if(r<i[e+n-1])return null;if(r<=i[d-1])return _h(i,e,d,n,r,!1);e=d}}return null}function Lv(i,e,t,n){for(var r=i[e],o=i[e+1],u=0,l=e+n;l<t;l+=n){var h=i[l],c=i[l+1];u+=Math.sqrt((h-r)*(h-r)+(c-o)*(c-o)),r=h,o=c}return u}var PC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),LC=function(i){PC(e,i);function e(t,n){var r=i.call(this)||this;return r.flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(t[0])?r.setFlatCoordinates(n,t):r.setCoordinates(t,n),r}return e.prototype.appendCoordinate=function(t){this.flatCoordinates?Nn(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,r,o){return o<Gi(this.getExtent(),t,n)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Kh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,n,r,o))},e.prototype.forEachSegment=function(t){return yv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,n){if(this.layout!=fe.XYM&&this.layout!=fe.XYZM)return null;var r=n!==void 0?n:!1;return _h(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r)},e.prototype.getCoordinates=function(){return Kr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,n){return Pv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,this.stride)},e.prototype.getLength=function(){return Lv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[];return n.length=qh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,0),new e(n,fe.XY)},e.prototype.getType=function(){return Y.LINE_STRING},e.prototype.intersectsExtent=function(t){return Ru(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=wu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ui),gh=LC,MC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),DC=function(i){MC(e,i);function e(t,n,r){var o=i.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(t[0]))o.setCoordinates(t,n);else if(n!==void 0&&r)o.setFlatCoordinates(n,t),o.ends_=r;else{for(var u=o.getLayout(),l=t,h=[],c=[],d=0,_=l.length;d<_;++d){var v=l[d];d===0&&(u=v.getLayout()),Nn(h,v.getFlatCoordinates()),c.push(h.length)}o.setFlatCoordinates(u,h),o.ends_=c}return o}return e.prototype.appendLineString=function(t){this.flatCoordinates?Nn(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,r,o){return o<Gi(this.getExtent(),t,n)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Vh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hh(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,n,r,o))},e.prototype.getCoordinateAtM=function(t,n,r){if(this.layout!=fe.XYM&&this.layout!=fe.XYZM||this.flatCoordinates.length===0)return null;var o=n!==void 0?n:!1,u=r!==void 0?r:!1;return AC(this.flatCoordinates,0,this.ends_,this.stride,t,o,u)},e.prototype.getCoordinates=function(){return _a(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new gh(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,n=this.ends_,r=this.layout,o=[],u=0,l=0,h=n.length;l<h;++l){var c=n[l],d=new gh(t.slice(u,c),r);o.push(d),u=c}return o},e.prototype.getFlatMidpoints=function(){for(var t=[],n=this.flatCoordinates,r=0,o=this.ends_,u=this.stride,l=0,h=o.length;l<h;++l){var c=o[l],d=Pv(n,r,c,u,.5);Nn(t,d),r=c}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],r=[];return n.length=K1(this.flatCoordinates,0,this.ends_,this.stride,t,n,0,r),new e(n,fe.XY,r)},e.prototype.getType=function(){return Y.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return oR(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=$h(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()},e}(Ui),FC=DC,NC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),bC=function(i){NC(e,i);function e(t,n){var r=i.call(this)||this;return n&&!Array.isArray(t[0])?r.setFlatCoordinates(n,t):r.setCoordinates(t,n),r}return e.prototype.appendPoint=function(t){this.flatCoordinates?Nn(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,r,o){if(o<Gi(this.getExtent(),t,n))return o;for(var u=this.flatCoordinates,l=this.stride,h=0,c=u.length;h<c;h+=l){var d=Ci(t,n,u[h],u[h+1]);if(d<o){o=d;for(var _=0;_<l;++_)r[_]=u[h+_];r.length=l}}return o},e.prototype.getCoordinates=function(){return Kr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var n=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||n<=t?null:new tu(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,n=this.layout,r=this.stride,o=[],u=0,l=t.length;u<l;u+=r){var h=new tu(t.slice(u,u+r),n);o.push(h)}return o},e.prototype.getType=function(){return Y.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var n=this.flatCoordinates,r=this.stride,o=0,u=n.length;o<u;o+=r){var l=n[o],h=n[o+1];if(Nh(t,l,h))return!0}return!1},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=wu(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Ui),Mv=bC;function GC(i,e,t,n){for(var r=[],o=En(),u=0,l=t.length;u<l;++u){var h=t[u];o=Xp(i,e,h[0],n),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=h[h.length-1]}return r}var kC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),UC=function(i){kC(e,i);function e(t,n,r){var o=i.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var u=o.getLayout(),l=t,h=[],c=[],d=0,_=l.length;d<_;++d){var v=l[d];d===0&&(u=v.getLayout());for(var y=h.length,m=v.getEnds(),w=0,C=m.length;w<C;++w)m[w]+=y;Nn(h,v.getFlatCoordinates()),c.push(m)}n=u,t=h,r=c}return n!==void 0&&r?(o.setFlatCoordinates(n,t),o.endss_=r):o.setCoordinates(t,n),o}return e.prototype.appendPolygon=function(t){var n;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),n=t.getEnds().slice(),this.endss_.push();else{var r=this.flatCoordinates.length;Nn(this.flatCoordinates,t.getFlatCoordinates()),n=t.getEnds().slice();for(var o=0,u=n.length;o<u;++o)n[o]+=r}this.endss_.push(n),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,n=new Array(t),r=0;r<t;++r)n[r]=this.endss_[r].slice();var o=new e(this.flatCoordinates.slice(),this.layout,n);return o.applyProperties(this),o},e.prototype.closestPointXY=function(t,n,r,o){return o<Gi(this.getExtent(),t,n)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Z1(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),z1(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,n,r,o))},e.prototype.containsXY=function(t,n){return rR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,n)},e.prototype.getArea=function(){return q1(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var n;return t!==void 0?(n=this.getOrientedFlatCoordinates().slice(),np(n,0,this.endss_,this.stride,t)):n=this.flatCoordinates,dh(n,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=GC(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=iR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new Mv(this.getFlatInteriorPoints().slice(),fe.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;lR(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=np(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var n=[],r=[];return n.length=$1(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),n,0,r),new e(n,fe.XY,r)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var n;if(t===0)n=0;else{var r=this.endss_[t-1];n=r[r.length-1]}var o=this.endss_[t].slice(),u=o[o.length-1];if(n!==0)for(var l=0,h=o.length;l<h;++l)o[l]-=n;return new ga(this.flatCoordinates.slice(n,u),this.layout,o)},e.prototype.getPolygons=function(){for(var t=this.layout,n=this.flatCoordinates,r=this.endss_,o=[],u=0,l=0,h=r.length;l<h;++l){var c=r[l].slice(),d=c[c.length-1];if(u!==0)for(var _=0,v=c.length;_<v;++_)c[_]-=u;var y=new ga(n.slice(u,d),t,c);o.push(y),u=d}return o},e.prototype.getType=function(){return Y.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return sR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,n){this.setLayout(n,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var r=V1(this.flatCoordinates,0,t,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{var o=r[r.length-1];this.flatCoordinates.length=o.length===0?0:o[o.length-1]}this.changed()},e}(Ui),WC=UC;function XC(i,e,t,n,r){Dv(i,e,t||0,n||i.length-1,r||BC)}function Dv(i,e,t,n,r){for(;n>t;){if(n-t>600){var o=n-t+1,u=e-t+1,l=Math.log(o),h=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*h*(o-h)/o)*(u-o/2<0?-1:1),d=Math.max(t,Math.floor(e-u*h/o+c)),_=Math.min(n,Math.floor(e+(o-u)*h/o+c));Dv(i,e,d,_,r)}var v=i[e],y=t,m=n;for(Jo(i,t,e),r(i[n],v)>0&&Jo(i,t,n);y<m;){for(Jo(i,y,m),y++,m--;r(i[y],v)<0;)y++;for(;r(i[m],v)>0;)m--}r(i[t],v)===0?Jo(i,t,m):(m++,Jo(i,m,n)),m<=e&&(t=m+1),e<=m&&(n=m-1)}}function Jo(i,e,t){var n=i[e];i[e]=i[t],i[t]=n}function BC(i,e){return i<e?-1:i>e?1:0}class Fv{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const n=[];if(!bs(e,t))return n;const r=this.toBBox,o=[];for(;t;){for(let u=0;u<t.children.length;u++){const l=t.children[u],h=t.leaf?r(l):l;bs(e,h)&&(t.leaf?n.push(l):Hl(e,h)?this._all(l,n):o.push(l))}t=o.pop()}return n}collides(e){let t=this.data;if(!bs(e,t))return!1;const n=[];for(;t;){for(let r=0;r<t.children.length;r++){const o=t.children[r],u=t.leaf?this.toBBox(o):o;if(bs(e,u)){if(t.leaf||Hl(e,u))return!0;n.push(o)}}t=n.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let n=0;n<e.length;n++)this.insert(e[n]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const n=this.data;this.data=t,t=n}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=co([]),this}remove(e,t){if(!e)return this;let n=this.data;const r=this.toBBox(e),o=[],u=[];let l,h,c;for(;n||o.length;){if(n||(n=o.pop(),h=o[o.length-1],l=u.pop(),c=!0),n.leaf){const d=YC(e,n.children,t);if(d!==-1)return n.children.splice(d,1),o.push(n),this._condense(o),this}!c&&!n.leaf&&Hl(n,r)?(o.push(n),u.push(l),l=0,h=n,n=n.children[0]):h?(l++,n=h.children[l],c=!1):n=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const n=[];for(;e;)e.leaf?t.push(...e.children):n.push(...e.children),e=n.pop();return t}_build(e,t,n,r){const o=n-t+1;let u=this._maxEntries,l;if(o<=u)return l=co(e.slice(t,n+1)),ao(l,this.toBBox),l;r||(r=Math.ceil(Math.log(o)/Math.log(u)),u=Math.ceil(o/Math.pow(u,r-1))),l=co([]),l.leaf=!1,l.height=r;const h=Math.ceil(o/u),c=h*Math.ceil(Math.sqrt(u));sp(e,t,n,c,this.compareMinX);for(let d=t;d<=n;d+=c){const _=Math.min(d+c-1,n);sp(e,d,_,h,this.compareMinY);for(let v=d;v<=_;v+=h){const y=Math.min(v+h-1,_);l.children.push(this._build(e,v,y,r-1))}}return ao(l,this.toBBox),l}_chooseSubtree(e,t,n,r){for(;r.push(t),!(t.leaf||r.length-1===n);){let o=1/0,u=1/0,l;for(let h=0;h<t.children.length;h++){const c=t.children[h],d=Kl(c),_=jC(e,c)-d;_<u?(u=_,o=d<o?d:o,l=c):_===u&&d<o&&(o=d,l=c)}t=l||t.children[0]}return t}_insert(e,t,n){const r=n?e:this.toBBox(e),o=[],u=this._chooseSubtree(r,this.data,t,o);for(u.children.push(e),ia(u,r);t>=0&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(r,o,t)}_split(e,t){const n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);const u=this._chooseSplitIndex(n,o,r),l=co(n.children.splice(u,n.children.length-u));l.height=n.height,l.leaf=n.leaf,ao(n,this.toBBox),ao(l,this.toBBox),t?e[t-1].children.push(l):this._splitRoot(n,l)}_splitRoot(e,t){this.data=co([e,t]),this.data.height=e.height+1,this.data.leaf=!1,ao(this.data,this.toBBox)}_chooseSplitIndex(e,t,n){let r,o=1/0,u=1/0;for(let l=t;l<=n-t;l++){const h=ra(e,0,l,this.toBBox),c=ra(e,l,n,this.toBBox),d=VC(h,c),_=Kl(h)+Kl(c);d<o?(o=d,r=l,u=_<u?_:u):d===o&&_<u&&(u=_,r=l)}return r||n-t}_chooseSplitAxis(e,t,n){const r=e.leaf?this.compareMinX:ZC,o=e.leaf?this.compareMinY:zC,u=this._allDistMargin(e,t,n,r),l=this._allDistMargin(e,t,n,o);u<l&&e.children.sort(r)}_allDistMargin(e,t,n,r){e.children.sort(r);const o=this.toBBox,u=ra(e,0,t,o),l=ra(e,n-t,n,o);let h=Ns(u)+Ns(l);for(let c=t;c<n-t;c++){const d=e.children[c];ia(u,e.leaf?o(d):d),h+=Ns(u)}for(let c=n-t-1;c>=t;c--){const d=e.children[c];ia(l,e.leaf?o(d):d),h+=Ns(l)}return h}_adjustParentBBoxes(e,t,n){for(let r=n;r>=0;r--)ia(t[r],e)}_condense(e){for(let t=e.length-1,n;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():ao(e[t],this.toBBox)}}function YC(i,e,t){if(!t)return e.indexOf(i);for(let n=0;n<e.length;n++)if(t(i,e[n]))return n;return-1}function ao(i,e){ra(i,0,i.children.length,e,i)}function ra(i,e,t,n,r){r||(r=co(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let o=e;o<t;o++){const u=i.children[o];ia(r,i.leaf?n(u):u)}return r}function ia(i,e){return i.minX=Math.min(i.minX,e.minX),i.minY=Math.min(i.minY,e.minY),i.maxX=Math.max(i.maxX,e.maxX),i.maxY=Math.max(i.maxY,e.maxY),i}function ZC(i,e){return i.minX-e.minX}function zC(i,e){return i.minY-e.minY}function Kl(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Ns(i){return i.maxX-i.minX+(i.maxY-i.minY)}function jC(i,e){return(Math.max(e.maxX,i.maxX)-Math.min(e.minX,i.minX))*(Math.max(e.maxY,i.maxY)-Math.min(e.minY,i.minY))}function VC(i,e){const t=Math.max(i.minX,e.minX),n=Math.max(i.minY,e.minY),r=Math.min(i.maxX,e.maxX),o=Math.min(i.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,o-n)}function Hl(i,e){return i.minX<=e.minX&&i.minY<=e.minY&&e.maxX<=i.maxX&&e.maxY<=i.maxY}function bs(i,e){return e.minX<=i.maxX&&e.minY<=i.maxY&&e.maxX>=i.minX&&e.maxY>=i.minY}function co(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function sp(i,e,t,n,r){const o=[e,t];for(;o.length;){if(t=o.pop(),e=o.pop(),t-e<=n)continue;const u=e+Math.ceil((t-e)/n/2)*n;XC(i,u,e,t,r),o.push(e,u,u,t)}}var Vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},KC=function(){function i(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=an(e.scale),this.displacement_=e.displacement}return i.prototype.clone=function(){var e=this.getScale();return new i({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},i.prototype.getOpacity=function(){return this.opacity_},i.prototype.getRotateWithView=function(){return this.rotateWithView_},i.prototype.getRotation=function(){return this.rotation_},i.prototype.getScale=function(){return this.scale_},i.prototype.getScaleArray=function(){return this.scaleArray_},i.prototype.getDisplacement=function(){return this.displacement_},i.prototype.getAnchor=function(){return ot()},i.prototype.getImage=function(e){return ot()},i.prototype.getHitDetectionImage=function(){return ot()},i.prototype.getPixelRatio=function(e){return 1},i.prototype.getImageState=function(){return ot()},i.prototype.getImageSize=function(){return ot()},i.prototype.getOrigin=function(){return ot()},i.prototype.getSize=function(){return ot()},i.prototype.setDisplacement=function(e){this.displacement_=e},i.prototype.setOpacity=function(e){this.opacity_=e},i.prototype.setRotateWithView=function(e){this.rotateWithView_=e},i.prototype.setRotation=function(e){this.rotation_=e},i.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=an(e)},i.prototype.listenImageChange=function(e){ot()},i.prototype.load=function(){ot()},i.prototype.unlistenImageChange=function(e){ot()},i}(),Nv=KC;function zn(i){return Array.isArray(i)?Vp(i):i}var HC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$C=function(i){HC(e,i);function e(t){var n=this,r=t.rotateWithView!==void 0?t.rotateWithView:!1;return n=i.call(this,{opacity:1,rotateWithView:r,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0]})||this,n.canvas_=void 0,n.hitDetectionCanvas_=null,n.fill_=t.fill!==void 0?t.fill:null,n.origin_=[0,0],n.points_=t.points,n.radius_=t.radius!==void 0?t.radius:t.radius1,n.radius2_=t.radius2,n.angle_=t.angle!==void 0?t.angle:0,n.stroke_=t.stroke!==void 0?t.stroke:null,n.size_=null,n.renderOptions_=null,n.render(),n}return e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.getAnchor=function(){var t=this.size_;if(!t)return null;var n=this.getDisplacement();return[t[0]/2-n[0],t[1]/2+n[1]]},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var n=this.canvas_[t];if(!n){var r=this.renderOptions_,o=Tn(r.size*t,r.size*t);this.draw_(r,o,t),n=o.canvas,this.canvas_[t]=n}return n},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return Vt.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,n,r){if(n===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return n;var o=this.radius_,u=this.radius2_===void 0?o:this.radius2_;if(o<u){var l=o;o=u,u=l}var h=this.radius2_===void 0?this.points_:this.points_*2,c=2*Math.PI/h,d=u*Math.sin(c),_=Math.sqrt(u*u-d*d),v=o-_,y=Math.sqrt(d*d+v*v),m=y/d;if(t==="miter"&&m<=r)return m*n;var w=n/2/m,C=n/2*(v/y),P=Math.sqrt((o+w)*(o+w)+C*C),I=P-o;if(this.radius2_===void 0||t==="bevel")return I*2;var A=o*Math.sin(c),L=Math.sqrt(o*o-A*A),F=u-L,U=Math.sqrt(A*A+F*F),G=U/A;if(G<=r){var X=G*n/2-u-o;return 2*Math.max(I,X)}return I*2},e.prototype.createRenderOptions=function(){var t=xo,n=0,r=null,o=0,u,l=0;this.stroke_&&(u=this.stroke_.getColor(),u===null&&(u=da),u=zn(u),l=this.stroke_.getWidth(),l===void 0&&(l=va),r=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=xo),n=this.stroke_.getMiterLimit(),n===void 0&&(n=ca));var h=this.calculateLineJoinSize_(t,l,n),c=Math.max(this.radius_,this.radius2_||0),d=Math.ceil(2*c+h);return{strokeStyle:u,strokeWidth:l,size:d,lineDash:r,lineDashOffset:o,lineJoin:t,miterLimit:n}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvas_={},this.size_=[t,t]},e.prototype.draw_=function(t,n,r){if(n.scale(r,r),n.translate(t.size/2,t.size/2),this.createPath_(n),this.fill_){var o=this.fill_.getColor();o===null&&(o=yr),n.fillStyle=zn(o),n.fill()}this.stroke_&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,n.setLineDash&&t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var n=this.fill_.getColor(),r=0;if(typeof n=="string"&&(n=Ys(n)),n===null?r=1:Array.isArray(n)&&(r=n.length===4?n[3]:1),r===0){var o=Tn(t.size,t.size);this.hitDetectionCanvas_=o.canvas,this.drawHitDetectionCanvas_(t,o)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var n=this.points_,r=this.radius_;if(n===1/0)t.arc(0,0,r,0,2*Math.PI);else{var o=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(n*=2);for(var u=this.angle_-Math.PI/2,l=2*Math.PI/n,h=0;h<n;h++){var c=u+h*l,d=h%2===0?r:o;t.lineTo(d*Math.cos(c),d*Math.sin(c))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,n){n.translate(t.size/2,t.size/2),this.createPath_(n),n.fillStyle=yr,n.fill(),this.stroke_&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},e}(Nv),qC=$C,JC=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),QC=function(i){JC(e,i);function e(t){var n=t||{};return i.call(this,{points:1/0,fill:n.fill,radius:n.radius,stroke:n.stroke,scale:n.scale!==void 0?n.scale:1,rotation:n.rotation!==void 0?n.rotation:0,rotateWithView:n.rotateWithView!==void 0?n.rotateWithView:!1,displacement:n.displacement!==void 0?n.displacement:[0,0]})||this}return e.prototype.clone=function(){var t=this.getScale(),n=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return n.setOpacity(this.getOpacity()),n},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(qC),bv=QC,tI=function(){function i(e){var t=e||{};this.color_=t.color!==void 0?t.color:null}return i.prototype.clone=function(){var e=this.getColor();return new i({color:Array.isArray(e)?e.slice():e||void 0})},i.prototype.getColor=function(){return this.color_},i.prototype.setColor=function(e){this.color_=e},i}(),Li=tI,eI=function(){function i(e){var t=e||{};this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return i.prototype.clone=function(){var e=this.getColor();return new i({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},i.prototype.getColor=function(){return this.color_},i.prototype.getLineCap=function(){return this.lineCap_},i.prototype.getLineDash=function(){return this.lineDash_},i.prototype.getLineDashOffset=function(){return this.lineDashOffset_},i.prototype.getLineJoin=function(){return this.lineJoin_},i.prototype.getMiterLimit=function(){return this.miterLimit_},i.prototype.getWidth=function(){return this.width_},i.prototype.setColor=function(e){this.color_=e},i.prototype.setLineCap=function(e){this.lineCap_=e},i.prototype.setLineDash=function(e){this.lineDash_=e},i.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e},i.prototype.setLineJoin=function(e){this.lineJoin_=e},i.prototype.setMiterLimit=function(e){this.miterLimit_=e},i.prototype.setWidth=function(e){this.width_=e},i}(),Oi=eI,go=function(){function i(e){var t=e||{};this.geometry_=null,this.geometryFunction_=up,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}return i.prototype.clone=function(){var e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new i({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},i.prototype.getRenderer=function(){return this.renderer_},i.prototype.setRenderer=function(e){this.renderer_=e},i.prototype.setHitDetectionRenderer=function(e){this.hitDetectionRenderer_=e},i.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},i.prototype.getGeometry=function(){return this.geometry_},i.prototype.getGeometryFunction=function(){return this.geometryFunction_},i.prototype.getFill=function(){return this.fill_},i.prototype.setFill=function(e){this.fill_=e},i.prototype.getImage=function(){return this.image_},i.prototype.setImage=function(e){this.image_=e},i.prototype.getStroke=function(){return this.stroke_},i.prototype.setStroke=function(e){this.stroke_=e},i.prototype.getText=function(){return this.text_},i.prototype.setText=function(e){this.text_=e},i.prototype.getZIndex=function(){return this.zIndex_},i.prototype.setGeometry=function(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=up,this.geometry_=e},i.prototype.setZIndex=function(e){this.zIndex_=e},i}();function nI(i){var e;if(typeof i=="function")e=i;else{var t;if(Array.isArray(i))t=i;else{Pt(typeof i.getZIndex=="function",41);var n=i;t=[n]}e=function(){return t}}return e}var $l=null;function rI(i,e){if(!$l){var t=new Li({color:"rgba(255,255,255,0.4)"}),n=new Oi({color:"#3399CC",width:1.25});$l=[new go({image:new bv({fill:t,stroke:n,radius:5}),fill:t,stroke:n})]}return $l}function iI(){var i={},e=[255,255,255,1],t=[0,153,255,1],n=3;return i[Y.POLYGON]=[new go({fill:new Li({color:[255,255,255,.5]})})],i[Y.MULTI_POLYGON]=i[Y.POLYGON],i[Y.LINE_STRING]=[new go({stroke:new Oi({color:e,width:n+2})}),new go({stroke:new Oi({color:t,width:n})})],i[Y.MULTI_LINE_STRING]=i[Y.LINE_STRING],i[Y.CIRCLE]=i[Y.POLYGON].concat(i[Y.LINE_STRING]),i[Y.POINT]=[new go({image:new bv({radius:n*2,fill:new Li({color:t}),stroke:new Oi({color:e,width:n/2})}),zIndex:1/0})],i[Y.MULTI_POINT]=i[Y.POINT],i[Y.GEOMETRY_COLLECTION]=i[Y.POLYGON].concat(i[Y.LINE_STRING],i[Y.POINT]),i}function up(i){return i.getGeometry()}var Gv=go,oI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lp={RENDER_ORDER:"renderOrder"},aI=function(i){oI(e,i);function e(t){var n=this,r=t||{},o=ve({},r);return delete o.style,delete o.renderBuffer,delete o.updateWhileAnimating,delete o.updateWhileInteracting,n=i.call(this,o)||this,n.declutter_=r.declutter!==void 0?r.declutter:!1,n.renderBuffer_=r.renderBuffer!==void 0?r.renderBuffer:100,n.style_=null,n.styleFunction_=void 0,n.setStyle(r.style),n.updateWhileAnimating_=r.updateWhileAnimating!==void 0?r.updateWhileAnimating:!1,n.updateWhileInteracting_=r.updateWhileInteracting!==void 0?r.updateWhileInteracting:!1,n}return e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(t){return i.prototype.getFeatures.call(this,t)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(lp.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new Fv(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(lp.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=t!==void 0?t:rI,this.styleFunction_=t===null?void 0:nI(this.style_),this.changed()},e}(Sa),sI=aI,La={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Gs=[La.FILL],Hr=[La.STROKE],Ri=[La.BEGIN_PATH],hp=[La.CLOSE_PATH],ft=La,uI=function(){function i(){}return i.prototype.drawCustom=function(e,t,n,r){},i.prototype.drawGeometry=function(e){},i.prototype.setStyle=function(e){},i.prototype.drawCircle=function(e,t){},i.prototype.drawFeature=function(e,t){},i.prototype.drawGeometryCollection=function(e,t){},i.prototype.drawLineString=function(e,t){},i.prototype.drawMultiLineString=function(e,t){},i.prototype.drawMultiPoint=function(e,t){},i.prototype.drawMultiPolygon=function(e,t){},i.prototype.drawPoint=function(e,t){},i.prototype.drawPolygon=function(e,t){},i.prototype.drawText=function(e,t){},i.prototype.setFillStrokeStyle=function(e,t){},i.prototype.setImageStyle=function(e,t){},i.prototype.setTextStyle=function(e,t){},i}(),kv=uI,lI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hI=function(i){lI(e,i);function e(t,n,r,o){var u=i.call(this)||this;return u.tolerance=t,u.maxExtent=n,u.pixelRatio=o,u.maxLineWidth=0,u.resolution=r,u.beginGeometryInstruction1_=null,u.beginGeometryInstruction2_=null,u.bufferedMaxExtent_=null,u.instructions=[],u.coordinates=[],u.tmpCoordinate_=[],u.hitDetectionInstructions=[],u.state={},u}return e.prototype.applyPixelRatio=function(t){var n=this.pixelRatio;return n==1?t:t.map(function(r){return r*n})},e.prototype.appendFlatPointCoordinates=function(t,n){for(var r=this.getBufferedMaxExtent(),o=this.tmpCoordinate_,u=this.coordinates,l=u.length,h=0,c=t.length;h<c;h+=n)o[0]=t[h],o[1]=t[h+1],Ia(r,o)&&(u[l++]=o[0],u[l++]=o[1]);return l},e.prototype.appendFlatLineCoordinates=function(t,n,r,o,u,l){var h=this.coordinates,c=h.length,d=this.getBufferedMaxExtent();l&&(n+=o);var _=t[n],v=t[n+1],y=this.tmpCoordinate_,m=!0,w,C,P;for(w=n+o;w<r;w+=o)y[0]=t[w],y[1]=t[w+1],P=rh(d,y),P!==C?(m&&(h[c++]=_,h[c++]=v,m=!1),h[c++]=y[0],h[c++]=y[1]):P===Re.INTERSECTING?(h[c++]=y[0],h[c++]=y[1],m=!1):m=!0,_=y[0],v=y[1],C=P;return(u&&m||w===n+o)&&(h[c++]=_,h[c++]=v),c},e.prototype.drawCustomCoordinates_=function(t,n,r,o,u){for(var l=0,h=r.length;l<h;++l){var c=r[l],d=this.appendFlatLineCoordinates(t,n,c,o,!1,!1);u.push(d),n=c}return n},e.prototype.drawCustom=function(t,n,r,o){this.beginGeometry(t,n);var u=t.getType(),l=t.getStride(),h=this.coordinates.length,c,d,_,v,y;switch(u){case Y.MULTI_POLYGON:c=t.getOrientedFlatCoordinates(),v=[];var m=t.getEndss();y=0;for(var w=0,C=m.length;w<C;++w){var P=[];y=this.drawCustomCoordinates_(c,y,m[w],l,P),v.push(P)}this.instructions.push([ft.CUSTOM,h,v,t,r,dh]),this.hitDetectionInstructions.push([ft.CUSTOM,h,v,t,o||r,dh]);break;case Y.POLYGON:case Y.MULTI_LINE_STRING:_=[],c=u==Y.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),y=this.drawCustomCoordinates_(c,0,t.getEnds(),l,_),this.instructions.push([ft.CUSTOM,h,_,t,r,_a]),this.hitDetectionInstructions.push([ft.CUSTOM,h,_,t,o||r,_a]);break;case Y.LINE_STRING:case Y.CIRCLE:c=t.getFlatCoordinates(),d=this.appendFlatLineCoordinates(c,0,c.length,l,!1,!1),this.instructions.push([ft.CUSTOM,h,d,t,r,Kr]),this.hitDetectionInstructions.push([ft.CUSTOM,h,d,t,o||r,Kr]);break;case Y.MULTI_POINT:c=t.getFlatCoordinates(),d=this.appendFlatPointCoordinates(c,l),d>h&&(this.instructions.push([ft.CUSTOM,h,d,t,r,Kr]),this.hitDetectionInstructions.push([ft.CUSTOM,h,d,t,o||r,Kr]));break;case Y.POINT:c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),d=this.coordinates.length,this.instructions.push([ft.CUSTOM,h,d,t,r]),this.hitDetectionInstructions.push([ft.CUSTOM,h,d,t,o||r]);break}this.endGeometry(n)},e.prototype.beginGeometry=function(t,n){this.beginGeometryInstruction1_=[ft.BEGIN_GEOMETRY,n,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ft.BEGIN_GEOMETRY,n,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var n,r=t.length,o,u,l=-1;for(n=0;n<r;++n)o=t[n],u=o[0],u==ft.END_GEOMETRY?l=n:u==ft.BEGIN_GEOMETRY&&(o[2]=n,kx(this.hitDetectionInstructions,l,n),l=-1)},e.prototype.setFillStrokeStyle=function(t,n){var r=this.state;if(t){var o=t.getColor();r.fillStyle=zn(o||yr)}else r.fillStyle=void 0;if(n){var u=n.getColor();r.strokeStyle=zn(u||da);var l=n.getLineCap();r.lineCap=l!==void 0?l:Ks;var h=n.getLineDash();r.lineDash=h?h.slice():ha;var c=n.getLineDashOffset();r.lineDashOffset=c||fa;var d=n.getLineJoin();r.lineJoin=d!==void 0?d:xo;var _=n.getWidth();r.lineWidth=_!==void 0?_:va;var v=n.getMiterLimit();r.miterLimit=v!==void 0?v:ca,r.lineWidth>this.maxLineWidth&&(this.maxLineWidth=r.lineWidth,this.bufferedMaxExtent_=null)}else r.strokeStyle=void 0,r.lineCap=void 0,r.lineDash=null,r.lineDashOffset=void 0,r.lineJoin=void 0,r.lineWidth=void 0,r.miterLimit=void 0},e.prototype.createFill=function(t){var n=t.fillStyle,r=[ft.SET_FILL_STYLE,n];return typeof n!="string"&&r.push(!0),r},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[ft.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,n){var r=t.fillStyle;(typeof r!="string"||t.currentFillStyle!=r)&&(r!==void 0&&this.instructions.push(n.call(this,t)),t.currentFillStyle=r)},e.prototype.updateStrokeStyle=function(t,n){var r=t.strokeStyle,o=t.lineCap,u=t.lineDash,l=t.lineDashOffset,h=t.lineJoin,c=t.lineWidth,d=t.miterLimit;(t.currentStrokeStyle!=r||t.currentLineCap!=o||u!=t.currentLineDash&&!bi(t.currentLineDash,u)||t.currentLineDashOffset!=l||t.currentLineJoin!=h||t.currentLineWidth!=c||t.currentMiterLimit!=d)&&(r!==void 0&&n.call(this,t),t.currentStrokeStyle=r,t.currentLineCap=o,t.currentLineDash=u,t.currentLineDashOffset=l,t.currentLineJoin=h,t.currentLineWidth=c,t.currentMiterLimit=d)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var n=[ft.END_GEOMETRY,t];this.instructions.push(n),this.hitDetectionInstructions.push(n)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Wp(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Fh(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(kv),Ma=hI,fI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cI=function(i){fI(e,i);function e(t,n,r,o){var u=i.call(this,t,n,r,o)||this;return u.hitDetectionImage_=null,u.image_=null,u.imagePixelRatio_=void 0,u.anchorX_=void 0,u.anchorY_=void 0,u.height_=void 0,u.opacity_=void 0,u.originX_=void 0,u.originY_=void 0,u.rotateWithView_=void 0,u.rotation_=void 0,u.scale_=void 0,u.width_=void 0,u.declutterImageWithText_=void 0,u}return e.prototype.drawPoint=function(t,n){if(!!this.image_){this.beginGeometry(t,n);var r=t.getFlatCoordinates(),o=t.getStride(),u=this.coordinates.length,l=this.appendFlatPointCoordinates(r,o);this.instructions.push([ft.DRAW_IMAGE,u,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ft.DRAW_IMAGE,u,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(n)}},e.prototype.drawMultiPoint=function(t,n){if(!!this.image_){this.beginGeometry(t,n);var r=t.getFlatCoordinates(),o=t.getStride(),u=this.coordinates.length,l=this.appendFlatPointCoordinates(r,o);this.instructions.push([ft.DRAW_IMAGE,u,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([ft.DRAW_IMAGE,u,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(n)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,i.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,n){var r=t.getAnchor(),o=t.getSize(),u=t.getHitDetectionImage(),l=t.getImage(this.pixelRatio),h=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=u,this.image_=l,this.height_=o[1],this.opacity_=t.getOpacity(),this.originX_=h[0]*this.imagePixelRatio_,this.originY_=h[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=o[0],this.declutterImageWithText_=n},e}(Ma),dI=cI,pI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),vI=function(i){pI(e,i);function e(t,n,r,o){return i.call(this,t,n,r,o)||this}return e.prototype.drawFlatCoordinates_=function(t,n,r,o){var u=this.coordinates.length,l=this.appendFlatLineCoordinates(t,n,r,o,!1,!1),h=[ft.MOVE_TO_LINE_TO,u,l];return this.instructions.push(h),this.hitDetectionInstructions.push(h),r},e.prototype.drawLineString=function(t,n){var r=this.state,o=r.strokeStyle,u=r.lineWidth;if(!(o===void 0||u===void 0)){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,ha,fa],Ri);var l=t.getFlatCoordinates(),h=t.getStride();this.drawFlatCoordinates_(l,0,l.length,h),this.hitDetectionInstructions.push(Hr),this.endGeometry(n)}},e.prototype.drawMultiLineString=function(t,n){var r=this.state,o=r.strokeStyle,u=r.lineWidth;if(!(o===void 0||u===void 0)){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],Ri);for(var l=t.getEnds(),h=t.getFlatCoordinates(),c=t.getStride(),d=0,_=0,v=l.length;_<v;++_)d=this.drawFlatCoordinates_(h,d,l[_],c);this.hitDetectionInstructions.push(Hr),this.endGeometry(n)}},e.prototype.finish=function(){var t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Hr),this.reverseHitDetectionInstructions(),this.state=null,i.prototype.finish.call(this)},e.prototype.applyStroke=function(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Hr),t.lastStroke=this.coordinates.length),t.lastStroke=0,i.prototype.applyStroke.call(this,t),this.instructions.push(Ri)},e}(Ma),_I=vI,gI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),yI=function(i){gI(e,i);function e(t,n,r,o){return i.call(this,t,n,r,o)||this}return e.prototype.drawFlatCoordinatess_=function(t,n,r,o){var u=this.state,l=u.fillStyle!==void 0,h=u.strokeStyle!==void 0,c=r.length;this.instructions.push(Ri),this.hitDetectionInstructions.push(Ri);for(var d=0;d<c;++d){var _=r[d],v=this.coordinates.length,y=this.appendFlatLineCoordinates(t,n,_,o,!0,!h),m=[ft.MOVE_TO_LINE_TO,v,y];this.instructions.push(m),this.hitDetectionInstructions.push(m),h&&(this.instructions.push(hp),this.hitDetectionInstructions.push(hp)),n=_}return l&&(this.instructions.push(Gs),this.hitDetectionInstructions.push(Gs)),h&&(this.instructions.push(Hr),this.hitDetectionInstructions.push(Hr)),n},e.prototype.drawCircle=function(t,n){var r=this.state,o=r.fillStyle,u=r.strokeStyle;if(!(o===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,yr]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var l=t.getFlatCoordinates(),h=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,h,!1,!1);var d=[ft.CIRCLE,c];this.instructions.push(Ri,d),this.hitDetectionInstructions.push(Ri,d),r.fillStyle!==void 0&&(this.instructions.push(Gs),this.hitDetectionInstructions.push(Gs)),r.strokeStyle!==void 0&&(this.instructions.push(Hr),this.hitDetectionInstructions.push(Hr)),this.endGeometry(n)}},e.prototype.drawPolygon=function(t,n){var r=this.state,o=r.fillStyle,u=r.strokeStyle;if(!(o===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,yr]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var l=t.getEnds(),h=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(h,0,l,c),this.endGeometry(n)}},e.prototype.drawMultiPolygon=function(t,n){var r=this.state,o=r.fillStyle,u=r.strokeStyle;if(!(o===void 0&&u===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_FILL_STYLE,yr]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([ft.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);for(var l=t.getEndss(),h=t.getOrientedFlatCoordinates(),c=t.getStride(),d=0,_=0,v=l.length;_<v;++_)d=this.drawFlatCoordinatess_(h,d,l[_],c);this.endGeometry(n)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(t!==0)for(var n=this.coordinates,r=0,o=n.length;r<o;++r)n[r]=mi(n[r],t);return i.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state,n=t.fillStyle;n!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)},e}(Ma),fp=yI,Uv={POINT:"point",LINE:"line"};function mI(i,e,t,n,r){var o=t,u=t,l=0,h=0,c=t,d,_,v,y,m,w,C,P,I,A;for(_=t;_<n;_+=r){var L=e[_],F=e[_+1];m!==void 0&&(I=L-m,A=F-w,y=Math.sqrt(I*I+A*A),C!==void 0&&(h+=v,d=Math.acos((C*I+P*A)/(v*y)),d>i&&(h>l&&(l=h,o=c,u=_),h=0,c=_-r)),v=y,C=I,P=A),m=L,w=F}return h+=y,h>l?[c,_]:[o,u]}var EI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),eu={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},TI=function(i){EI(e,i);function e(t,n,r,o){var u=i.call(this,t,n,r,o)||this;return u.labels_=null,u.text_="",u.textOffsetX_=0,u.textOffsetY_=0,u.textRotateWithView_=void 0,u.textRotation_=0,u.textFillState_=null,u.fillStates={},u.textStrokeState_=null,u.strokeStates={},u.textState_={},u.textStates={},u.textKey_="",u.fillKey_="",u.strokeKey_="",u.declutterImageWithText_=void 0,u}return e.prototype.finish=function(){var t=i.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},e.prototype.drawText=function(t,n){var r=this.textFillState_,o=this.textStrokeState_,u=this.textState_;if(!(this.text_===""||!u||!r&&!o)){var l=this.coordinates,h=l.length,c=t.getType(),d=null,_=t.getStride();if(u.placement===Uv.LINE&&(c==Y.LINE_STRING||c==Y.MULTI_LINE_STRING||c==Y.POLYGON||c==Y.MULTI_POLYGON)){if(!Ke(this.getBufferedMaxExtent(),t.getExtent()))return;var v=void 0;if(d=t.getFlatCoordinates(),c==Y.LINE_STRING)v=[d.length];else if(c==Y.MULTI_LINE_STRING)v=t.getEnds();else if(c==Y.POLYGON)v=t.getEnds().slice(0,1);else if(c==Y.MULTI_POLYGON){var y=t.getEndss();v=[];for(var m=0,w=y.length;m<w;++m)v.push(y[m][0])}this.beginGeometry(t,n);for(var C=u.textAlign,P=0,I=void 0,A=0,L=v.length;A<L;++A){if(C==null){var F=mI(u.maxAngle,d,P,v[A],_);P=F[0],I=F[1]}else I=v[A];for(var m=P;m<I;m+=_)l.push(d[m],d[m+1]);var U=l.length;P=v[A],this.drawChars_(h,U),h=U}this.endGeometry(n)}else{var G=u.overflow?null:[];switch(c){case Y.POINT:case Y.MULTI_POINT:d=t.getFlatCoordinates();break;case Y.LINE_STRING:d=t.getFlatMidpoint();break;case Y.CIRCLE:d=t.getCenter();break;case Y.MULTI_LINE_STRING:d=t.getFlatMidpoints(),_=2;break;case Y.POLYGON:d=t.getFlatInteriorPoint(),u.overflow||G.push(d[2]/this.resolution),_=3;break;case Y.MULTI_POLYGON:var X=t.getFlatInteriorPoints();d=[];for(var m=0,w=X.length;m<w;m+=3)u.overflow||G.push(X[m+2]/this.resolution),d.push(X[m],X[m+1]);if(d.length===0)return;_=2;break}var U=this.appendFlatPointCoordinates(d,_);if(U===h)return;if(G&&(U-h)/2!==d.length/_){var B=h/2;G=G.filter(function(nt,ut){var mt=l[(B+ut)*2]===d[ut*_]&&l[(B+ut)*2+1]===d[ut*_+1];return mt||--B,mt})}this.saveTextStates_(),(u.backgroundFill||u.backgroundStroke)&&(this.setFillStrokeStyle(u.backgroundFill,u.backgroundStroke),u.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),u.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,n);var Z=u.padding;if(Z!=Ti&&(u.scale[0]<0||u.scale[1]<0)){var j=u.padding[0],V=u.padding[1],tt=u.padding[2],rt=u.padding[3];u.scale[0]<0&&(V=-V,rt=-rt),u.scale[1]<0&&(j=-j,tt=-tt),Z=[j,V,tt,rt]}var H=this.pixelRatio;this.instructions.push([ft.DRAW_IMAGE,h,U,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,Z==Ti?Ti:Z.map(function(nt){return nt*H}),!!u.backgroundFill,!!u.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,G]);var Q=1/H;this.hitDetectionInstructions.push([ft.DRAW_IMAGE,h,U,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[Q,Q],NaN,this.declutterImageWithText_,Z,!!u.backgroundFill,!!u.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,G]),this.endGeometry(n)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,n=this.textState_,r=this.textFillState_,o=this.strokeKey_;t&&(o in this.strokeStates||(this.strokeStates[o]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var u=this.textKey_;u in this.textStates||(this.textStates[u]={font:n.font,textAlign:n.textAlign||pa,textBaseline:n.textBaseline||Hs,scale:n.scale});var l=this.fillKey_;r&&(l in this.fillStates||(this.fillStates[l]={fillStyle:r.fillStyle}))},e.prototype.drawChars_=function(t,n){var r=this.textStrokeState_,o=this.textState_,u=this.strokeKey_,l=this.textKey_,h=this.fillKey_;this.saveTextStates_();var c=this.pixelRatio,d=eu[o.textBaseline],_=this.textOffsetY_*c,v=this.text_,y=r?r.lineWidth*Math.abs(o.scale[0])/2:0;this.instructions.push([ft.DRAW_CHARS,t,n,d,o.overflow,h,o.maxAngle,c,_,u,y*c,v,l,1]),this.hitDetectionInstructions.push([ft.DRAW_CHARS,t,n,d,o.overflow,h,o.maxAngle,1,_,u,y,v,l,1/c])},e.prototype.setTextStyle=function(t,n){var r,o,u;if(!t)this.text_="";else{var l=t.getFill();l?(o=this.textFillState_,o||(o={},this.textFillState_=o),o.fillStyle=zn(l.getColor()||yr)):(o=null,this.textFillState_=o);var h=t.getStroke();if(!h)u=null,this.textStrokeState_=u;else{u=this.textStrokeState_,u||(u={},this.textStrokeState_=u);var c=h.getLineDash(),d=h.getLineDashOffset(),_=h.getWidth(),v=h.getMiterLimit();u.lineCap=h.getLineCap()||Ks,u.lineDash=c?c.slice():ha,u.lineDashOffset=d===void 0?fa:d,u.lineJoin=h.getLineJoin()||xo,u.lineWidth=_===void 0?va:_,u.miterLimit=v===void 0?ca:v,u.strokeStyle=zn(h.getColor()||da)}r=this.textState_;var y=t.getFont()||nv;Uw(y);var m=t.getScaleArray();r.overflow=t.getOverflow(),r.font=y,r.maxAngle=t.getMaxAngle(),r.placement=t.getPlacement(),r.textAlign=t.getTextAlign(),r.textBaseline=t.getTextBaseline()||Hs,r.backgroundFill=t.getBackgroundFill(),r.backgroundStroke=t.getBackgroundStroke(),r.padding=t.getPadding()||Ti,r.scale=m===void 0?[1,1]:m;var w=t.getOffsetX(),C=t.getOffsetY(),P=t.getRotateWithView(),I=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=w===void 0?0:w,this.textOffsetY_=C===void 0?0:C,this.textRotateWithView_=P===void 0?!1:P,this.textRotation_=I===void 0?0:I,this.strokeKey_=u?(typeof u.strokeStyle=="string"?u.strokeStyle:Mt(u.strokeStyle))+u.lineCap+u.lineDashOffset+"|"+u.lineWidth+u.lineJoin+u.miterLimit+"["+u.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.textBaseline||"?"),this.fillKey_=o?typeof o.fillStyle=="string"?o.fillStyle:"|"+Mt(o.fillStyle):""}this.declutterImageWithText_=n},e}(Ma),xI=TI,wI={Circle:fp,Default:Ma,Image:dI,LineString:_I,Polygon:fp,Text:xI},RI=function(){function i(e,t,n,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}return i.prototype.finish=function(){var e={};for(var t in this.buildersByZIndex_){e[t]=e[t]||{};var n=this.buildersByZIndex_[t];for(var r in n){var o=n[r].finish();e[t][r]=o}}return e},i.prototype.getBuilder=function(e,t){var n=e!==void 0?e.toString():"0",r=this.buildersByZIndex_[n];r===void 0&&(r={},this.buildersByZIndex_[n]=r);var o=r[t];if(o===void 0){var u=wI[t];o=new u(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=o}return o},i}(),cp=RI,CI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),II=function(i){CI(e,i);function e(t){var n=i.call(this)||this;return n.ready=!0,n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=t,n.declutterExecutorGroup=null,n}return e.prototype.getFeatures=function(t){return ot()},e.prototype.getData=function(t){return null},e.prototype.prepareFrame=function(t){return ot()},e.prototype.renderFrame=function(t,n){return ot()},e.prototype.loadedTileCallback=function(t,n,r){t[n]||(t[n]={}),t[n][r.tileCoord.toString()]=r},e.prototype.createLoadedTileFinder=function(t,n,r){return function(o,u){var l=this.loadedTileCallback.bind(this,r,o);return t.forEachLoadedTile(n,o,u,l)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,n,r,o,u){},e.prototype.getDataAtPixel=function(t,n,r){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){var n=t.target;n.getState()===Vt.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var n=t.getState();return n!=Vt.LOADED&&n!=Vt.ERROR&&t.addEventListener(yt.CHANGE,this.boundHandleImageChange_),n==Vt.IDLE&&(t.load(),n=t.getState()),n==Vt.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==ti.READY&&t.changed()},e.prototype.disposeInternal=function(){delete this.layer_,i.prototype.disposeInternal.call(this)},e}(Hp),OI=II,SI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),oa=null;function AI(){var i=document.createElement("canvas");i.width=1,i.height=1,oa=i.getContext("2d")}var PI=function(i){SI(e,i);function e(t){var n=i.call(this,t)||this;return n.container=null,n.renderedResolution,n.tempTransform=jn(),n.pixelTransform=jn(),n.inversePixelTransform=jn(),n.context=null,n.containerReused=!1,n.pixelContext_=null,n.frameState=null,n}return e.prototype.getImageData=function(t,n,r){oa||AI(),oa.clearRect(0,0,1,1);var o;try{oa.drawImage(t,n,r,1,1,0,0,1,1),o=oa.getImageData(0,0,1,1).data}catch{return null}return o},e.prototype.getBackground=function(t){var n=this.getLayer(),r=n.getBackground();return typeof r=="function"&&(r=r(t.viewState.resolution)),r||void 0},e.prototype.useContainer=function(t,n,r,o){var u=this.getLayer().getClassName(),l,h;if(t&&t.className===u&&t.style.opacity===""&&r===1&&(!o||t.style.backgroundColor&&bi(Ys(t.style.backgroundColor),Ys(o)))){var c=t.firstElementChild;c instanceof HTMLCanvasElement&&(h=c.getContext("2d"))}if(h&&h.canvas.style.transform===n?(this.container=t,this.context=h,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){l=document.createElement("div"),l.className=u;var d=l.style;d.position="absolute",d.width="100%",d.height="100%",o&&(d.backgroundColor=o),h=Tn();var c=h.canvas;l.appendChild(c),d=c.style,d.position="absolute",d.left="0",d.transformOrigin="top left",this.container=l,this.context=h}},e.prototype.clipUnrotated=function(t,n,r){var o=ki(r),u=mu(r),l=yu(r),h=gu(r);pe(n.coordinateToPixelTransform,o),pe(n.coordinateToPixelTransform,u),pe(n.coordinateToPixelTransform,l),pe(n.coordinateToPixelTransform,h);var c=this.inversePixelTransform;pe(c,o),pe(c,u),pe(c,l),pe(c,h),t.save(),t.beginPath(),t.moveTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(u[0]),Math.round(u[1])),t.lineTo(Math.round(l[0]),Math.round(l[1])),t.lineTo(Math.round(h[0]),Math.round(h[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,n,r){var o=this.getLayer();if(o.hasListener(t)){var u=new Qp(t,this.inversePixelTransform,r,n);o.dispatchEvent(u)}},e.prototype.preRender=function(t,n){this.frameState=n,this.dispatchRenderEvent_(qr.PRERENDER,t,n)},e.prototype.postRender=function(t,n){this.dispatchRenderEvent_(qr.POSTRENDER,t,n)},e.prototype.getRenderTransform=function(t,n,r,o,u,l,h){var c=u/2,d=l/2,_=o/n,v=-_,y=-t[0]+h,m=-t[1];return Tr(this.tempTransform,c,d,_,v,-r,y,m)},e.prototype.getDataAtPixel=function(t,n,r){var o=pe(this.inversePixelTransform,t.slice()),u=this.context,l=this.getLayer(),h=l.getExtent();if(h){var c=pe(n.pixelToCoordinateTransform,t.slice());if(!Ia(h,c))return null}var d=Math.round(o[0]),_=Math.round(o[1]),v=this.pixelContext_;if(!v){var y=document.createElement("canvas");y.width=1,y.height=1,v=y.getContext("2d"),this.pixelContext_=v}v.clearRect(0,0,1,1);var m;try{v.drawImage(u.canvas,d,_,1,1,0,0,1,1),m=v.getImageData(0,0,1,1).data}catch(w){return w.name==="SecurityError"?(this.pixelContext_=null,new Uint8Array):m}return m[3]===0?null:m},e.prototype.disposeInternal=function(){delete this.frameState,i.prototype.disposeInternal.call(this)},e}(OI),Wv=PI,re={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};function LI(i,e,t,n,r,o,u,l,h,c,d,_){var v=i[e],y=i[e+1],m=0,w=0,C=0,P=0;function I(){m=v,w=y,e+=n,v=i[e],y=i[e+1],P+=C,C=Math.sqrt((v-m)*(v-m)+(y-w)*(y-w))}do I();while(e<t-n&&P+C<o);for(var A=C===0?0:(o-P)/C,L=gr(m,v,A),F=gr(w,y,A),U=e-n,G=P,X=o+l*h(c,r,d);e<t-n&&P+C<X;)I();A=C===0?0:(X-P)/C;var B=gr(m,v,A),Z=gr(w,y,A),j;if(_){var V=[L,F,B,Z];cv(V,0,4,2,_,V,V),j=V[0]>V[2]}else j=L>B;var tt=Math.PI,rt=[],H=U+n===e;e=U,C=0,P=G,v=i[e],y=i[e+1];var Q;if(H){I(),Q=Math.atan2(y-w,v-m),j&&(Q+=Q>0?-tt:tt);var K=(B+L)/2,nt=(Z+F)/2;return rt[0]=[K,nt,(X-o)/2,Q,r],rt}for(var ut=0,mt=r.length;ut<mt;){I();var pt=Math.atan2(y-w,v-m);if(j&&(pt+=pt>0?-tt:tt),Q!==void 0){var W=pt-Q;if(W+=W>tt?-2*tt:W<-tt?2*tt:0,Math.abs(W)>u)return null}Q=pt;for(var Kt=ut,lt=0;ut<mt;++ut){var _t=j?mt-ut-1:ut,dt=l*h(c,r[_t],d);if(e+n<t&&P+C<o+lt+dt/2)break;lt+=dt}if(ut!==Kt){var Ut=j?r.substring(mt-Kt,mt-ut):r.substring(Kt,ut);A=C===0?0:(o+lt/2-P)/C;var K=gr(m,v,A),nt=gr(w,y,A);rt.push([K,nt,lt/2,pt,Ut]),o+=lt}}return rt}var so=En(),kr=[],hr=[],fr=[],Ur=[];function dp(i){return i[3].declutterBox}var MI=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function pp(i,e){return(e==="start"||e==="end")&&!MI.test(i)&&(e=e==="start"?"left":"right"),eu[e]}function DI(i,e,t){return t>0&&i.push(`
`,""),i.push(e,""),i}var FI=function(){function i(e,t,n,r){this.overlaps=n,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=jn(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return i.prototype.createLabel=function(e,t,n,r){var o=e+t+n+r;if(this.labels_[o])return this.labels_[o];var u=r?this.strokeStates[r]:null,l=n?this.fillStates[n]:null,h=this.textStates[t],c=this.pixelRatio,d=[h.scale[0]*c,h.scale[1]*c],_=Array.isArray(e),v=pp(_?e[0]:e,h.textAlign||pa),y=r&&u.lineWidth?u.lineWidth:0,m=_?e:e.split(`
`).reduce(DI,[]),w=Xw(h,m),C=w.width,P=w.height,I=w.widths,A=w.heights,L=w.lineWidths,F=C+y,U=[],G=(F+2)*d[0],X=(P+y)*d[1],B={width:G<0?Math.floor(G):Math.ceil(G),height:X<0?Math.floor(X):Math.ceil(X),contextInstructions:U};if((d[0]!=1||d[1]!=1)&&U.push("scale",d),r){U.push("strokeStyle",u.strokeStyle),U.push("lineWidth",y),U.push("lineCap",u.lineCap),U.push("lineJoin",u.lineJoin),U.push("miterLimit",u.miterLimit);var Z=_u?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;Z.prototype.setLineDash&&(U.push("setLineDash",[u.lineDash]),U.push("lineDashOffset",u.lineDashOffset))}n&&U.push("fillStyle",l.fillStyle),U.push("textBaseline","middle"),U.push("textAlign","center");for(var j=.5-v,V=v*F+j*y,tt=[],rt=[],H=0,Q=0,K=0,nt=0,ut,mt=0,pt=m.length;mt<pt;mt+=2){var W=m[mt];if(W===`
`){Q+=H,H=0,V=v*F+j*y,++nt;continue}var Kt=m[mt+1]||h.font;Kt!==ut&&(r&&tt.push("font",Kt),n&&rt.push("font",Kt),ut=Kt),H=Math.max(H,A[K]);var lt=[W,V+j*I[K]+v*(I[K]-L[nt]),.5*(y+H)+Q];V+=I[K],r&&tt.push("strokeText",lt),n&&rt.push("fillText",lt),++K}return Array.prototype.push.apply(U,tt),Array.prototype.push.apply(U,rt),this.labels_[o]=B,B},i.prototype.replayTextBackground_=function(e,t,n,r,o,u,l){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,o),e.lineTo.apply(e,t),u&&(this.alignFill_=u[2],this.fill_(e)),l&&(this.setStrokeStyle_(e,l),e.stroke())},i.prototype.calculateImageOrLabelDimensions_=function(e,t,n,r,o,u,l,h,c,d,_,v,y,m,w,C){l*=v[0],h*=v[1];var P=n-l,I=r-h,A=o+c>e?e-c:o,L=u+d>t?t-d:u,F=m[3]+A*v[0]+m[1],U=m[0]+L*v[1]+m[2],G=P-m[3],X=I-m[0];(w||_!==0)&&(kr[0]=G,Ur[0]=G,kr[1]=X,hr[1]=X,hr[0]=G+F,fr[0]=hr[0],fr[1]=X+U,Ur[1]=fr[1]);var B;return _!==0?(B=Tr(jn(),n,r,1,1,_,-n,-r),pe(B,kr),pe(B,hr),pe(B,fr),pe(B,Ur),xr(Math.min(kr[0],hr[0],fr[0],Ur[0]),Math.min(kr[1],hr[1],fr[1],Ur[1]),Math.max(kr[0],hr[0],fr[0],Ur[0]),Math.max(kr[1],hr[1],fr[1],Ur[1]),so)):xr(Math.min(G,G+F),Math.min(X,X+U),Math.max(G,G+F),Math.max(X,X+U),so),y&&(P=Math.round(P),I=Math.round(I)),{drawImageX:P,drawImageY:I,drawImageW:A,drawImageH:L,originX:c,originY:d,declutterBox:{minX:so[0],minY:so[1],maxX:so[2],maxY:so[3],value:C},canvasTransform:B,scale:v}},i.prototype.replayImageOrLabel_=function(e,t,n,r,o,u,l){var h=!!(u||l),c=r.declutterBox,d=e.canvas,_=l?l[2]*r.scale[0]/2:0,v=c.minX-_<=d.width/t&&c.maxX+_>=0&&c.minY-_<=d.height/t&&c.maxY+_>=0;return v&&(h&&this.replayTextBackground_(e,kr,hr,fr,Ur,u,l),Bw(e,r.canvasTransform,o,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0},i.prototype.fill_=function(e){if(this.alignFill_){var t=pe(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;e.save(),e.translate(t[0]%n,t[1]%n),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()},i.prototype.setStrokeStyle_=function(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.setLineDash&&(e.lineDashOffset=t[7],e.setLineDash(t[6]))},i.prototype.drawLabelWithPointPlacement_=function(e,t,n,r){var o=this.textStates[t],u=this.createLabel(e,t,r,n),l=this.strokeStates[n],h=this.pixelRatio,c=pp(Array.isArray(e)?e[0]:e,o.textAlign||pa),d=eu[o.textBaseline||Hs],_=l&&l.lineWidth?l.lineWidth:0,v=u.width/h-2*o.scale[0],y=c*v+2*(.5-c)*_,m=d*u.height/h+2*(.5-d)*_;return{label:u,anchorX:y,anchorY:m}},i.prototype.execute_=function(e,t,n,r,o,u,l,h){var c;this.pixelCoordinates_&&bi(n,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=Ii(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),qx(this.renderedTransform_,n));for(var d=0,_=r.length,v=0,y,m,w,C,P,I,A,L,F,U,G,X,B=0,Z=0,j=null,V=null,tt=this.coordinateCache_,rt=this.viewRotation_,H=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,Q={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:rt},K=this.instructions!=r||this.overlaps?0:200,nt,ut,mt,pt;d<_;){var W=r[d],Kt=W[0];switch(Kt){case ft.BEGIN_GEOMETRY:nt=W[1],pt=W[3],nt.getGeometry()?l!==void 0&&!Ke(l,pt.getExtent())?d=W[2]+1:++d:d=W[2];break;case ft.BEGIN_PATH:B>K&&(this.fill_(e),B=0),Z>K&&(e.stroke(),Z=0),!B&&!Z&&(e.beginPath(),C=NaN,P=NaN),++d;break;case ft.CIRCLE:v=W[1];var lt=c[v],_t=c[v+1],dt=c[v+2],Ut=c[v+3],xt=dt-lt,St=Ut-_t,$e=Math.sqrt(xt*xt+St*St);e.moveTo(lt+$e,_t),e.arc(lt,_t,$e,0,2*Math.PI,!0),++d;break;case ft.CLOSE_PATH:e.closePath(),++d;break;case ft.CUSTOM:v=W[1],y=W[2];var Ee=W[3],qe=W[4],kn=W.length==6?W[5]:void 0;Q.geometry=Ee,Q.feature=nt,d in tt||(tt[d]=[]);var Jt=tt[d];kn?kn(c,v,y,2,Jt):(Jt[0]=c[v],Jt[1]=c[v+1],Jt.length=2),qe(Jt,Q),++d;break;case ft.DRAW_IMAGE:v=W[1],y=W[2],L=W[3],m=W[4],w=W[5];var Ne=W[6],un=W[7],Te=W[8],wn=W[9],ln=W[10],be=W[11],ce=W[12],hn=W[13],Je=W[14];if(!L&&W.length>=19){F=W[18],U=W[19],G=W[20],X=W[21];var wr=this.drawLabelWithPointPlacement_(F,U,G,X);L=wr.label,W[3]=L;var Qn=W[22];m=(wr.anchorX-Qn)*this.pixelRatio,W[4]=m;var Wi=W[23];w=(wr.anchorY-Wi)*this.pixelRatio,W[5]=w,Ne=L.height,W[6]=Ne,hn=L.width,W[13]=hn}var Rn=void 0;W.length>24&&(Rn=W[24]);var Se=void 0,Xe=void 0,Cn=void 0;W.length>16?(Se=W[15],Xe=W[16],Cn=W[17]):(Se=Ti,Xe=!1,Cn=!1),ln&&H?be+=rt:!ln&&!H&&(be-=rt);for(var tr=0;v<y;v+=2)if(!(Rn&&Rn[tr++]<hn/this.pixelRatio)){var xe=this.calculateImageOrLabelDimensions_(L.width,L.height,c[v],c[v+1],hn,Ne,m,w,Te,wn,be,ce,o,Se,Xe||Cn,nt),Rr=[e,t,L,xe,un,Xe?j:null,Cn?V:null],ue=void 0,Un=void 0;if(h&&Je){var In=y-v;if(!Je[In]){Je[In]=Rr;continue}if(ue=Je[In],delete Je[In],Un=dp(ue),h.collides(Un))continue}h&&h.collides(xe.declutterBox)||(ue&&(h&&h.insert(Un),this.replayImageOrLabel_.apply(this,ue)),h&&h.insert(xe.declutterBox),this.replayImageOrLabel_.apply(this,Rr))}++d;break;case ft.DRAW_CHARS:var Xi=W[1],Da=W[2],Lo=W[3],Su=W[4];X=W[5];var Fa=W[6],Mo=W[7],Na=W[8];G=W[9];var Do=W[10];F=W[11],U=W[12];var ba=[W[13],W[13]],Fo=this.textStates[U],Cr=Fo.font,ri=[Fo.scale[0]*Mo,Fo.scale[1]*Mo],ii=void 0;Cr in this.widths_?ii=this.widths_[Cr]:(ii={},this.widths_[Cr]=ii);var Ga=Lv(c,Xi,Da,2),Bi=Math.abs(ri[0])*Xd(Cr,F,ii);if(Su||Bi<=Ga){var Au=this.textStates[U].textAlign,No=(Ga-Bi)*eu[Au],oi=LI(c,Xi,Da,2,F,No,Fa,Math.abs(ri[0]),Xd,Cr,ii,H?0:this.viewRotation_);t:if(oi){var ai=[],Wn=void 0,Yi=void 0,Zi=void 0,Ae=void 0,Be=void 0;if(G)for(Wn=0,Yi=oi.length;Wn<Yi;++Wn){Be=oi[Wn],Zi=Be[4],Ae=this.createLabel(Zi,U,"",G),m=Be[2]+(ri[0]<0?-Do:Do),w=Lo*Ae.height+(.5-Lo)*2*Do*ri[1]/ri[0]-Na;var xe=this.calculateImageOrLabelDimensions_(Ae.width,Ae.height,Be[0],Be[1],Ae.width,Ae.height,m,w,0,0,Be[3],ba,!1,Ti,!1,nt);if(h&&h.collides(xe.declutterBox))break t;ai.push([e,t,Ae,xe,1,null,null])}if(X)for(Wn=0,Yi=oi.length;Wn<Yi;++Wn){Be=oi[Wn],Zi=Be[4],Ae=this.createLabel(Zi,U,X,""),m=Be[2],w=Lo*Ae.height-Na;var xe=this.calculateImageOrLabelDimensions_(Ae.width,Ae.height,Be[0],Be[1],Ae.width,Ae.height,m,w,0,0,Be[3],ba,!1,Ti,!1,nt);if(h&&h.collides(xe.declutterBox))break t;ai.push([e,t,Ae,xe,1,null,null])}h&&h.load(ai.map(dp));for(var bo=0,ka=ai.length;bo<ka;++bo)this.replayImageOrLabel_.apply(this,ai[bo])}}++d;break;case ft.END_GEOMETRY:if(u!==void 0){nt=W[1];var Ua=u(nt,pt);if(Ua)return Ua}++d;break;case ft.FILL:K?B++:this.fill_(e),++d;break;case ft.MOVE_TO_LINE_TO:for(v=W[1],y=W[2],ut=c[v],mt=c[v+1],I=ut+.5|0,A=mt+.5|0,(I!==C||A!==P)&&(e.moveTo(ut,mt),C=I,P=A),v+=2;v<y;v+=2)ut=c[v],mt=c[v+1],I=ut+.5|0,A=mt+.5|0,(v==y-2||I!==C||A!==P)&&(e.lineTo(ut,mt),C=I,P=A);++d;break;case ft.SET_FILL_STYLE:j=W,this.alignFill_=W[2],B&&(this.fill_(e),B=0,Z&&(e.stroke(),Z=0)),e.fillStyle=W[1],++d;break;case ft.SET_STROKE_STYLE:V=W,Z&&(e.stroke(),Z=0),this.setStrokeStyle_(e,W),++d;break;case ft.STROKE:K?Z++:e.stroke(),++d;break;default:++d;break}}B&&this.fill_(e),Z&&e.stroke()},i.prototype.execute=function(e,t,n,r,o,u){this.viewRotation_=r,this.execute_(e,t,n,this.instructions,o,void 0,void 0,u)},i.prototype.executeHitDetection=function(e,t,n,r,o){return this.viewRotation_=n,this.execute_(e,1,t,this.hitDetectionInstructions,!0,r,o)},i}(),NI=FI,ql=[re.POLYGON,re.CIRCLE,re.LINE_STRING,re.IMAGE,re.TEXT,re.DEFAULT],bI=function(){function i(e,t,n,r,o,u){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=t,this.renderBuffer_=u,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=jn(),this.createExecutors_(o)}return i.prototype.clip=function(e,t){var n=this.getClipCoords(t);e.beginPath(),e.moveTo(n[0],n[1]),e.lineTo(n[2],n[3]),e.lineTo(n[4],n[5]),e.lineTo(n[6],n[7]),e.clip()},i.prototype.createExecutors_=function(e){for(var t in e){var n=this.executorsByZIndex_[t];n===void 0&&(n={},this.executorsByZIndex_[t]=n);var r=e[t];for(var o in r){var u=r[o];n[o]=new NI(this.resolution_,this.pixelRatio_,this.overlaps_,u)}}},i.prototype.hasExecutors=function(e){for(var t in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[t],r=0,o=e.length;r<o;++r)if(e[r]in n)return!0;return!1},i.prototype.forEachFeatureAtCoordinate=function(e,t,n,r,o,u){r=Math.round(r);var l=r*2+1,h=Tr(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-n,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Tn(l,l));var d=this.hitDetectionContext_;d.canvas.width!==l||d.canvas.height!==l?(d.canvas.width=l,d.canvas.height=l):c||d.clearRect(0,0,l,l);var _;this.renderBuffer_!==void 0&&(_=En(),sa(_,e),Fh(_,t*(this.renderBuffer_+r),_));var v=GI(r),y;function m(U,G){for(var X=d.getImageData(0,0,l,l).data,B=0,Z=v.length;B<Z;B++)if(X[v[B]]>0){if(!u||y!==re.IMAGE&&y!==re.TEXT||u.indexOf(U)!==-1){var j=(v[B]-3)/4,V=r-j%l,tt=r-(j/l|0),rt=o(U,G,V*V+tt*tt);if(rt)return rt}d.clearRect(0,0,l,l);break}}var w=Object.keys(this.executorsByZIndex_).map(Number);w.sort(Si);var C,P,I,A,L;for(C=w.length-1;C>=0;--C){var F=w[C].toString();for(I=this.executorsByZIndex_[F],P=ql.length-1;P>=0;--P)if(y=ql[P],A=I[y],A!==void 0&&(L=A.executeHitDetection(d,h,n,m,_),L))return L}},i.prototype.getClipCoords=function(e){var t=this.maxExtent_;if(!t)return null;var n=t[0],r=t[1],o=t[2],u=t[3],l=[n,r,n,u,o,u,o,r];return Ii(l,0,8,2,e,l),l},i.prototype.isEmpty=function(){return To(this.executorsByZIndex_)},i.prototype.execute=function(e,t,n,r,o,u,l){var h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(Si),this.maxExtent_&&(e.save(),this.clip(e,n));var c=u||ql,d,_,v,y,m,w;for(l&&h.reverse(),d=0,_=h.length;d<_;++d){var C=h[d].toString();for(m=this.executorsByZIndex_[C],v=0,y=c.length;v<y;++v){var P=c[v];w=m[P],w!==void 0&&w.execute(e,t,n,r,o,l)}}this.maxExtent_&&e.restore()},i}(),Jl={};function GI(i){if(Jl[i]!==void 0)return Jl[i];for(var e=i*2+1,t=i*i,n=new Array(t+1),r=0;r<=i;++r)for(var o=0;o<=i;++o){var u=r*r+o*o;if(u>t)break;var l=n[u];l||(l=[],n[u]=l),l.push(((i+r)*e+(i+o))*4+3),r>0&&l.push(((i-r)*e+(i+o))*4+3),o>0&&(l.push(((i+r)*e+(i-o))*4+3),r>0&&l.push(((i-r)*e+(i-o))*4+3))}for(var h=[],r=0,c=n.length;r<c;++r)n[r]&&h.push.apply(h,n[r]);return Jl[i]=h,h}var vp=bI,kI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),UI=function(i){kI(e,i);function e(t,n,r,o,u,l,h){var c=i.call(this)||this;return c.context_=t,c.pixelRatio_=n,c.extent_=r,c.transform_=o,c.viewRotation_=u,c.squaredTolerance_=l,c.userTransform_=h,c.contextFillState_=null,c.contextStrokeState_=null,c.contextTextState_=null,c.fillState_=null,c.strokeState_=null,c.image_=null,c.imageAnchorX_=0,c.imageAnchorY_=0,c.imageHeight_=0,c.imageOpacity_=0,c.imageOriginX_=0,c.imageOriginY_=0,c.imageRotateWithView_=!1,c.imageRotation_=0,c.imageScale_=[0,0],c.imageWidth_=0,c.text_="",c.textOffsetX_=0,c.textOffsetY_=0,c.textRotateWithView_=!1,c.textRotation_=0,c.textScale_=[0,0],c.textFillState_=null,c.textStrokeState_=null,c.textState_=null,c.pixelCoordinates_=[],c.tmpLocalTransform_=jn(),c}return e.prototype.drawImages_=function(t,n,r,o){if(!!this.image_){var u=Ii(t,n,r,o,this.transform_,this.pixelCoordinates_),l=this.context_,h=this.tmpLocalTransform_,c=l.globalAlpha;this.imageOpacity_!=1&&(l.globalAlpha=c*this.imageOpacity_);var d=this.imageRotation_;this.imageRotateWithView_&&(d+=this.viewRotation_);for(var _=0,v=u.length;_<v;_+=2){var y=u[_]-this.imageAnchorX_,m=u[_+1]-this.imageAnchorY_;if(d!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var w=y+this.imageAnchorX_,C=m+this.imageAnchorY_;Tr(h,w,C,1,1,d,-w,-C),l.setTransform.apply(l,h),l.translate(w,C),l.scale(this.imageScale_[0],this.imageScale_[1]),l.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),l.setTransform(1,0,0,1,0,0)}else l.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,m,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(l.globalAlpha=c)}},e.prototype.drawText_=function(t,n,r,o){if(!(!this.textState_||this.text_==="")){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var u=Ii(t,n,r,o,this.transform_,this.pixelCoordinates_),l=this.context_,h=this.textRotation_;for(this.textRotateWithView_&&(h+=this.viewRotation_);n<r;n+=o){var c=u[n]+this.textOffsetX_,d=u[n+1]+this.textOffsetY_;if(h!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var _=Tr(this.tmpLocalTransform_,c,d,1,1,h,-c,-d);l.setTransform.apply(l,_),l.translate(c,d),l.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&l.strokeText(this.text_,0,0),this.textFillState_&&l.fillText(this.text_,0,0),l.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&l.strokeText(this.text_,c,d),this.textFillState_&&l.fillText(this.text_,c,d)}}},e.prototype.moveToLineTo_=function(t,n,r,o,u){var l=this.context_,h=Ii(t,n,r,o,this.transform_,this.pixelCoordinates_);l.moveTo(h[0],h[1]);var c=h.length;u&&(c-=2);for(var d=2;d<c;d+=2)l.lineTo(h[d],h[d+1]);return u&&l.closePath(),r},e.prototype.drawRings_=function(t,n,r,o){for(var u=0,l=r.length;u<l;++u)n=this.moveToLineTo_(t,n,r[u],o,!0);return n},e.prototype.drawCircle=function(t){if(!!Ke(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=Y1(t,this.transform_,this.pixelCoordinates_),r=n[2]-n[0],o=n[3]-n[1],u=Math.sqrt(r*r+o*o),l=this.context_;l.beginPath(),l.arc(n[0],n[1],u,0,2*Math.PI),this.fillState_&&l.fill(),this.strokeState_&&l.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){var n=t.getType();switch(n){case Y.POINT:this.drawPoint(t);break;case Y.LINE_STRING:this.drawLineString(t);break;case Y.POLYGON:this.drawPolygon(t);break;case Y.MULTI_POINT:this.drawMultiPoint(t);break;case Y.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case Y.MULTI_POLYGON:this.drawMultiPolygon(t);break;case Y.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case Y.CIRCLE:this.drawCircle(t);break}},e.prototype.drawFeature=function(t,n){var r=n.getGeometryFunction()(t);!r||!Ke(this.extent_,r.getExtent())||(this.setStyle(n),this.drawGeometry(r))},e.prototype.drawGeometryCollection=function(t){for(var n=t.getGeometriesArray(),r=0,o=n.length;r<o;++r)this.drawGeometry(n[r])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ke(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,r=t.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(r,0,r.length,t.getStride(),!1),n.stroke()}if(this.text_!==""){var o=t.getFlatMidpoint();this.drawText_(o,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=t.getExtent();if(!!Ke(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var r=this.context_,o=t.getFlatCoordinates(),u=0,l=t.getEnds(),h=t.getStride();r.beginPath();for(var c=0,d=l.length;c<d;++c)u=this.moveToLineTo_(o,u,l[c],h,!1);r.stroke()}if(this.text_!==""){var _=t.getFlatMidpoints();this.drawText_(_,0,_.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ke(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=this.context_;n.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){var r=t.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ke(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=this.context_,r=t.getOrientedFlatCoordinates(),o=0,u=t.getEndss(),l=t.getStride();n.beginPath();for(var h=0,c=u.length;h<c;++h){var d=u[h];o=this.drawRings_(r,o,d,l)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){var _=t.getFlatInteriorPoints();this.drawText_(_,0,_.length,2)}}},e.prototype.setContextFillState_=function(t){var n=this.context_,r=this.contextFillState_;r?r.fillStyle!=t.fillStyle&&(r.fillStyle=t.fillStyle,n.fillStyle=t.fillStyle):(n.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var n=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=t.lineCap&&(r.lineCap=t.lineCap,n.lineCap=t.lineCap),n.setLineDash&&(bi(r.lineDash,t.lineDash)||n.setLineDash(r.lineDash=t.lineDash),r.lineDashOffset!=t.lineDashOffset&&(r.lineDashOffset=t.lineDashOffset,n.lineDashOffset=t.lineDashOffset)),r.lineJoin!=t.lineJoin&&(r.lineJoin=t.lineJoin,n.lineJoin=t.lineJoin),r.lineWidth!=t.lineWidth&&(r.lineWidth=t.lineWidth,n.lineWidth=t.lineWidth),r.miterLimit!=t.miterLimit&&(r.miterLimit=t.miterLimit,n.miterLimit=t.miterLimit),r.strokeStyle!=t.strokeStyle&&(r.strokeStyle=t.strokeStyle,n.strokeStyle=t.strokeStyle)):(n.lineCap=t.lineCap,n.setLineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.lineWidth=t.lineWidth,n.miterLimit=t.miterLimit,n.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var n=this.context_,r=this.contextTextState_,o=t.textAlign?t.textAlign:pa;r?(r.font!=t.font&&(r.font=t.font,n.font=t.font),r.textAlign!=o&&(r.textAlign=o,n.textAlign=o),r.textBaseline!=t.textBaseline&&(r.textBaseline=t.textBaseline,n.textBaseline=t.textBaseline)):(n.font=t.font,n.textAlign=o,n.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:o,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,n){var r=this;if(!t)this.fillState_=null;else{var o=t.getColor();this.fillState_={fillStyle:zn(o||yr)}}if(!n)this.strokeState_=null;else{var u=n.getColor(),l=n.getLineCap(),h=n.getLineDash(),c=n.getLineDashOffset(),d=n.getLineJoin(),_=n.getWidth(),v=n.getMiterLimit(),y=h||ha;this.strokeState_={lineCap:l!==void 0?l:Ks,lineDash:this.pixelRatio_===1?y:y.map(function(m){return m*r.pixelRatio_}),lineDashOffset:(c||fa)*this.pixelRatio_,lineJoin:d!==void 0?d:xo,lineWidth:(_!==void 0?_:va)*this.pixelRatio_,miterLimit:v!==void 0?v:ca,strokeStyle:zn(u||da)}}},e.prototype.setImageStyle=function(t){var n;if(!t||!(n=t.getSize())){this.image_=null;return}var r=t.getAnchor(),o=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*this.pixelRatio_,this.imageAnchorY_=r[1]*this.pixelRatio_,this.imageHeight_=n[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=o[0],this.imageOriginY_=o[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=n[0]*this.pixelRatio_},e.prototype.setTextStyle=function(t){if(!t)this.text_="";else{var n=t.getFill();if(!n)this.textFillState_=null;else{var r=n.getColor();this.textFillState_={fillStyle:zn(r||yr)}}var o=t.getStroke();if(!o)this.textStrokeState_=null;else{var u=o.getColor(),l=o.getLineCap(),h=o.getLineDash(),c=o.getLineDashOffset(),d=o.getLineJoin(),_=o.getWidth(),v=o.getMiterLimit();this.textStrokeState_={lineCap:l!==void 0?l:Ks,lineDash:h||ha,lineDashOffset:c||fa,lineJoin:d!==void 0?d:xo,lineWidth:_!==void 0?_:va,miterLimit:v!==void 0?v:ca,strokeStyle:zn(u||da)}}var y=t.getFont(),m=t.getOffsetX(),w=t.getOffsetY(),C=t.getRotateWithView(),P=t.getRotation(),I=t.getScaleArray(),A=t.getText(),L=t.getTextAlign(),F=t.getTextBaseline();this.textState_={font:y!==void 0?y:nv,textAlign:L!==void 0?L:pa,textBaseline:F!==void 0?F:Hs},this.text_=A!==void 0?Array.isArray(A)?A.reduce(function(U,G,X){return U+=X%2?" ":G},""):A:"",this.textOffsetX_=m!==void 0?this.pixelRatio_*m:0,this.textOffsetY_=w!==void 0?this.pixelRatio_*w:0,this.textRotateWithView_=C!==void 0?C:!1,this.textRotation_=P!==void 0?P:0,this.textScale_=[this.pixelRatio_*I[0],this.pixelRatio_*I[1]]}},e}(kv),WI=UI,zr={FRACTION:"fraction",PIXELS:"pixels"},mn={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},XI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),BI=function(i){XI(e,i);function e(t,n,r,o){var u=i.call(this)||this;return u.extent=t,u.pixelRatio_=r,u.resolution=n,u.state=o,u}return e.prototype.changed=function(){this.dispatchEvent(yt.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return ot()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){ot()},e}(Io),YI=BI,ZI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(i){ZI(e,i);function e(t,n,r,o,u,l){var h=i.call(this,t,n,r,Vt.IDLE)||this;return h.src_=o,h.image_=new Image,u!==null&&(h.image_.crossOrigin=u),h.unlisten_=null,h.state=Vt.IDLE,h.imageLoadFunction_=l,h}return e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=Vt.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=bn(this.extent)/this.image_.height),this.state=Vt.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){(this.state==Vt.IDLE||this.state==Vt.ERROR)&&(this.state=Vt.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=nf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=bn(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e})(YI);function nf(i,e,t){var n=i,r=!0,o=!1,u=!1,l=[zs(n,yt.LOAD,function(){u=!0,o||e()})];return n.src&&Vx?(o=!0,n.decode().then(function(){r&&e()}).catch(function(h){r&&(u?e():t())})):l.push(zs(n,yt.ERROR,t)),function(){r=!1,l.forEach(qt)}}var zI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qo=null,jI=function(i){zI(e,i);function e(t,n,r,o,u,l){var h=i.call(this)||this;return h.hitDetectionImage_=null,h.image_=t||new Image,o!==null&&(h.image_.crossOrigin=o),h.canvas_={},h.color_=l,h.unlisten_=null,h.imageState_=u,h.size_=r,h.src_=n,h.tainted_,h}return e.prototype.isTainted_=function(){if(this.tainted_===void 0&&this.imageState_===Vt.LOADED){Qo||(Qo=Tn(1,1)),Qo.drawImage(this.image_,0,0);try{Qo.getImageData(0,0,1,1),this.tainted_=!1}catch{Qo=null,this.tainted_=!0}}return this.tainted_===!0},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(yt.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=Vt.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=Vt.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],n=this.size_[1],r=Tn(t,n);r.fillRect(0,0,t,n),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==Vt.IDLE){this.imageState_=Vt.LOADING;try{this.image_.src=this.src_}catch{this.handleImageError_()}this.unlisten_=nf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(!(!this.color_||this.canvas_[t]||this.imageState_!==Vt.LOADED)){var n=document.createElement("canvas");this.canvas_[t]=n,n.width=Math.ceil(this.image_.width*t),n.height=Math.ceil(this.image_.height*t);var r=n.getContext("2d");if(r.scale(t,t),r.drawImage(this.image_,0,0),r.globalCompositeOperation="multiply",r.globalCompositeOperation==="multiply"||this.isTainted_())r.fillStyle=jp(this.color_),r.fillRect(0,0,n.width/t,n.height/t),r.globalCompositeOperation="destination-in",r.drawImage(this.image_,0,0);else{for(var o=r.getImageData(0,0,n.width,n.height),u=o.data,l=this.color_[0]/255,h=this.color_[1]/255,c=this.color_[2]/255,d=this.color_[3],_=0,v=u.length;_<v;_+=4)u[_]*=l,u[_+1]*=h,u[_+2]*=c,u[_+3]*=d;r.putImageData(o,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Io);function VI(i,e,t,n,r,o){var u=Zs.get(e,n,o);return u||(u=new jI(i,e,t,n,r,o),Zs.set(e,n,o,u)),u}var KI=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),HI=function(i){KI(e,i);function e(t){var n=this,r=t||{},o=r.opacity!==void 0?r.opacity:1,u=r.rotation!==void 0?r.rotation:0,l=r.scale!==void 0?r.scale:1,h=r.rotateWithView!==void 0?r.rotateWithView:!1;n=i.call(this,{opacity:o,rotation:u,scale:l,displacement:r.displacement!==void 0?r.displacement:[0,0],rotateWithView:h})||this,n.anchor_=r.anchor!==void 0?r.anchor:[.5,.5],n.normalizedAnchor_=null,n.anchorOrigin_=r.anchorOrigin!==void 0?r.anchorOrigin:mn.TOP_LEFT,n.anchorXUnits_=r.anchorXUnits!==void 0?r.anchorXUnits:zr.FRACTION,n.anchorYUnits_=r.anchorYUnits!==void 0?r.anchorYUnits:zr.FRACTION,n.crossOrigin_=r.crossOrigin!==void 0?r.crossOrigin:null;var c=r.img!==void 0?r.img:null;n.imgSize_=r.imgSize;var d=r.src;Pt(!(d!==void 0&&c),4),Pt(!c||c&&n.imgSize_,5),(d===void 0||d.length===0)&&c&&(d=c.src||Mt(c)),Pt(d!==void 0&&d.length>0,6);var _=r.src!==void 0?Vt.IDLE:Vt.LOADED;return n.color_=r.color!==void 0?Ys(r.color):null,n.iconImage_=VI(c,d,n.imgSize_!==void 0?n.imgSize_:null,n.crossOrigin_,_,n.color_),n.offset_=r.offset!==void 0?r.offset:[0,0],n.offsetOrigin_=r.offsetOrigin!==void 0?r.offsetOrigin:mn.TOP_LEFT,n.origin_=null,n.size_=r.size!==void 0?r.size:null,n}return e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc()})},e.prototype.getAnchor=function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var n=this.getSize();if(this.anchorXUnits_==zr.FRACTION||this.anchorYUnits_==zr.FRACTION){if(!n)return null;t=this.anchor_.slice(),this.anchorXUnits_==zr.FRACTION&&(t[0]*=n[0]),this.anchorYUnits_==zr.FRACTION&&(t[1]*=n[1])}if(this.anchorOrigin_!=mn.TOP_LEFT){if(!n)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_==mn.TOP_RIGHT||this.anchorOrigin_==mn.BOTTOM_RIGHT)&&(t[0]=-t[0]+n[0]),(this.anchorOrigin_==mn.BOTTOM_LEFT||this.anchorOrigin_==mn.BOTTOM_RIGHT)&&(t[1]=-t[1]+n[1])}this.normalizedAnchor_=t}var r=this.getDisplacement();return[t[0]-r[0],t[1]+r[1]]},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=mn.TOP_LEFT){var n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;t=t.slice(),(this.offsetOrigin_==mn.TOP_RIGHT||this.offsetOrigin_==mn.BOTTOM_RIGHT)&&(t[0]=r[0]-n[0]-t[0]),(this.offsetOrigin_==mn.BOTTOM_LEFT||this.offsetOrigin_==mn.BOTTOM_RIGHT)&&(t[1]=r[1]-n[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(yt.CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(yt.CHANGE,t)},e}(Nv),$I=HI,qI="#333",JI=function(){function i(e){var t=e||{};this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=an(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new Li({color:qI}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:Uv.POINT,this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}return i.prototype.clone=function(){var e=this.getScale();return new i({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})},i.prototype.getOverflow=function(){return this.overflow_},i.prototype.getFont=function(){return this.font_},i.prototype.getMaxAngle=function(){return this.maxAngle_},i.prototype.getPlacement=function(){return this.placement_},i.prototype.getOffsetX=function(){return this.offsetX_},i.prototype.getOffsetY=function(){return this.offsetY_},i.prototype.getFill=function(){return this.fill_},i.prototype.getRotateWithView=function(){return this.rotateWithView_},i.prototype.getRotation=function(){return this.rotation_},i.prototype.getScale=function(){return this.scale_},i.prototype.getScaleArray=function(){return this.scaleArray_},i.prototype.getStroke=function(){return this.stroke_},i.prototype.getText=function(){return this.text_},i.prototype.getTextAlign=function(){return this.textAlign_},i.prototype.getTextBaseline=function(){return this.textBaseline_},i.prototype.getBackgroundFill=function(){return this.backgroundFill_},i.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},i.prototype.getPadding=function(){return this.padding_},i.prototype.setOverflow=function(e){this.overflow_=e},i.prototype.setFont=function(e){this.font_=e},i.prototype.setMaxAngle=function(e){this.maxAngle_=e},i.prototype.setOffsetX=function(e){this.offsetX_=e},i.prototype.setOffsetY=function(e){this.offsetY_=e},i.prototype.setPlacement=function(e){this.placement_=e},i.prototype.setRotateWithView=function(e){this.rotateWithView_=e},i.prototype.setFill=function(e){this.fill_=e},i.prototype.setRotation=function(e){this.rotation_=e},i.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=an(e!==void 0?e:1)},i.prototype.setStroke=function(e){this.stroke_=e},i.prototype.setText=function(e){this.text_=e},i.prototype.setTextAlign=function(e){this.textAlign_=e},i.prototype.setTextBaseline=function(e){this.textBaseline_=e},i.prototype.setBackgroundFill=function(e){this.backgroundFill_=e},i.prototype.setBackgroundStroke=function(e){this.backgroundStroke_=e},i.prototype.setPadding=function(e){this.padding_=e},i}(),QI=JI,Zn=.5;function tO(i,e,t,n,r,o,u){var l=i[0]*Zn,h=i[1]*Zn,c=Tn(l,h);c.imageSmoothingEnabled=!1;for(var d=c.canvas,_=new WI(c,Zn,r,null,u),v=t.length,y=Math.floor((256*256*256-1)/v),m={},w=1;w<=v;++w){var C=t[w-1],P=C.getStyleFunction()||n;if(!!n){var I=P(C,o);if(!!I){Array.isArray(I)||(I=[I]);for(var A=w*y,L="#"+("000000"+A.toString(16)).slice(-6),F=0,U=I.length;F<U;++F){var G=I[F],X=G.getGeometryFunction()(C);if(!(!X||!Ke(r,X.getExtent()))){var B=G.clone(),Z=B.getFill();Z&&Z.setColor(L);var j=B.getStroke();j&&(j.setColor(L),j.setLineDash(null)),B.setText(void 0);var V=G.getImage();if(V&&V.getOpacity()!==0){var tt=V.getImageSize();if(!tt)continue;var rt=Tn(tt[0],tt[1],void 0,{alpha:!1}),H=rt.canvas;rt.fillStyle=L,rt.fillRect(0,0,H.width,H.height),B.setImage(new $I({img:H,imgSize:tt,anchor:V.getAnchor(),anchorXUnits:zr.PIXELS,anchorYUnits:zr.PIXELS,offset:V.getOrigin(),opacity:1,size:V.getSize(),scale:V.getScale(),rotation:V.getRotation(),rotateWithView:V.getRotateWithView()}))}var Q=B.getZIndex()||0,K=m[Q];K||(K={},m[Q]=K,K[Y.POLYGON]=[],K[Y.CIRCLE]=[],K[Y.LINE_STRING]=[],K[Y.POINT]=[]),K[X.getType().replace("Multi","")].push(X,B)}}}}}for(var nt=Object.keys(m).map(Number).sort(Si),w=0,ut=nt.length;w<ut;++w){var K=m[nt[w]];for(var mt in K)for(var pt=K[mt],F=0,U=pt.length;F<U;F+=2){_.setStyle(pt[F+1]);for(var W=0,Kt=e.length;W<Kt;++W)_.setTransform(e[W]),_.drawGeometry(pt[F])}}return c.getImageData(0,0,d.width,d.height)}function eO(i,e,t){var n=[];if(t){var r=Math.floor(Math.round(i[0])*Zn),o=Math.floor(Math.round(i[1])*Zn),u=(_e(r,0,t.width-1)+_e(o,0,t.height-1)*t.width)*4,l=t.data[u],h=t.data[u+1],c=t.data[u+2],d=c+256*(h+256*l),_=Math.floor((256*256*256-1)/e.length);d&&d%_===0&&n.push(e[d/_-1])}return n}var nO=.5,Xv={Point:fO,LineString:uO,Polygon:dO,MultiPoint:cO,MultiLineString:lO,MultiPolygon:hO,GeometryCollection:sO,Circle:oO};function rO(i,e){return parseInt(Mt(i),10)-parseInt(Mt(e),10)}function iO(i,e){var t=yh(i,e);return t*t}function yh(i,e){return nO*i/e}function oO(i,e,t,n,r){var o=t.getFill(),u=t.getStroke();if(o||u){var l=i.getBuilder(t.getZIndex(),re.CIRCLE);l.setFillStrokeStyle(o,u),l.drawCircle(e,n)}var h=t.getText();if(h&&h.getText()){var c=(r||i).getBuilder(t.getZIndex(),re.TEXT);c.setTextStyle(h),c.drawText(e,n)}}function _p(i,e,t,n,r,o,u){var l=!1,h=t.getImage();if(h){var c=h.getImageState();c==Vt.LOADED||c==Vt.ERROR?h.unlistenImageChange(r):(c==Vt.IDLE&&h.load(),c=h.getImageState(),h.listenImageChange(r),l=!0)}return aO(i,e,t,n,o,u),l}function aO(i,e,t,n,r,o){var u=t.getGeometryFunction()(e);if(!!u){var l=u.simplifyTransformed(n,r),h=t.getRenderer();if(h)Bv(i,l,t,e);else{var c=Xv[l.getType()];c(i,l,t,e,o)}}}function Bv(i,e,t,n){if(e.getType()==Y.GEOMETRY_COLLECTION){for(var r=e.getGeometries(),o=0,u=r.length;o<u;++o)Bv(i,r[o],t,n);return}var l=i.getBuilder(t.getZIndex(),re.DEFAULT);l.drawCustom(e,n,t.getRenderer(),t.getHitDetectionRenderer())}function sO(i,e,t,n,r){var o=e.getGeometriesArray(),u,l;for(u=0,l=o.length;u<l;++u){var h=Xv[o[u].getType()];h(i,o[u],t,n,r)}}function uO(i,e,t,n,r){var o=t.getStroke();if(o){var u=i.getBuilder(t.getZIndex(),re.LINE_STRING);u.setFillStrokeStyle(null,o),u.drawLineString(e,n)}var l=t.getText();if(l&&l.getText()){var h=(r||i).getBuilder(t.getZIndex(),re.TEXT);h.setTextStyle(l),h.drawText(e,n)}}function lO(i,e,t,n,r){var o=t.getStroke();if(o){var u=i.getBuilder(t.getZIndex(),re.LINE_STRING);u.setFillStrokeStyle(null,o),u.drawMultiLineString(e,n)}var l=t.getText();if(l&&l.getText()){var h=(r||i).getBuilder(t.getZIndex(),re.TEXT);h.setTextStyle(l),h.drawText(e,n)}}function hO(i,e,t,n,r){var o=t.getFill(),u=t.getStroke();if(u||o){var l=i.getBuilder(t.getZIndex(),re.POLYGON);l.setFillStrokeStyle(o,u),l.drawMultiPolygon(e,n)}var h=t.getText();if(h&&h.getText()){var c=(r||i).getBuilder(t.getZIndex(),re.TEXT);c.setTextStyle(h),c.drawText(e,n)}}function fO(i,e,t,n,r){var o=t.getImage(),u=t.getText(),l;if(r&&(i=r,l=o&&u&&u.getText()?{}:void 0),o){if(o.getImageState()!=Vt.LOADED)return;var h=i.getBuilder(t.getZIndex(),re.IMAGE);h.setImageStyle(o,l),h.drawPoint(e,n)}if(u&&u.getText()){var c=i.getBuilder(t.getZIndex(),re.TEXT);c.setTextStyle(u,l),c.drawText(e,n)}}function cO(i,e,t,n,r){var o=t.getImage(),u=t.getText(),l;if(r&&(i=r,l=o&&u&&u.getText()?{}:void 0),o){if(o.getImageState()!=Vt.LOADED)return;var h=i.getBuilder(t.getZIndex(),re.IMAGE);h.setImageStyle(o,l),h.drawMultiPoint(e,n)}if(u&&u.getText()){var c=(r||i).getBuilder(t.getZIndex(),re.TEXT);c.setTextStyle(u,l),c.drawText(e,n)}}function dO(i,e,t,n,r){var o=t.getFill(),u=t.getStroke();if(o||u){var l=i.getBuilder(t.getZIndex(),re.POLYGON);l.setFillStrokeStyle(o,u),l.drawPolygon(e,n)}var h=t.getText();if(h&&h.getText()){var c=(r||i).getBuilder(t.getZIndex(),re.TEXT);c.setTextStyle(h),c.drawText(e,n)}}var pO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),vO=function(i){pO(e,i);function e(t){var n=i.call(this,t)||this;return n.boundHandleStyleImageChange_=n.handleStyleImageChange_.bind(n),n.animatingOrInteracting_,n.dirty_=!1,n.hitDetectionImageData_=null,n.renderedFeatures_=null,n.renderedRevision_=-1,n.renderedResolution_=NaN,n.renderedExtent_=En(),n.wrappedRenderedExtent_=En(),n.renderedRotation_,n.renderedCenter_=null,n.renderedProjection_=null,n.renderedRenderOrder_=null,n.replayGroup_=null,n.replayGroupChanged=!0,n.declutterExecutorGroup=null,n.clipping=!0,n}return e.prototype.renderWorlds=function(t,n,r){var o=n.extent,u=n.viewState,l=u.center,h=u.resolution,c=u.projection,d=u.rotation,_=c.getExtent(),v=this.getLayer().getSource(),y=n.pixelRatio,m=n.viewHints,w=!(m[Fe.ANIMATING]||m[Fe.INTERACTING]),C=this.context,P=Math.round(n.size[0]*y),I=Math.round(n.size[1]*y),A=v.getWrapX()&&c.canWrapX(),L=A?se(_):null,F=A?Math.ceil((o[2]-_[2])/L)+1:1,U=A?Math.floor((o[0]-_[0])/L):0;do{var G=this.getRenderTransform(l,h,d,y,P,I,U*L);t.execute(C,1,G,d,w,void 0,r)}while(++U<F)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,n){var r=t.pixelRatio,o=t.layerStatesArray[t.layerIndex];Jx(this.pixelTransform,1/r,1/r),Dh(this.inversePixelTransform,this.pixelTransform);var u=Up(this.pixelTransform);this.useContainer(n,u,o.opacity,this.getBackground(t));var l=this.context,h=l.canvas,c=this.replayGroup_,d=this.declutterExecutorGroup;if((!c||c.isEmpty())&&(!d||d.isEmpty()))return null;var _=Math.round(t.size[0]*r),v=Math.round(t.size[1]*r);h.width!=_||h.height!=v?(h.width=_,h.height=v,h.style.transform!==u&&(h.style.transform=u)):this.containerReused||l.clearRect(0,0,_,v),this.preRender(l,t);var y=t.viewState;y.projection;var m=!1,w=!0;if(o.extent&&this.clipping){var C=xi(o.extent);w=Ke(C,t.extent),m=w&&!vo(C,t.extent),m&&this.clipUnrotated(l,t,C)}w&&this.renderWorlds(c,t),m&&l.restore(),this.postRender(l,t);var P=ev(o.opacity),I=this.container;return P!==I.style.opacity&&(I.style.opacity=P),this.renderedRotation_!==y.rotation&&(this.renderedRotation_=y.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(n){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];pe(this.pixelTransform,r);var o=this.renderedCenter_,u=this.renderedResolution_,l=this.renderedRotation_,h=this.renderedProjection_,c=this.wrappedRenderedExtent_,d=this.getLayer(),_=[],v=r[0]*Zn,y=r[1]*Zn;_.push(this.getRenderTransform(o,u,l,Zn,v,y,0).slice());var m=d.getSource(),w=h.getExtent();if(m.getWrapX()&&h.canWrapX()&&!vo(w,c)){for(var C=c[0],P=se(w),I=0,A=void 0;C<w[0];)--I,A=P*I,_.push(this.getRenderTransform(o,u,l,Zn,v,y,A).slice()),C+=P;for(I=0,C=c[2];C>w[2];)++I,A=P*I,_.push(this.getRenderTransform(o,u,l,Zn,v,y,A).slice()),C-=P}this.hitDetectionImageData_=tO(r,_,this.renderedFeatures_,d.getStyleFunction(),c,u,l)}n(eO(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,n,r,o,u){var l=this;if(!!this.replayGroup_){var h=n.viewState.resolution,c=n.viewState.rotation,d=this.getLayer(),_={},v=function(w,C,P){var I=Mt(w),A=_[I];if(A){if(A!==!0&&P<A.distanceSq){if(P===0)return _[I]=!0,u.splice(u.lastIndexOf(A),1),o(w,d,C);A.geometry=C,A.distanceSq=P}}else{if(P===0)return _[I]=!0,o(w,d,C);u.push(_[I]={feature:w,layer:d,geometry:C,distanceSq:P,callback:o})}},y,m=[this.replayGroup_];return this.declutterExecutorGroup&&m.push(this.declutterExecutorGroup),m.some(function(w){return y=w.forEachFeatureAtCoordinate(t,h,c,r,v,w===l.declutterExecutorGroup&&n.declutterTree?n.declutterTree.all().map(function(C){return C.value}):null)}),y}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var n=this.getLayer(),r=n.getSource();if(!r)return!1;var o=t.viewHints[Fe.ANIMATING],u=t.viewHints[Fe.INTERACTING],l=n.getUpdateWhileAnimating(),h=n.getUpdateWhileInteracting();if(!this.dirty_&&!l&&o||!h&&u)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var c=t.extent,d=t.viewState,_=d.projection,v=d.resolution,y=t.pixelRatio,m=n.getRevision(),w=n.getRenderBuffer(),C=n.getRenderOrder();C===void 0&&(C=rO);var P=d.center.slice(),I=Fh(c,w*v),A=I.slice(),L=[I.slice()],F=_.getExtent();if(r.getWrapX()&&_.canWrapX()&&!vo(F,t.extent)){var U=se(F),G=Math.max(se(I)/2,U);I[0]=F[0]-G,I[2]=F[2]+G,Jp(P,_);var X=ow(L[0],_);X[0]<F[0]&&X[2]<F[2]?L.push([X[0]+U,X[1],X[2]+U,X[3]]):X[0]>F[0]&&X[2]>F[2]&&L.push([X[0]-U,X[1],X[2]-U,X[3]])}if(!this.dirty_&&this.renderedResolution_==v&&this.renderedRevision_==m&&this.renderedRenderOrder_==C&&vo(this.wrappedRenderedExtent_,I))return bi(this.renderedExtent_,A)||(this.hitDetectionImageData_=null,this.renderedExtent_=A),this.renderedCenter_=P,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var B=new cp(yh(v,y),I,v,y),Z;this.getLayer().getDeclutter()&&(Z=new cp(yh(v,y),I,v,y));for(var j,V,tt,V=0,tt=L.length;V<tt;++V)r.loadFeatures(L[V],v,_);var rt=iO(v,y),H=function(mt){var pt,W=mt.getStyleFunction()||n.getStyleFunction();if(W&&(pt=W(mt,v)),pt){var Kt=this.renderFeature(mt,rt,pt,B,j,Z);this.dirty_=this.dirty_||Kt}}.bind(this),Q=hv(I),K=r.getFeaturesInExtent(Q);C&&K.sort(C);for(var V=0,tt=K.length;V<tt;++V)H(K[V]);this.renderedFeatures_=K;var nt=B.finish(),ut=new vp(I,v,y,r.getOverlaps(),nt,n.getRenderBuffer());return Z&&(this.declutterExecutorGroup=new vp(I,v,y,r.getOverlaps(),Z.finish(),n.getRenderBuffer())),this.renderedResolution_=v,this.renderedRevision_=m,this.renderedRenderOrder_=C,this.renderedExtent_=A,this.wrappedRenderedExtent_=I,this.renderedCenter_=P,this.renderedProjection_=_,this.replayGroup_=ut,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,n,r,o,u,l){if(!r)return!1;var h=!1;if(Array.isArray(r))for(var c=0,d=r.length;c<d;++c)h=_p(o,t,r[c],n,this.boundHandleStyleImageChange_,u,l)||h;else h=_p(o,t,r,n,this.boundHandleStyleImageChange_,u,l);return h},e}(Wv),_O=vO,gO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),yO=function(i){gO(e,i);function e(t){return i.call(this,t)||this}return e.prototype.createRenderer=function(){return new _O(this)},e}(sI),Yv=yO,mO=function(){function i(e){this.rbush_=new Fv(e),this.items_={}}return i.prototype.insert=function(e,t){var n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(n),this.items_[Mt(t)]=n},i.prototype.load=function(e,t){for(var n=new Array(t.length),r=0,o=t.length;r<o;r++){var u=e[r],l=t[r],h={minX:u[0],minY:u[1],maxX:u[2],maxY:u[3],value:l};n[r]=h,this.items_[Mt(l)]=h}this.rbush_.load(n)},i.prototype.remove=function(e){var t=Mt(e),n=this.items_[t];return delete this.items_[t],this.rbush_.remove(n)!==null},i.prototype.update=function(e,t){var n=this.items_[Mt(t)],r=[n.minX,n.minY,n.maxX,n.maxY];la(r,e)||(this.remove(t),this.insert(e,t))},i.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(t){return t.value})},i.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},n=this.rbush_.search(t);return n.map(function(r){return r.value})},i.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},i.prototype.forEachInExtent=function(e,t){return this.forEach_(this.getInExtent(e),t)},i.prototype.forEach_=function(e,t){for(var n,r=0,o=e.length;r<o;r++)if(n=t(e[r]),n)return n;return n},i.prototype.isEmpty=function(){return To(this.items_)},i.prototype.clear=function(){this.rbush_.clear(),this.items_={}},i.prototype.getExtent=function(e){var t=this.rbush_.toJSON();return xr(t.minX,t.minY,t.maxX,t.maxY,e)},i.prototype.concat=function(e){this.rbush_.load(e.rbush_.all());for(var t in e.items_)this.items_[t]=e.items_[t]},i}(),gp=mO,EO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),TO=function(i){EO(e,i);function e(t){var n=i.call(this)||this;n.projection=me(t.projection),n.attributions_=yp(t.attributions),n.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,n.loading=!1,n.state_=t.state!==void 0?t.state:ti.READY,n.wrapX_=t.wrapX!==void 0?t.wrapX:!1,n.interpolate_=!!t.interpolate,n.viewResolver=null,n.viewRejector=null;var r=n;return n.viewPromise_=new Promise(function(o,u){r.viewResolver=o,r.viewRejector=u}),n}return e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return ot()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getInterpolate=function(){return this.interpolate_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=yp(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Gn);function yp(i){return i?Array.isArray(i)?function(e){return i}:typeof i=="function"?i:function(e){return[i]}:null}var rf=TO,Mn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function xO(i,e){return[[-1/0,-1/0,1/0,1/0]]}var wO=!1;function RO(i,e,t,n,r,o,u){var l=new XMLHttpRequest;l.open("GET",typeof i=="function"?i(t,n,r):i,!0),e.getType()==fo.ARRAY_BUFFER&&(l.responseType="arraybuffer"),l.withCredentials=wO,l.onload=function(h){if(!l.status||l.status>=200&&l.status<300){var c=e.getType(),d=void 0;c==fo.JSON||c==fo.TEXT?d=l.responseText:c==fo.XML?(d=l.responseXML,d||(d=new DOMParser().parseFromString(l.responseText,"application/xml"))):c==fo.ARRAY_BUFFER&&(d=l.response),d?o(e.readFeatures(d,{extent:t,featureProjection:r}),e.readProjection(d)):u()}else u()},l.onerror=u,l.send()}function mp(i,e){return function(t,n,r,o,u){var l=this;RO(i,e,t,n,r,function(h,c){l.addFeatures(h),o!==void 0&&o(h)},u||Ai)}}var Zv=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Wr=function(i){Zv(e,i);function e(t,n,r){var o=i.call(this,t)||this;return o.feature=n,o.features=r,o}return e}(xn),CO=function(i){Zv(e,i);function e(t){var n=this,r=t||{};n=i.call(this,{attributions:r.attributions,interpolate:!0,projection:void 0,state:ti.READY,wrapX:r.wrapX!==void 0?r.wrapX:!0})||this,n.on,n.once,n.un,n.loader_=Ai,n.format_=r.format,n.overlaps_=r.overlaps===void 0?!0:r.overlaps,n.url_=r.url,r.loader!==void 0?n.loader_=r.loader:n.url_!==void 0&&(Pt(n.format_,7),n.loader_=mp(n.url_,n.format_)),n.strategy_=r.strategy!==void 0?r.strategy:xO;var o=r.useSpatialIndex!==void 0?r.useSpatialIndex:!0;n.featuresRtree_=o?new gp:null,n.loadedExtentsRtree_=new gp,n.loadingExtentsCount_=0,n.nullGeometryFeatures_={},n.idIndex_={},n.uidIndex_={},n.featureChangeKeys_={},n.featuresCollection_=null;var u,l;return Array.isArray(r.features)?l=r.features:r.features&&(u=r.features,l=u.getArray()),!o&&u===void 0&&(u=new sn(l)),l!==void 0&&n.addFeaturesInternal(l),u!==void 0&&n.bindFeaturesCollection_(u),n}return e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var n=Mt(t);if(!this.addToIndex_(n,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(n,t);var r=t.getGeometry();if(r){var o=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(o,t)}else this.nullGeometryFeatures_[n]=t;this.dispatchEvent(new Wr(Mn.ADDFEATURE,t))},e.prototype.setupChangeEvents_=function(t,n){this.featureChangeKeys_[t]=[Gt(n,yt.CHANGE,this.handleFeatureChange_,this),Gt(n,Eo.PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,n){var r=!0,o=n.getId();return o!==void 0&&(o.toString()in this.idIndex_?r=!1:this.idIndex_[o.toString()]=n),r&&(Pt(!(t in this.uidIndex_),30),this.uidIndex_[t]=n),r},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var n=[],r=[],o=[],u=0,l=t.length;u<l;u++){var h=t[u],c=Mt(h);this.addToIndex_(c,h)&&r.push(h)}for(var u=0,d=r.length;u<d;u++){var h=r[u],c=Mt(h);this.setupChangeEvents_(c,h);var _=h.getGeometry();if(_){var v=_.getExtent();n.push(v),o.push(h)}else this.nullGeometryFeatures_[c]=h}if(this.featuresRtree_&&this.featuresRtree_.load(n,o),this.hasListener(Mn.ADDFEATURE))for(var u=0,y=r.length;u<y;u++)this.dispatchEvent(new Wr(Mn.ADDFEATURE,r[u]))},e.prototype.bindFeaturesCollection_=function(t){var n=!1;this.addEventListener(Mn.ADDFEATURE,function(r){n||(n=!0,t.push(r.feature),n=!1)}),this.addEventListener(Mn.REMOVEFEATURE,function(r){n||(n=!0,t.remove(r.feature),n=!1)}),t.addEventListener(Ce.ADD,function(r){n||(n=!0,this.addFeature(r.element),n=!1)}.bind(this)),t.addEventListener(Ce.REMOVE,function(r){n||(n=!0,this.removeFeature(r.element),n=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var n in this.featureChangeKeys_){var r=this.featureChangeKeys_[n];r.forEach(qt)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){var o=function(h){this.removeFeatureInternal(h)}.bind(this);this.featuresRtree_.forEach(o);for(var u in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[u])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var l=new Wr(Mn.CLEAR);this.dispatchEvent(l),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,n){var r=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(r,function(o){var u=o.getGeometry();if(u.intersectsCoordinate(t))return n(o)})},e.prototype.forEachFeatureInExtent=function(t,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)},e.prototype.forEachFeatureIntersectingExtent=function(t,n){return this.forEachFeatureInExtent(t,function(r){var o=r.getGeometry();if(o.intersectsExtent(t)){var u=n(r);if(u)return u}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),To(this.nullGeometryFeatures_)||Nn(t,Kp(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var n=[];return this.forEachFeatureAtCoordinateDirect(t,function(r){n.push(r)}),n},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,n){var r=t[0],o=t[1],u=null,l=[NaN,NaN],h=1/0,c=[-1/0,-1/0,1/0,1/0],d=n||$r;return this.featuresRtree_.forEachInExtent(c,function(_){if(d(_)){var v=_.getGeometry(),y=h;if(h=v.closestPointXY(r,o,l,h),h<y){u=_;var m=Math.sqrt(h);c[0]=r-m,c[1]=o-m,c[2]=r+m,c[3]=o+m}}}),u},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var n=this.idIndex_[t.toString()];return n!==void 0?n:null},e.prototype.getFeatureByUid=function(t){var n=this.uidIndex_[t];return n!==void 0?n:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var n=t.target,r=Mt(n),o=n.getGeometry();if(!o)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[r]=n);else{var u=o.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(u,n)):this.featuresRtree_&&this.featuresRtree_.update(u,n)}var l=n.getId();if(l!==void 0){var h=l.toString();this.idIndex_[h]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[h]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[r]=n;this.changed(),this.dispatchEvent(new Wr(Mn.CHANGEFEATURE,n))},e.prototype.hasFeature=function(t){var n=t.getId();return n!==void 0?n in this.idIndex_:Mt(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&To(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0},e.prototype.loadFeatures=function(t,n,r){for(var o=this.loadedExtentsRtree_,u=this.strategy_(t,n,r),l=function(_,v){var y=u[_],m=o.forEachInExtent(y,function(w){return vo(w.extent,y)});m||(++h.loadingExtentsCount_,h.dispatchEvent(new Wr(Mn.FEATURESLOADSTART)),h.loader_.call(h,y,n,r,function(w){--this.loadingExtentsCount_,this.dispatchEvent(new Wr(Mn.FEATURESLOADEND,void 0,w))}.bind(h),function(){--this.loadingExtentsCount_,this.dispatchEvent(new Wr(Mn.FEATURESLOADERROR))}.bind(h)),o.insert(y,{extent:y.slice()}))},h=this,c=0,d=u.length;c<d;++c)l(c);this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),i.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var n=this.loadedExtentsRtree_,r;n.forEachInExtent(t,function(o){if(la(o.extent,t))return r=o,!0}),r&&n.remove(r)},e.prototype.removeFeature=function(t){if(!!t){var n=Mt(t);n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(t);var r=this.removeFeatureInternal(t);r&&this.changed()}},e.prototype.removeFeatureInternal=function(t){var n=Mt(t),r=this.featureChangeKeys_[n];if(!!r){r.forEach(qt),delete this.featureChangeKeys_[n];var o=t.getId();return o!==void 0&&delete this.idIndex_[o.toString()],delete this.uidIndex_[n],this.dispatchEvent(new Wr(Mn.REMOVEFEATURE,t)),t}},e.prototype.removeFromIdIndex_=function(t){var n=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===t){delete this.idIndex_[r],n=!0;break}return n},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){Pt(this.format_,7),this.url_=t,this.setLoader(mp(t,this.format_))},e}(rf),IO=CO,zv=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),OO={SELECT:"select"},SO=function(i){zv(e,i);function e(t,n,r,o){var u=i.call(this,t)||this;return u.selected=n,u.deselected=r,u.mapBrowserEvent=o,u}return e}(xn),ks={},AO=function(i){zv(e,i);function e(t){var n=i.call(this)||this;n.on,n.once,n.un;var r=t||{};n.boundAddFeature_=n.addFeature_.bind(n),n.boundRemoveFeature_=n.removeFeature_.bind(n),n.condition_=r.condition?r.condition:jR,n.addCondition_=r.addCondition?r.addCondition:ap,n.removeCondition_=r.removeCondition?r.removeCondition:ap,n.toggleCondition_=r.toggleCondition?r.toggleCondition:Ov,n.multi_=r.multi?r.multi:!1,n.filter_=r.filter?r.filter:$r,n.hitTolerance_=r.hitTolerance?r.hitTolerance:0,n.style_=r.style!==void 0?r.style:PO(),n.features_=r.features||new sn;var o;if(r.layers)if(typeof r.layers=="function")o=r.layers;else{var u=r.layers;o=function(l){return Xl(u,l)}}else o=$r;return n.layerFilter_=o,n.featureLayerAssociation_={},n}return e.prototype.addFeatureLayerAssociation_=function(t,n){this.featureLayerAssociation_[Mt(t)]=n},e.prototype.getFeatures=function(){return this.features_},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.getLayer=function(t){return this.featureLayerAssociation_[Mt(t)]},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(t){var n=this.getMap();n&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),i.prototype.setMap.call(this,t),t?(this.features_.addEventListener(Ce.ADD,this.boundAddFeature_),this.features_.addEventListener(Ce.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Ce.ADD,this.boundAddFeature_),this.features_.removeEventListener(Ce.REMOVE,this.boundRemoveFeature_))},e.prototype.addFeature_=function(t){var n=t.element;if(this.style_&&this.applySelectedStyle_(n),!this.getLayer(n)){var r=this.getMap().getAllLayers().find(function(o){if(o instanceof Yv&&o.getSource()&&o.getSource().hasFeature(n))return o});r&&this.addFeatureLayerAssociation_(n,r)}},e.prototype.removeFeature_=function(t){var n=t.element;this.style_&&this.restorePreviousStyle_(n)},e.prototype.getStyle=function(){return this.style_},e.prototype.applySelectedStyle_=function(t){var n=Mt(t);n in ks||(ks[n]=t.getStyle()),t.setStyle(this.style_)},e.prototype.restorePreviousStyle_=function(t){for(var n=this.getMap().getInteractions().getArray(),r=n.length-1;r>=0;--r){var o=n[r];if(o!==this&&o instanceof e&&o.getStyle()&&o.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(o.getStyle());return}}var u=Mt(t);t.setStyle(ks[u]),delete ks[u]},e.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[Mt(t)]},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var n=this.addCondition_(t),r=this.removeCondition_(t),o=this.toggleCondition_(t),u=!n&&!r&&!o,l=t.map,h=this.getFeatures(),c=[],d=[];if(u){Co(this.featureLayerAssociation_),l.forEachFeatureAtPixel(t.pixel,function(w,C){if(this.filter_(w,C))return this.addFeatureLayerAssociation_(w,C),d.push(w),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var _=h.getLength()-1;_>=0;--_){var v=h.item(_),y=d.indexOf(v);y>-1?d.splice(y,1):(h.remove(v),c.push(v))}d.length!==0&&h.extend(d)}else{l.forEachFeatureAtPixel(t.pixel,function(w,C){if(this.filter_(w,C))return(n||o)&&!Xl(h.getArray(),w)?(this.addFeatureLayerAssociation_(w,C),d.push(w)):(r||o)&&Xl(h.getArray(),w)&&(c.push(w),this.removeFeatureLayerAssociation_(w)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var m=c.length-1;m>=0;--m)h.remove(c[m]);h.extend(d)}return(d.length>0||c.length>0)&&this.dispatchEvent(new SO(OO.SELECT,d,c,t)),!0},e}(Ao);function PO(){var i=iI();return Nn(i[Y.POLYGON],i[Y.LINE_STRING]),Nn(i[Y.GEOMETRY_COLLECTION],i[Y.LINE_STRING]),function(e){return e.getGeometry()?i[e.getGeometry().getType()]:null}}var LO=AO;function MO(i){var e=i||{},t=new sn,n=new vC(-.005,.05,100),r=e.altShiftDragRotate!==void 0?e.altShiftDragRotate:!0;r&&t.push(new QR);var o=e.doubleClickZoom!==void 0?e.doubleClickZoom:!0;o&&t.push(new UR({delta:e.zoomDelta,duration:e.zoomDuration}));var u=e.dragPan!==void 0?e.dragPan:!0;u&&t.push(new $R({onFocusOnly:e.onFocusOnly,kinetic:n}));var l=e.pinchRotate!==void 0?e.pinchRotate:!0;l&&t.push(new TC);var h=e.pinchZoom!==void 0?e.pinchZoom:!0;h&&t.push(new RC({duration:e.zoomDuration}));var c=e.keyboard!==void 0?e.keyboard:!0;c&&(t.push(new hC),t.push(new dC({delta:e.zoomDelta,duration:e.zoomDuration})));var d=e.mouseWheelZoom!==void 0?e.mouseWheelZoom:!0;d&&t.push(new yC({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));var _=e.shiftDragZoom!==void 0?e.shiftDragZoom:!0;return _&&t.push(new sC({duration:e.zoomDuration})),t}var DO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),FO=function(i){DO(e,i);function e(t){return t=ve({},t),t.controls||(t.controls=DR()),t.interactions||(t.interactions=MO({onFocusOnly:!0})),i.call(this,t)||this}return e.prototype.createRenderer=function(){return new jw(this)},e}(TR),NO=FO,Us={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"},bO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),GO=function(i){bO(e,i);function e(t){var n=this,r=t||{},o=ve({},r);return delete o.preload,delete o.useInterimTilesOnError,n=i.call(this,o)||this,n.on,n.once,n.un,n.setPreload(r.preload!==void 0?r.preload:0),n.setUseInterimTilesOnError(r.useInterimTilesOnError!==void 0?r.useInterimTilesOnError:!0),n}return e.prototype.getPreload=function(){return this.get(Us.PRELOAD)},e.prototype.setPreload=function(t){this.set(Us.PRELOAD,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Us.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Us.USE_INTERIM_TILES_ON_ERROR,t)},e.prototype.getData=function(t){return i.prototype.getData.call(this,t)},e}(Sa),kO=GO,UO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),WO=function(i){UO(e,i);function e(t,n,r){var o=i.call(this)||this,u=r||{};return o.tileCoord=t,o.state=n,o.interimTile=null,o.key="",o.transition_=u.transition===void 0?250:u.transition,o.transitionStarts_={},o.interpolate=!!u.interpolate,o}return e.prototype.changed=function(){this.dispatchEvent(yt.CHANGE)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==ht.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(!!this.interimTile){var t=this.interimTile,n=this;do{if(t.getState()==ht.LOADED){t.interimTile=null;break}else t.getState()==ht.LOADING?n=t:t.getState()==ht.IDLE?n.interimTile=t.interimTile:n=t;t=n.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==ht.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){ot()},e.prototype.getAlpha=function(t,n){if(!this.transition_)return 1;var r=this.transitionStarts_[t];if(!r)r=n,this.transitionStarts_[t]=r;else if(r===-1)return 1;var o=n-r+1e3/60;return o>=this.transition_?1:fv(o/this.transition_)},e.prototype.inTransition=function(t){return this.transition_?this.transitionStarts_[t]!==-1:!1},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Io),jv=WO,XO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),BO=function(i){XO(e,i);function e(t,n,r,o,u,l){var h=i.call(this,t,n,l)||this;return h.crossOrigin_=o,h.src_=r,h.key=r,h.image_=new Image,o!==null&&(h.image_.crossOrigin=o),h.unlisten_=null,h.tileLoadFunction_=u,h}return e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=ht.LOADED,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){this.state=ht.ERROR,this.unlistenImage_(),this.image_=YO(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=ht.LOADED:this.state=ht.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==ht.ERROR&&(this.state=ht.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ht.IDLE&&(this.state=ht.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=nf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(jv);function YO(){var i=Tn(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}var Vv=BO,ZO=.5,cr=!0,zO=10,Ep=.25,jO=function(){function i(e,t,n,r,o,u){this.sourceProj_=e,this.targetProj_=t;var l={},h=Qs(this.targetProj_,this.sourceProj_);this.transformInv_=function(A){var L=A[0]+"/"+A[1];return l[L]||(l[L]=h(A)),l[L]},this.maxSourceExtent_=r,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&se(r)==se(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?se(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?se(this.targetProj_.getExtent()):null;var c=ki(n),d=mu(n),_=yu(n),v=gu(n),y=this.transformInv_(c),m=this.transformInv_(d),w=this.transformInv_(_),C=this.transformInv_(v),P=zO+(u?Math.max(0,Math.ceil(sw(ih(n)/(u*u*256*256)))):0);if(this.addQuad_(c,d,_,v,y,m,w,C,P),this.wrapsXInSource_){var I=1/0;this.triangles_.forEach(function(A,L,F){I=Math.min(I,A.source[0][0],A.source[1][0],A.source[2][0])}),this.triangles_.forEach(function(A){if(Math.max(A.source[0][0],A.source[1][0],A.source[2][0])-I>this.sourceWorldWidth_/2){var L=[[A.source[0][0],A.source[0][1]],[A.source[1][0],A.source[1][1]],[A.source[2][0],A.source[2][1]]];L[0][0]-I>this.sourceWorldWidth_/2&&(L[0][0]-=this.sourceWorldWidth_),L[1][0]-I>this.sourceWorldWidth_/2&&(L[1][0]-=this.sourceWorldWidth_),L[2][0]-I>this.sourceWorldWidth_/2&&(L[2][0]-=this.sourceWorldWidth_);var F=Math.min(L[0][0],L[1][0],L[2][0]),U=Math.max(L[0][0],L[1][0],L[2][0]);U-F<this.sourceWorldWidth_/2&&(A.source=L)}}.bind(this))}l={}}return i.prototype.addTriangle_=function(e,t,n,r,o,u){this.triangles_.push({source:[r,o,u],target:[e,t,n]})},i.prototype.addQuad_=function(e,t,n,r,o,u,l,h,c){var d=Fd([o,u,l,h]),_=this.sourceWorldWidth_?se(d)/this.sourceWorldWidth_:null,v=this.sourceWorldWidth_,y=this.sourceProj_.canWrapX()&&_>.5&&_<1,m=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var w=Fd([e,t,n,r]),C=se(w)/this.targetWorldWidth_;m=C>Ep||m}!y&&this.sourceProj_.isGlobal()&&_&&(m=_>Ep||m)}if(!(!m&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3])&&!Ke(d,this.maxSourceExtent_))){var P=0;if(!m&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(h[0])||!isFinite(h[1]))){if(c>0)m=!0;else if(P=(!isFinite(o[0])||!isFinite(o[1])?8:0)+(!isFinite(u[0])||!isFinite(u[1])?4:0)+(!isFinite(l[0])||!isFinite(l[1])?2:0)+(!isFinite(h[0])||!isFinite(h[1])?1:0),P!=1&&P!=2&&P!=4&&P!=8)return}if(c>0){if(!m){var I=[(e[0]+n[0])/2,(e[1]+n[1])/2],A=this.transformInv_(I),L=void 0;if(y){var F=(yo(o[0],v)+yo(l[0],v))/2;L=F-yo(A[0],v)}else L=(o[0]+l[0])/2-A[0];var U=(o[1]+l[1])/2-A[1],G=L*L+U*U;m=G>this.errorThresholdSquared_}if(m){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){var X=[(t[0]+n[0])/2,(t[1]+n[1])/2],B=this.transformInv_(X),Z=[(r[0]+e[0])/2,(r[1]+e[1])/2],j=this.transformInv_(Z);this.addQuad_(e,t,X,Z,o,u,B,j,c-1),this.addQuad_(Z,X,n,r,j,B,l,h,c-1)}else{var V=[(e[0]+t[0])/2,(e[1]+t[1])/2],tt=this.transformInv_(V),rt=[(n[0]+r[0])/2,(n[1]+r[1])/2],H=this.transformInv_(rt);this.addQuad_(e,V,rt,r,o,tt,H,h,c-1),this.addQuad_(V,t,n,rt,tt,u,l,H,c-1)}return}}if(y){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(P&11)==0&&this.addTriangle_(e,n,r,o,l,h),(P&14)==0&&this.addTriangle_(e,n,t,o,l,u),P&&((P&13)==0&&this.addTriangle_(t,r,e,u,h,o),(P&7)==0&&this.addTriangle_(t,r,n,u,h,l))}},i.prototype.calculateSourceExtent=function(){var e=En();return this.triangles_.forEach(function(t,n,r){var o=t.source;sa(e,o[0]),sa(e,o[1]),sa(e,o[2])}),e},i.prototype.getTriangles=function(){return this.triangles_},i}(),VO=jO,mh={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},KO={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0},Ql;function Tp(i,e,t,n,r){i.beginPath(),i.moveTo(0,0),i.lineTo(e,t),i.lineTo(n,r),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(e,n)+1,Math.max(t,r)),i.restore()}function th(i,e){return Math.abs(i[e*4]-210)>2||Math.abs(i[e*4+3]-.75*255)>2}function HO(){if(Ql===void 0){var i=document.createElement("canvas").getContext("2d");i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",Tp(i,4,5,4,0),Tp(i,4,5,0,5);var e=i.getImageData(0,0,3,3).data;Ql=th(e,0)||th(e,4)||th(e,8)}return Ql}function xp(i,e,t,n){var r=lv(t,e,i),o=Vd(e,n,t),u=e.getMetersPerUnit();u!==void 0&&(o*=u);var l=i.getMetersPerUnit();l!==void 0&&(o/=l);var h=i.getExtent();if(!h||Ia(h,r)){var c=Vd(i,o,r)/o;isFinite(c)&&c>0&&(o/=c)}return o}function $O(i,e,t,n){var r=Pi(t),o=xp(i,e,r,n);return(!isFinite(o)||o<=0)&&Zp(t,function(u){return o=xp(i,e,u,n),isFinite(o)&&o>0}),o}function qO(i,e,t,n,r,o,u,l,h,c,d,_){var v=Tn(Math.round(t*i),Math.round(t*e));if(_||ve(v,mh),h.length===0)return v.canvas;v.scale(t,t);function y(L){return Math.round(L*t)/t}v.globalCompositeOperation="lighter";var m=En();h.forEach(function(L,F,U){Bp(m,L.extent)});var w=se(m),C=bn(m),P=Tn(Math.round(t*w/n),Math.round(t*C/n));_||ve(P,mh);var I=t/n;h.forEach(function(L,F,U){var G=L.extent[0]-m[0],X=-(L.extent[3]-m[3]),B=se(L.extent),Z=bn(L.extent);L.image.width>0&&L.image.height>0&&P.drawImage(L.image,c,c,L.image.width-2*c,L.image.height-2*c,G*I,X*I,B*I,Z*I)});var A=ki(u);return l.getTriangles().forEach(function(L,F,U){var G=L.source,X=L.target,B=G[0][0],Z=G[0][1],j=G[1][0],V=G[1][1],tt=G[2][0],rt=G[2][1],H=y((X[0][0]-A[0])/o),Q=y(-(X[0][1]-A[1])/o),K=y((X[1][0]-A[0])/o),nt=y(-(X[1][1]-A[1])/o),ut=y((X[2][0]-A[0])/o),mt=y(-(X[2][1]-A[1])/o),pt=B,W=Z;B=0,Z=0,j-=pt,V-=W,tt-=pt,rt-=W;var Kt=[[j,V,0,0,K-H],[tt,rt,0,0,ut-H],[0,0,j,V,nt-Q],[0,0,tt,rt,mt-Q]],lt=lw(Kt);if(!!lt){if(v.save(),v.beginPath(),HO()||!_){v.moveTo(K,nt);for(var _t=4,dt=H-K,Ut=Q-nt,xt=0;xt<_t;xt++)v.lineTo(K+y((xt+1)*dt/_t),nt+y(xt*Ut/(_t-1))),xt!=_t-1&&v.lineTo(K+y((xt+1)*dt/_t),nt+y((xt+1)*Ut/(_t-1)));v.lineTo(ut,mt)}else v.moveTo(K,nt),v.lineTo(H,Q),v.lineTo(ut,mt);v.clip(),v.transform(lt[0],lt[2],lt[1],lt[3],H,Q),v.translate(m[0]-pt,m[3]-W),v.scale(n/t,-n/t),v.drawImage(P.canvas,0,0),v.restore()}}),d&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,l.getTriangles().forEach(function(L,F,U){var G=L.target,X=(G[0][0]-A[0])/o,B=-(G[0][1]-A[1])/o,Z=(G[1][0]-A[0])/o,j=-(G[1][1]-A[1])/o,V=(G[2][0]-A[0])/o,tt=-(G[2][1]-A[1])/o;v.beginPath(),v.moveTo(Z,j),v.lineTo(X,B),v.lineTo(V,tt),v.closePath(),v.stroke()}),v.restore()),v.canvas}var JO=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),QO=function(i){JO(e,i);function e(t,n,r,o,u,l,h,c,d,_,v,y){var m=i.call(this,u,ht.IDLE,{interpolate:!!y})||this;m.renderEdges_=v!==void 0?v:!1,m.pixelRatio_=h,m.gutter_=c,m.canvas_=null,m.sourceTileGrid_=n,m.targetTileGrid_=o,m.wrappedTileCoord_=l||u,m.sourceTiles_=[],m.sourcesListenerKeys_=null,m.sourceZ_=0;var w=o.getTileCoordExtent(m.wrappedTileCoord_),C=m.targetTileGrid_.getExtent(),P=m.sourceTileGrid_.getExtent(),I=C?ua(w,C):w;if(ih(I)===0)return m.state=ht.EMPTY,m;var A=t.getExtent();A&&(P?P=ua(P,A):P=A);var L=o.getResolution(m.wrappedTileCoord_[0]),F=$O(t,r,I,L);if(!isFinite(F)||F<=0)return m.state=ht.EMPTY,m;var U=_!==void 0?_:ZO;if(m.triangulation_=new VO(t,r,I,P,F*U,L),m.triangulation_.getTriangles().length===0)return m.state=ht.EMPTY,m;m.sourceZ_=n.getZForResolution(F);var G=m.triangulation_.calculateSourceExtent();if(P&&(t.canWrapX()?(G[1]=_e(G[1],P[1],P[3]),G[3]=_e(G[3],P[1],P[3])):G=ua(G,P)),!ih(G))m.state=ht.EMPTY;else{for(var X=n.getTileRangeForExtentAndZ(G,m.sourceZ_),B=X.minX;B<=X.maxX;B++)for(var Z=X.minY;Z<=X.maxY;Z++){var j=d(m.sourceZ_,B,Z,h);j&&m.sourceTiles_.push(j)}m.sourceTiles_.length===0&&(m.state=ht.EMPTY)}return m}return e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(d,_,v){d&&d.getState()==ht.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(d.tileCoord),image:d.getImage()})}.bind(this)),this.sourceTiles_.length=0,t.length===0)this.state=ht.ERROR;else{var n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),o=typeof r=="number"?r:r[0],u=typeof r=="number"?r:r[1],l=this.targetTileGrid_.getResolution(n),h=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=qO(o,u,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),l,c,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=ht.LOADED}this.changed()},e.prototype.load=function(){if(this.state==ht.IDLE){this.state=ht.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(n,r,o){var u=n.getState();if(u==ht.IDLE||u==ht.LOADING){t++;var l=Gt(n,yt.CHANGE,function(h){var c=n.getState();(c==ht.LOADED||c==ht.ERROR||c==ht.EMPTY)&&(qt(l),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(l)}}.bind(this)),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(n,r,o){var u=n.getState();u==ht.IDLE&&n.load()})}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(qt),this.sourcesListenerKeys_=null},e}(jv),Kv=QO,Hv=function(){function i(e,t,n,r){this.minX=e,this.maxX=t,this.minY=n,this.maxY=r}return i.prototype.contains=function(e){return this.containsXY(e[1],e[2])},i.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY},i.prototype.containsXY=function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY},i.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY},i.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)},i.prototype.getHeight=function(){return this.maxY-this.minY+1},i.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},i.prototype.getWidth=function(){return this.maxX-this.minX+1},i.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY},i}();function uo(i,e,t,n,r){return r!==void 0?(r.minX=i,r.maxX=e,r.minY=t,r.maxY=n,r):new Hv(i,e,t,n)}var $v=Hv,tS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),eS=function(i){tS(e,i);function e(t){var n=i.call(this,t)||this;return n.extentChanged=!0,n.renderedExtent_=null,n.renderedPixelRatio,n.renderedProjection=null,n.renderedRevision,n.renderedTiles=[],n.newTiles_=!1,n.tmpExtent=En(),n.tmpTileRange_=new $v(0,0,0,0),n}return e.prototype.isDrawableTile=function(t){var n=this.getLayer(),r=t.getState(),o=n.getUseInterimTilesOnError();return r==ht.LOADED||r==ht.EMPTY||r==ht.ERROR&&!o},e.prototype.getTile=function(t,n,r,o){var u=o.pixelRatio,l=o.viewState.projection,h=this.getLayer(),c=h.getSource(),d=c.getTile(t,n,r,u,l);return d.getState()==ht.ERROR&&(h.getUseInterimTilesOnError()?h.getPreload()>0&&(this.newTiles_=!0):d.setState(ht.LOADED)),this.isDrawableTile(d)||(d=d.getInterimTile()),d},e.prototype.getData=function(t){var n=this.frameState;if(!n)return null;var r=this.getLayer(),o=pe(n.pixelToCoordinateTransform,t.slice()),u=r.getExtent();if(u&&!Ia(u,o))return null;for(var l=n.pixelRatio,h=n.viewState.projection,c=n.viewState,d=r.getRenderSource(),_=d.getTileGridForProjection(c.projection),v=d.getTilePixelRatio(n.pixelRatio),y=_.getZForResolution(c.resolution);y>=_.getMinZoom();--y){var m=_.getTileCoordForCoordAndZ(o,y),w=d.getTile(y,m[1],m[2],l,h);if(!(w instanceof Vv||w instanceof Kv))return null;if(w.getState()===ht.LOADED){var C=_.getOrigin(y),P=an(_.getTileSize(y)),I=_.getResolution(y),A=Math.floor(v*((o[0]-C[0])/I-m[1]*P[0])),L=Math.floor(v*((C[1]-o[1])/I-m[2]*P[1]));return this.getImageData(w.getImage(),A,L)}}return null},e.prototype.loadedTileCallback=function(t,n,r){return this.isDrawableTile(r)?i.prototype.loadedTileCallback.call(this,t,n,r):!1},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,n){var r=t.layerStatesArray[t.layerIndex],o=t.viewState,u=o.projection,l=o.resolution,h=o.center,c=o.rotation,d=t.pixelRatio,_=this.getLayer(),v=_.getSource(),y=v.getRevision(),m=v.getTileGridForProjection(u),w=m.getZForResolution(l,v.zDirection),C=m.getResolution(w),P=t.extent,I=r.extent&&xi(r.extent);I&&(P=ua(P,xi(r.extent)));var A=v.getTilePixelRatio(d),L=Math.round(t.size[0]*A),F=Math.round(t.size[1]*A);if(c){var U=Math.round(Math.sqrt(L*L+F*F));L=U,F=U}var G=C*L/2/A,X=C*F/2/A,B=[h[0]-G,h[1]-X,h[0]+G,h[1]+X],Z=m.getTileRangeForExtentAndZ(P,w),j={};j[w]={};var V=this.createLoadedTileFinder(v,u,j),tt=this.tmpExtent,rt=this.tmpTileRange_;this.newTiles_=!1;for(var H=Z.minX;H<=Z.maxX;++H)for(var Q=Z.minY;Q<=Z.maxY;++Q){var K=this.getTile(w,H,Q,t);if(this.isDrawableTile(K)){var nt=Mt(this);if(K.getState()==ht.LOADED){j[w][K.tileCoord.toString()]=K;var ut=K.inTransition(nt);!this.newTiles_&&(ut||this.renderedTiles.indexOf(K)===-1)&&(this.newTiles_=!0)}if(K.getAlpha(nt,t.time)===1)continue}var mt=m.getTileCoordChildTileRange(K.tileCoord,rt,tt),pt=!1;mt&&(pt=V(w+1,mt)),pt||m.forEachTileCoordParentTileRange(K.tileCoord,V,rt,tt)}var W=C/l;Tr(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/A,1/A,c,-L/2,-F/2);var Kt=Up(this.pixelTransform);this.useContainer(n,Kt,r.opacity,this.getBackground(t));var lt=this.context,_t=lt.canvas;Dh(this.inversePixelTransform,this.pixelTransform),Tr(this.tempTransform,L/2,F/2,W,W,0,-L/2,-F/2),_t.width!=L||_t.height!=F?(_t.width=L,_t.height=F):this.containerReused||lt.clearRect(0,0,L,F),I&&this.clipUnrotated(lt,t,I),v.getInterpolate()||ve(lt,mh),this.preRender(lt,t),this.renderedTiles.length=0;var dt=Object.keys(j).map(Number);dt.sort(Si);var Ut,xt,St;r.opacity===1&&(!this.containerReused||v.getOpaque(t.viewState.projection))?dt=dt.reverse():(Ut=[],xt=[]);for(var $e=dt.length-1;$e>=0;--$e){var Ee=dt[$e],qe=v.getTilePixelSize(Ee,d,u),kn=m.getResolution(Ee),Jt=kn/C,Ne=qe[0]*Jt*W,un=qe[1]*Jt*W,Te=m.getTileCoordForCoordAndZ(ki(B),Ee),wn=m.getTileCoordExtent(Te),ln=pe(this.tempTransform,[A*(wn[0]-B[0])/C,A*(B[3]-wn[3])/C]),be=A*v.getGutterForProjection(u),ce=j[Ee];for(var hn in ce){var K=ce[hn],Je=K.tileCoord,wr=Te[1]-Je[1],Qn=Math.round(ln[0]-(wr-1)*Ne),Wi=Te[2]-Je[2],Rn=Math.round(ln[1]-(Wi-1)*un),H=Math.round(ln[0]-wr*Ne),Q=Math.round(ln[1]-Wi*un),Se=Qn-H,Xe=Rn-Q,Cn=w===Ee,ut=Cn&&K.getAlpha(Mt(this),t.time)!==1,tr=!1;if(!ut)if(Ut){St=[H,Q,H+Se,Q,H+Se,Q+Xe,H,Q+Xe];for(var xe=0,Rr=Ut.length;xe<Rr;++xe)if(w!==Ee&&Ee<xt[xe]){var ue=Ut[xe];Ke([H,Q,H+Se,Q+Xe],[ue[0],ue[3],ue[4],ue[7]])&&(tr||(lt.save(),tr=!0),lt.beginPath(),lt.moveTo(St[0],St[1]),lt.lineTo(St[2],St[3]),lt.lineTo(St[4],St[5]),lt.lineTo(St[6],St[7]),lt.moveTo(ue[6],ue[7]),lt.lineTo(ue[4],ue[5]),lt.lineTo(ue[2],ue[3]),lt.lineTo(ue[0],ue[1]),lt.clip())}Ut.push(St),xt.push(Ee)}else lt.clearRect(H,Q,Se,Xe);this.drawTileImage(K,t,H,Q,Se,Xe,be,Cn),Ut&&!ut?(tr&&lt.restore(),this.renderedTiles.unshift(K)):this.renderedTiles.push(K),this.updateUsedTiles(t.usedTiles,v,K)}}this.renderedRevision=y,this.renderedResolution=C,this.extentChanged=!this.renderedExtent_||!la(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=d,this.renderedProjection=u,this.manageTilePyramid(t,v,m,d,u,P,w,_.getPreload()),this.scheduleExpireCache(t,v),this.postRender(lt,t),r.extent&&lt.restore(),ve(lt,KO),Kt!==_t.style.transform&&(_t.style.transform=Kt);var Un=ev(r.opacity),In=this.container;return Un!==In.style.opacity&&(In.style.opacity=Un),this.container},e.prototype.drawTileImage=function(t,n,r,o,u,l,h,c){var d=this.getTileImage(t);if(!!d){var _=Mt(this),v=c?t.getAlpha(_,n.time):1,y=v!==this.context.globalAlpha;y&&(this.context.save(),this.context.globalAlpha=v),this.context.drawImage(d,h,h,d.width-2*h,d.height-2*h,r,o,u,l),y&&this.context.restore(),v!==1?n.animate=!0:c&&t.endTransition(_)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,n){if(n.canExpireCache()){var r=function(o,u,l){var h=Mt(o);h in l.usedTiles&&o.expireCache(l.viewState.projection,l.usedTiles[h])}.bind(null,n);t.postRenderFunctions.push(r)}},e.prototype.updateUsedTiles=function(t,n,r){var o=Mt(n);o in t||(t[o]={}),t[o][r.getKey()]=!0},e.prototype.manageTilePyramid=function(t,n,r,o,u,l,h,c,d){var _=Mt(n);_ in t.wantedTiles||(t.wantedTiles[_]={});var v=t.wantedTiles[_],y=t.tileQueue,m=r.getMinZoom(),w=0,C,P,I,A,L,F;for(F=m;F<=h;++F)for(P=r.getTileRangeForExtentAndZ(l,F,P),I=r.getResolution(F),A=P.minX;A<=P.maxX;++A)for(L=P.minY;L<=P.maxY;++L)h-F<=c?(++w,C=n.getTile(F,A,L,o,u),C.getState()==ht.IDLE&&(v[C.getKey()]=!0,y.isKeyQueued(C.getKey())||y.enqueue([C,_,r.getTileCoordCenter(C.tileCoord),I])),d!==void 0&&d(C)):n.useTile(F,A,L,u);n.updateCacheSize(w,u)},e}(Wv),nS=eS,rS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),iS=function(i){rS(e,i);function e(t){return i.call(this,t)||this}return e.prototype.createRenderer=function(){return new nS(this)},e}(kO),oS=iS,aS=function(){function i(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return i.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},i.prototype.expireCache=function(e){for(;this.canExpireCache();)this.pop()},i.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},i.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},i.prototype.forEach=function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer},i.prototype.get=function(e,t){var n=this.entries_[e];return Pt(n!==void 0,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_},i.prototype.remove=function(e){var t=this.entries_[e];return Pt(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},i.prototype.getCount=function(){return this.count_},i.prototype.getKeys=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.key_;return e},i.prototype.getValues=function(){var e=new Array(this.count_),t=0,n;for(n=this.newest_;n;n=n.older)e[t++]=n.value_;return e},i.prototype.peekLast=function(){return this.oldest_.value_},i.prototype.peekLastKey=function(){return this.oldest_.key_},i.prototype.peekFirstKey=function(){return this.newest_.key_},i.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},i.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},i.prototype.set=function(e,t){Pt(!(e in this.entries_),16);var n={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[e]=n,++this.count_},i.prototype.setSize=function(e){this.highWaterMark=e},i}(),sS=aS;function wp(i,e,t,n){return n!==void 0?(n[0]=i,n[1]=e,n[2]=t,n):[i,e,t]}function Cu(i,e,t){return i+"/"+e+"/"+t}function qv(i){return Cu(i[0],i[1],i[2])}function uS(i){return i.split("/").map(Number)}function lS(i){return(i[1]<<i[0])+i[2]}function hS(i,e){var t=i[0],n=i[1],r=i[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;var o=e.getFullTileRange(t);return o?o.containsXY(n,r):!0}var fS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cS=function(i){fS(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.expireCache=function(t){for(;this.canExpireCache();){var n=this.peekLast();if(n.getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var t=this.peekFirstKey(),n=uS(t),r=n[0];this.forEach(function(o){o.tileCoord[0]!==r&&(this.remove(qv(o.tileCoord)),o.release())}.bind(this))}},e}(sS),Jv=cS,eh={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},dS=[0,0,0],Xr=5,pS=function(){function i(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Pt(Ux(this.resolutions_,function(u,l){return l-u},!0),17);var t;if(!e.origins){for(var n=0,r=this.resolutions_.length-1;n<r;++n)if(!t)t=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Pt(this.origins_.length==this.resolutions_.length,20));var o=e.extent;o!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=ki(o)),Pt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Pt(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Uh,Pt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=o!==void 0?o:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(u,l){var h=new $v(Math.min(0,u[0]),Math.max(u[0]-1,-1),Math.min(0,u[1]),Math.max(u[1]-1,-1));if(o){var c=this.getTileRangeForExtentAndZ(o,l);h.minX=Math.max(c.minX,h.minX),h.maxX=Math.min(c.maxX,h.maxX),h.minY=Math.max(c.minY,h.minY),h.maxY=Math.min(c.maxY,h.maxY)}return h},this):o&&this.calculateTileRanges_(o)}return i.prototype.forEachTileCoord=function(e,t,n){for(var r=this.getTileRangeForExtentAndZ(e,t),o=r.minX,u=r.maxX;o<=u;++o)for(var l=r.minY,h=r.maxY;l<=h;++l)n([t,o,l])},i.prototype.forEachTileCoordParentTileRange=function(e,t,n,r){var o,u,l,h=null,c=e[0]-1;for(this.zoomFactor_===2?(u=e[1],l=e[2]):h=this.getTileCoordExtent(e,r);c>=this.minZoom;){if(this.zoomFactor_===2?(u=Math.floor(u/2),l=Math.floor(l/2),o=uo(u,u,l,l,n)):o=this.getTileRangeForExtentAndZ(h,c,n),t(c,o))return!0;--c}return!1},i.prototype.getExtent=function(){return this.extent_},i.prototype.getMaxZoom=function(){return this.maxZoom},i.prototype.getMinZoom=function(){return this.minZoom},i.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]},i.prototype.getResolution=function(e){return this.resolutions_[e]},i.prototype.getResolutions=function(){return this.resolutions_},i.prototype.getTileCoordChildTileRange=function(e,t,n){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){var r=e[1]*2,o=e[2]*2;return uo(r,r+1,o,o+1,t)}var u=this.getTileCoordExtent(e,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(u,e[0]+1,t)}return null},i.prototype.getTileRangeForTileCoordAndZ=function(e,t,n){if(t>this.maxZoom||t<this.minZoom)return null;var r=e[0],o=e[1],u=e[2];if(t===r)return uo(o,u,o,u,n);if(this.zoomFactor_){var l=Math.pow(this.zoomFactor_,t-r),h=Math.floor(o*l),c=Math.floor(u*l);if(t<r)return uo(h,h,c,c,n);var d=Math.floor(l*(o+1))-1,_=Math.floor(l*(u+1))-1;return uo(h,d,c,_,n)}var v=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(v,t,n)},i.prototype.getTileRangeExtent=function(e,t,n){var r=this.getOrigin(e),o=this.getResolution(e),u=an(this.getTileSize(e),this.tmpSize_),l=r[0]+t.minX*u[0]*o,h=r[0]+(t.maxX+1)*u[0]*o,c=r[1]+t.minY*u[1]*o,d=r[1]+(t.maxY+1)*u[1]*o;return xr(l,c,h,d,n)},i.prototype.getTileRangeForExtentAndZ=function(e,t,n){var r=dS;this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,r);var o=r[1],u=r[2];return this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,r),uo(o,r[1],u,r[2],n)},i.prototype.getTileCoordCenter=function(e){var t=this.getOrigin(e[0]),n=this.getResolution(e[0]),r=an(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*n,t[1]-(e[2]+.5)*r[1]*n]},i.prototype.getTileCoordExtent=function(e,t){var n=this.getOrigin(e[0]),r=this.getResolution(e[0]),o=an(this.getTileSize(e[0]),this.tmpSize_),u=n[0]+e[1]*o[0]*r,l=n[1]-(e[2]+1)*o[1]*r,h=u+o[0]*r,c=l+o[1]*r;return xr(u,l,h,c,t)},i.prototype.getTileCoordForCoordAndResolution=function(e,t,n){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,n)},i.prototype.getTileCoordForXYAndResolution_=function(e,t,n,r,o){var u=this.getZForResolution(n),l=n/this.getResolution(u),h=this.getOrigin(u),c=an(this.getTileSize(u),this.tmpSize_),d=l*(e-h[0])/n/c[0],_=l*(h[1]-t)/n/c[1];return r?(d=As(d,Xr)-1,_=As(_,Xr)-1):(d=Ss(d,Xr),_=Ss(_,Xr)),wp(u,d,_,o)},i.prototype.getTileCoordForXYAndZ_=function(e,t,n,r,o){var u=this.getOrigin(n),l=this.getResolution(n),h=an(this.getTileSize(n),this.tmpSize_),c=(e-u[0])/l/h[0],d=(u[1]-t)/l/h[1];return r?(c=As(c,Xr)-1,d=As(d,Xr)-1):(c=Ss(c,Xr),d=Ss(d,Xr)),wp(n,c,d,o)},i.prototype.getTileCoordForCoordAndZ=function(e,t,n){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,n)},i.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]},i.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]},i.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null},i.prototype.getZForResolution=function(e,t){var n=Mh(this.resolutions_,e,t||0);return _e(n,this.minZoom,this.maxZoom)},i.prototype.calculateTileRanges_=function(e){for(var t=this.resolutions_.length,n=new Array(t),r=this.minZoom;r<t;++r)n[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=n},i}(),Qv=pS;function t_(i){var e=i.getDefaultTileGrid();return e||(e=yS(i),i.setDefaultTileGrid(e)),e}function vS(i,e,t){var n=e[0],r=i.getTileCoordCenter(e),o=of(t);if(Ia(o,r))return e;var u=se(o),l=Math.ceil((o[0]-r[0])/u);return r[0]+=u*l,i.getTileCoordForCoordAndZ(r,n)}function _S(i,e,t,n){var r=n!==void 0?n:na.TOP_LEFT,o=e_(i,e,t);return new Qv({extent:i,origin:nw(i,r),resolutions:o,tileSize:t})}function gS(i){var e=i||{},t=e.extent||me("EPSG:3857").getExtent(),n={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:e_(t,e.maxZoom,e.tileSize,e.maxResolution)};return new Qv(n)}function e_(i,e,t,n){for(var r=e!==void 0?e:u1,o=bn(i),u=se(i),l=an(t!==void 0?t:Uh),h=n>0?n:Math.max(u/l[0],o/l[1]),c=r+1,d=new Array(c),_=0;_<c;++_)d[_]=h/Math.pow(2,_);return d}function yS(i,e,t,n){var r=of(i);return _S(r,e,t,n)}function of(i){i=me(i);var e=i.getExtent();if(!e){var t=180*Kn[mr.DEGREES]/i.getMetersPerUnit();e=xr(-t,-t,t,t)}return e}var n_=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mS=function(i){n_(e,i);function e(t){var n=i.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})||this;n.on,n.once,n.un,n.opaque_=t.opaque!==void 0?t.opaque:!1,n.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,n.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;var r=[256,256];return n.tileGrid&&an(n.tileGrid.getTileSize(n.tileGrid.getMinZoom()),r),n.tileCache=new Jv(t.cacheSize||0),n.tmpSize=[0,0],n.key_=t.key||"",n.tileOptions={transition:t.transition,interpolate:t.interpolate},n.zDirection=t.zDirection?t.zDirection:0,n}return e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,n){var r=this.getTileCacheForProjection(t);r&&r.expireCache(n)},e.prototype.forEachLoadedTile=function(t,n,r,o){var u=this.getTileCacheForProjection(t);if(!u)return!1;for(var l=!0,h,c,d,_=r.minX;_<=r.maxX;++_)for(var v=r.minY;v<=r.maxY;++v)c=Cu(n,_,v),d=!1,u.containsKey(c)&&(h=u.get(c),d=h.getState()===ht.LOADED,d&&(d=o(h)!==!1)),d||(l=!1);return l},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},e.prototype.getTile=function(t,n,r,o,u){return ot()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:t_(t)},e.prototype.getTileCacheForProjection=function(t){return Pt(Ei(this.getProjection(),t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,n,r){var o=this.getTileGridForProjection(r),u=this.getTilePixelRatio(n),l=an(o.getTileSize(t),this.tmpSize);return u==1?l:gR(l,u,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,n){var r=n!==void 0?n:this.getProjection(),o=this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(t=vS(o,t,r)),hS(t,o)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),i.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,n){var r=this.getTileCacheForProjection(n);t>r.highWaterMark&&(r.highWaterMark=t)},e.prototype.useTile=function(t,n,r,o){},e}(rf),ES=function(i){n_(e,i);function e(t,n){var r=i.call(this,t)||this;return r.tile=n,r}return e}(xn),TS=mS;function xS(i,e){var t=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(u,l,h){if(u)return i.replace(t,u[0].toString()).replace(n,u[1].toString()).replace(r,u[2].toString()).replace(o,function(){var c=u[0],d=e.getFullTileRange(c);Pt(d,55);var _=d.getHeight()-u[2]-1;return _.toString()})}}function wS(i,e){for(var t=i.length,n=new Array(t),r=0;r<t;++r)n[r]=xS(i[r],e);return RS(n)}function RS(i){return i.length===1?i[0]:function(e,t,n){if(e){var r=lS(e),o=yo(r,i.length);return i[o](e,t,n)}else return}}function CS(i){var e=[],t=/\{([a-z])-([a-z])\}/.exec(i);if(t){var n=t[1].charCodeAt(0),r=t[2].charCodeAt(0),o=void 0;for(o=n;o<=r;++o)e.push(i.replace(t[0],String.fromCharCode(o)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(i),t){for(var u=parseInt(t[2],10),l=parseInt(t[1],10);l<=u;l++)e.push(i.replace(t[0],l.toString()));return e}return e.push(i),e}var IS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),OS=function(i){IS(e,i);function e(t){var n=i.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return n.generateTileUrlFunction_=n.tileUrlFunction===e.prototype.tileUrlFunction,n.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(n.tileUrlFunction=t.tileUrlFunction),n.urls=null,t.urls?n.setUrls(t.urls):t.url&&n.setUrl(t.url),n.tileLoadingKeys_={},n}return e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var n=t.target,r=Mt(n),o=n.getState(),u;o==ht.LOADING?(this.tileLoadingKeys_[r]=!0,u=eh.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],u=o==ht.ERROR?eh.TILELOADERROR:o==ht.LOADED?eh.TILELOADEND:void 0),u!=null&&this.dispatchEvent(new ES(u,n))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,n){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof n!="undefined"?this.setKey(n):this.changed()},e.prototype.setUrl=function(t){var n=CS(t);this.urls=n,this.setUrls(n)},e.prototype.setUrls=function(t){this.urls=t;var n=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(wS(t,this.tileGrid),n):this.setKey(n)},e.prototype.tileUrlFunction=function(t,n,r){},e.prototype.useTile=function(t,n,r){var o=Cu(t,n,r);this.tileCache.containsKey(o)&&this.tileCache.get(o)},e}(TS),SS=OS,AS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),PS=function(i){AS(e,i);function e(t){var n=this,r=t.imageSmoothing!==void 0?t.imageSmoothing:!0;return t.interpolate!==void 0&&(r=t.interpolate),n=i.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:LS,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:r,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this,n.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,n.tileClass=t.tileClass!==void 0?t.tileClass:Vv,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,n.renderReprojectionEdges_=!1,n}return e.prototype.canExpireCache=function(){if(!cr)return i.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,n){if(!cr){i.prototype.expireCache.call(this,t,n);return}var r=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==r?n:{});for(var o in this.tileCacheForProjection){var u=this.tileCacheForProjection[o];u.expireCache(u==r?n:{})}},e.prototype.getGutterForProjection=function(t){return cr&&this.getProjection()&&t&&!Ei(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getKey=function(){var t=i.prototype.getKey.call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t},e.prototype.getOpaque=function(t){return cr&&this.getProjection()&&t&&!Ei(this.getProjection(),t)?!1:i.prototype.getOpaque.call(this,t)},e.prototype.getTileGridForProjection=function(t){if(!cr)return i.prototype.getTileGridForProjection.call(this,t);var n=this.getProjection();if(this.tileGrid&&(!n||Ei(n,t)))return this.tileGrid;var r=Mt(t);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=t_(t)),this.tileGridForProjection[r]},e.prototype.getTileCacheForProjection=function(t){if(!cr)return i.prototype.getTileCacheForProjection.call(this,t);var n=this.getProjection();if(!n||Ei(n,t))return this.tileCache;var r=Mt(t);return r in this.tileCacheForProjection||(this.tileCacheForProjection[r]=new Jv(this.tileCache.highWaterMark)),this.tileCacheForProjection[r]},e.prototype.createTile_=function(t,n,r,o,u,l){var h=[t,n,r],c=this.getTileCoordForTileUrlFunction(h,u),d=c?this.tileUrlFunction(c,o,u):void 0,_=new this.tileClass(h,d!==void 0?ht.IDLE:ht.EMPTY,d!==void 0?d:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return _.key=l,_.addEventListener(yt.CHANGE,this.handleTileChange.bind(this)),_},e.prototype.getTile=function(t,n,r,o,u){var l=this.getProjection();if(!cr||!l||!u||Ei(l,u))return this.getTileInternal(t,n,r,o,l||u);var h=this.getTileCacheForProjection(u),c=[t,n,r],d=void 0,_=qv(c);h.containsKey(_)&&(d=h.get(_));var v=this.getKey();if(d&&d.key==v)return d;var y=this.getTileGridForProjection(l),m=this.getTileGridForProjection(u),w=this.getTileCoordForTileUrlFunction(c,u),C=new Kv(l,y,u,m,c,w,this.getTilePixelRatio(o),this.getGutter(),function(P,I,A,L){return this.getTileInternal(P,I,A,L,l)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return C.key=v,d?(C.interimTile=d,C.refreshInterimChain(),h.replace(_,C)):h.set(_,C),C},e.prototype.getTileInternal=function(t,n,r,o,u){var l=null,h=Cu(t,n,r),c=this.getKey();if(!this.tileCache.containsKey(h))l=this.createTile_(t,n,r,o,u,c),this.tileCache.set(h,l);else if(l=this.tileCache.get(h),l.key!=c){var d=l;l=this.createTile_(t,n,r,o,u,c),d.getState()==ht.IDLE?l.interimTile=d.interimTile:l.interimTile=d,l.refreshInterimChain(),this.tileCache.replace(h,l)}return l},e.prototype.setRenderReprojectionEdges=function(t){if(!(!cr||this.renderReprojectionEdges_==t)){this.renderReprojectionEdges_=t;for(var n in this.tileCacheForProjection)this.tileCacheForProjection[n].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,n){if(cr){var r=me(t);if(r){var o=Mt(r);o in this.tileGridForProjection||(this.tileGridForProjection[o]=n)}}},e}(SS);function LS(i,e){i.getImage().src=e}var MS=PS,DS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),FS=function(i){DS(e,i);function e(t){var n=t||{},r=n.imageSmoothing!==void 0?n.imageSmoothing:!0;n.interpolate!==void 0&&(r=n.interpolate);var o=n.projection!==void 0?n.projection:"EPSG:3857",u=n.tileGrid!==void 0?n.tileGrid:gS({extent:of(o),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});return i.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:r,opaque:n.opaque,projection:o,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:u,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:n.wrapX!==void 0?n.wrapX:!0,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this}return e}(MS),NS=FS,bS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),GS=function(i){bS(e,i);function e(t){var n=i.call(this)||this;return n.geometries_=t||null,n.changeEventsKeys_=[],n.listenGeometriesChange_(),n}return e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(qt),this.changeEventsKeys_.length=0},e.prototype.listenGeometriesChange_=function(){if(!!this.geometries_)for(var t=0,n=this.geometries_.length;t<n;++t)this.changeEventsKeys_.push(Gt(this.geometries_[t],yt.CHANGE,this.changed,this))},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t},e.prototype.closestPointXY=function(t,n,r,o){if(o<Gi(this.getExtent(),t,n))return o;for(var u=this.geometries_,l=0,h=u.length;l<h;++l)o=u[l].closestPointXY(t,n,r,o);return o},e.prototype.containsXY=function(t,n){for(var r=this.geometries_,o=0,u=r.length;o<u;++o)if(r[o].containsXY(t,n))return!0;return!1},e.prototype.computeExtent=function(t){Oa(t);for(var n=this.geometries_,r=0,o=n.length;r<o;++r)Bp(t,n[r].getExtent());return t},e.prototype.getGeometries=function(){return Rp(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getGeometriesArrayRecursive=function(){for(var t=[],n=this.geometries_,r=0,o=n.length;r<o;++r)n[r].getType()===this.getType()?t=t.concat(n[r].getGeometriesArrayRecursive()):t.push(n[r]);return t},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var n=[],r=this.geometries_,o=!1,u=0,l=r.length;u<l;++u){var h=r[u],c=h.getSimplifiedGeometry(t);n.push(c),c!==h&&(o=!0)}if(o){var d=new e(null);return d.setGeometriesArray(n),d}else return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return Y.GEOMETRY_COLLECTION},e.prototype.intersectsExtent=function(t){for(var n=this.geometries_,r=0,o=n.length;r<o;++r)if(n[r].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return this.geometries_.length===0},e.prototype.rotate=function(t,n){for(var r=this.geometries_,o=0,u=r.length;o<u;++o)r[o].rotate(t,n);this.changed()},e.prototype.scale=function(t,n,r){var o=r;o||(o=Pi(this.getExtent()));for(var u=this.geometries_,l=0,h=u.length;l<h;++l)u[l].scale(t,n,o);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(Rp(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var n=this.geometries_,r=0,o=n.length;r<o;++r)n[r].applyTransform(t);this.changed()},e.prototype.translate=function(t,n){for(var r=this.geometries_,o=0,u=r.length;o<u;++o)r[o].translate(t,n);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),i.prototype.disposeInternal.call(this)},e}(dv);function Rp(i){for(var e=[],t=0,n=i.length;t<n;++t)e.push(i[t].clone());return e}var kS=GS,US=function(){function i(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return i.prototype.getReadOptions=function(e,t){var n;if(t){var r=t.dataProjection?me(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()===mr.TILE_PIXELS&&(r=me(r),r.setWorldExtent(t.extent)),n={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(n)},i.prototype.adaptOptions=function(e){return ve({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},e)},i.prototype.getType=function(){return ot()},i.prototype.readFeature=function(e,t){return ot()},i.prototype.readFeatures=function(e,t){return ot()},i.prototype.readGeometry=function(e,t){return ot()},i.prototype.readProjection=function(e){return ot()},i.prototype.writeFeature=function(e,t){return ot()},i.prototype.writeFeatures=function(e,t){return ot()},i.prototype.writeGeometry=function(e,t){return ot()},i}();function r_(i,e,t){var n=t?me(t.featureProjection):null,r=t?me(t.dataProjection):null,o;if(n&&r&&!Ei(n,r)?o=(e?i.clone():i).transform(e?n:r,e?r:n):o=i,e&&t&&t.decimals!==void 0){var u=Math.pow(10,t.decimals),l=function(h){for(var c=0,d=h.length;c<d;++c)h[c]=Math.round(h[c]*u)/u;return h};o===i&&(o=i.clone()),o.applyTransform(l)}return o}var WS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),XS=function(i){WS(e,i);function e(){return i.call(this)||this}return e.prototype.getType=function(){return fo.JSON},e.prototype.readFeature=function(t,n){return this.readFeatureFromObject(Ws(t),this.getReadOptions(t,n))},e.prototype.readFeatures=function(t,n){return this.readFeaturesFromObject(Ws(t),this.getReadOptions(t,n))},e.prototype.readFeatureFromObject=function(t,n){return ot()},e.prototype.readFeaturesFromObject=function(t,n){return ot()},e.prototype.readGeometry=function(t,n){return this.readGeometryFromObject(Ws(t),this.getReadOptions(t,n))},e.prototype.readGeometryFromObject=function(t,n){return ot()},e.prototype.readProjection=function(t){return this.readProjectionFromObject(Ws(t))},e.prototype.readProjectionFromObject=function(t){return ot()},e.prototype.writeFeature=function(t,n){return JSON.stringify(this.writeFeatureObject(t,n))},e.prototype.writeFeatureObject=function(t,n){return ot()},e.prototype.writeFeatures=function(t,n){return JSON.stringify(this.writeFeaturesObject(t,n))},e.prototype.writeFeaturesObject=function(t,n){return ot()},e.prototype.writeGeometry=function(t,n){return JSON.stringify(this.writeGeometryObject(t,n))},e.prototype.writeGeometryObject=function(t,n){return ot()},e}(US);function Ws(i){if(typeof i=="string"){var e=JSON.parse(i);return e||null}else return i!==null?i:null}var BS=XS,YS=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ZS=function(i){YS(e,i);function e(t){var n=this,r=t||{};return n=i.call(this)||this,n.dataProjection=me(r.dataProjection?r.dataProjection:"EPSG:4326"),r.featureProjection&&(n.defaultFeatureProjection=me(r.featureProjection)),n.geometryName_=r.geometryName,n.extractGeometryName_=r.extractGeometryName,n.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],n}return e.prototype.readFeatureFromObject=function(t,n){var r=null;t.type==="Feature"?r=t:r={type:"Feature",geometry:t,properties:null};var o=Eh(r.geometry,n),u=new SC;return this.geometryName_?u.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in r!==void 0&&u.setGeometryName(r.geometry_name),u.setGeometry(o),"id"in r&&u.setId(r.id),r.properties&&u.setProperties(r.properties,!0),u},e.prototype.readFeaturesFromObject=function(t,n){var r=t,o=null;if(r.type==="FeatureCollection"){var u=t;o=[];for(var l=u.features,h=0,c=l.length;h<c;++h)o.push(this.readFeatureFromObject(l[h],n))}else o=[this.readFeatureFromObject(t,n)];return o},e.prototype.readGeometryFromObject=function(t,n){return Eh(t,n)},e.prototype.readProjectionFromObject=function(t){var n=t.crs,r;return n?n.type=="name"?r=me(n.properties.name):n.type==="EPSG"?r=me("EPSG:"+n.properties.code):Pt(!1,36):r=this.dataProjection,r},e.prototype.writeFeatureObject=function(t,n){n=this.adaptOptions(n);var r={type:"Feature",geometry:null,properties:null},o=t.getId();if(o!==void 0&&(r.id=o),!t.hasProperties())return r;var u=t.getProperties(),l=t.getGeometry();return l&&(r.geometry=Th(l,n),delete u[t.getGeometryName()]),To(u)||(r.properties=u),r},e.prototype.writeFeaturesObject=function(t,n){n=this.adaptOptions(n);for(var r=[],o=0,u=t.length;o<u;++o)r.push(this.writeFeatureObject(t[o],n));return{type:"FeatureCollection",features:r}},e.prototype.writeGeometryObject=function(t,n){return Th(t,this.adaptOptions(n))},e}(BS);function Eh(i,e){if(!i)return null;var t;switch(i.type){case Y.POINT:{t=jS(i);break}case Y.LINE_STRING:{t=VS(i);break}case Y.POLYGON:{t=qS(i);break}case Y.MULTI_POINT:{t=HS(i);break}case Y.MULTI_LINE_STRING:{t=KS(i);break}case Y.MULTI_POLYGON:{t=$S(i);break}case Y.GEOMETRY_COLLECTION:{t=zS(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return r_(t,!1,e)}function zS(i,e){var t=i.geometries.map(function(n){return Eh(n,e)});return new kS(t)}function jS(i){return new tu(i.coordinates)}function VS(i){return new gh(i.coordinates)}function KS(i){return new FC(i.coordinates)}function HS(i){return new Mv(i.coordinates)}function $S(i){return new WC(i.coordinates)}function qS(i){return new ga(i.coordinates)}function Th(i,e){i=r_(i,!0,e);var t=i.getType(),n;switch(t){case Y.POINT:{n=rA(i);break}case Y.LINE_STRING:{n=QS(i);break}case Y.POLYGON:{n=iA(i,e);break}case Y.MULTI_POINT:{n=eA(i);break}case Y.MULTI_LINE_STRING:{n=tA(i);break}case Y.MULTI_POLYGON:{n=nA(i,e);break}case Y.GEOMETRY_COLLECTION:{n=JS(i,e);break}case Y.CIRCLE:{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return n}function JS(i,e){var t=i.getGeometriesArray().map(function(n){var r=ve({},e);return delete r.featureProjection,Th(n,r)});return{type:"GeometryCollection",geometries:t}}function QS(i,e){return{type:"LineString",coordinates:i.getCoordinates()}}function tA(i,e){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function eA(i,e){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function nA(i,e){var t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(t)}}function rA(i,e){return{type:"Point",coordinates:i.getCoordinates()}}function iA(i,e){var t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(t)}}var oA=ZS,ta=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},xh={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(i,e){(function(){var t,n="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",l="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",c=500,d="__lodash_placeholder__",_=1,v=2,y=4,m=1,w=2,C=1,P=2,I=4,A=8,L=16,F=32,U=64,G=128,X=256,B=512,Z=30,j="...",V=800,tt=16,rt=1,H=2,Q=3,K=1/0,nt=9007199254740991,ut=17976931348623157e292,mt=0/0,pt=4294967295,W=pt-1,Kt=pt>>>1,lt=[["ary",G],["bind",C],["bindKey",P],["curry",A],["curryRight",L],["flip",B],["partial",F],["partialRight",U],["rearg",X]],_t="[object Arguments]",dt="[object Array]",Ut="[object AsyncFunction]",xt="[object Boolean]",St="[object Date]",$e="[object DOMException]",Ee="[object Error]",qe="[object Function]",kn="[object GeneratorFunction]",Jt="[object Map]",Ne="[object Number]",un="[object Null]",Te="[object Object]",wn="[object Promise]",ln="[object Proxy]",be="[object RegExp]",ce="[object Set]",hn="[object String]",Je="[object Symbol]",wr="[object Undefined]",Qn="[object WeakMap]",Wi="[object WeakSet]",Rn="[object ArrayBuffer]",Se="[object DataView]",Xe="[object Float32Array]",Cn="[object Float64Array]",tr="[object Int8Array]",xe="[object Int16Array]",Rr="[object Int32Array]",ue="[object Uint8Array]",Un="[object Uint8ClampedArray]",In="[object Uint16Array]",Xi="[object Uint32Array]",Da=/\b__p \+= '';/g,Lo=/\b(__p \+=) '' \+/g,Su=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Fa=/&(?:amp|lt|gt|quot|#39);/g,Mo=/[&<>"']/g,Na=RegExp(Fa.source),Do=RegExp(Mo.source),ba=/<%-([\s\S]+?)%>/g,Fo=/<%([\s\S]+?)%>/g,Cr=/<%=([\s\S]+?)%>/g,ri=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ii=/^\w*$/,Ga=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bi=/[\\^$.*+?()[\]{}|]/g,Au=RegExp(Bi.source),No=/^\s+/,oi=/\s/,ai=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Wn=/\{\n\/\* \[wrapped with (.+)\] \*/,Yi=/,? & /,Zi=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ae=/[()=,{}\[\]\/\s]/,Be=/\\(\\)?/g,bo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ka=/\w*$/,Ua=/^[-+]0x[0-9a-f]+$/i,v_=/^0b[01]+$/i,__=/^\[object .+?Constructor\]$/,g_=/^0o[0-7]+$/i,y_=/^(?:0|[1-9]\d*)$/,m_=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wa=/($^)/,E_=/['\n\r\u2028\u2029\\]/g,Xa="\\ud800-\\udfff",T_="\\u0300-\\u036f",x_="\\ufe20-\\ufe2f",w_="\\u20d0-\\u20ff",sf=T_+x_+w_,uf="\\u2700-\\u27bf",lf="a-z\\xdf-\\xf6\\xf8-\\xff",R_="\\xac\\xb1\\xd7\\xf7",C_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",I_="\\u2000-\\u206f",O_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",hf="A-Z\\xc0-\\xd6\\xd8-\\xde",ff="\\ufe0e\\ufe0f",cf=R_+C_+I_+O_,Pu="['\u2019]",S_="["+Xa+"]",df="["+cf+"]",Ba="["+sf+"]",pf="\\d+",A_="["+uf+"]",vf="["+lf+"]",_f="[^"+Xa+cf+pf+uf+lf+hf+"]",Lu="\\ud83c[\\udffb-\\udfff]",P_="(?:"+Ba+"|"+Lu+")",gf="[^"+Xa+"]",Mu="(?:\\ud83c[\\udde6-\\uddff]){2}",Du="[\\ud800-\\udbff][\\udc00-\\udfff]",zi="["+hf+"]",yf="\\u200d",mf="(?:"+vf+"|"+_f+")",L_="(?:"+zi+"|"+_f+")",Ef="(?:"+Pu+"(?:d|ll|m|re|s|t|ve))?",Tf="(?:"+Pu+"(?:D|LL|M|RE|S|T|VE))?",xf=P_+"?",wf="["+ff+"]?",M_="(?:"+yf+"(?:"+[gf,Mu,Du].join("|")+")"+wf+xf+")*",D_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",F_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rf=wf+xf+M_,N_="(?:"+[A_,Mu,Du].join("|")+")"+Rf,b_="(?:"+[gf+Ba+"?",Ba,Mu,Du,S_].join("|")+")",G_=RegExp(Pu,"g"),k_=RegExp(Ba,"g"),Fu=RegExp(Lu+"(?="+Lu+")|"+b_+Rf,"g"),U_=RegExp([zi+"?"+vf+"+"+Ef+"(?="+[df,zi,"$"].join("|")+")",L_+"+"+Tf+"(?="+[df,zi+mf,"$"].join("|")+")",zi+"?"+mf+"+"+Ef,zi+"+"+Tf,F_,D_,pf,N_].join("|"),"g"),W_=RegExp("["+yf+Xa+sf+ff+"]"),X_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,B_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Y_=-1,Ht={};Ht[Xe]=Ht[Cn]=Ht[tr]=Ht[xe]=Ht[Rr]=Ht[ue]=Ht[Un]=Ht[In]=Ht[Xi]=!0,Ht[_t]=Ht[dt]=Ht[Rn]=Ht[xt]=Ht[Se]=Ht[St]=Ht[Ee]=Ht[qe]=Ht[Jt]=Ht[Ne]=Ht[Te]=Ht[be]=Ht[ce]=Ht[hn]=Ht[Qn]=!1;var zt={};zt[_t]=zt[dt]=zt[Rn]=zt[Se]=zt[xt]=zt[St]=zt[Xe]=zt[Cn]=zt[tr]=zt[xe]=zt[Rr]=zt[Jt]=zt[Ne]=zt[Te]=zt[be]=zt[ce]=zt[hn]=zt[Je]=zt[ue]=zt[Un]=zt[In]=zt[Xi]=!0,zt[Ee]=zt[qe]=zt[Qn]=!1;var Z_={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},z_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},j_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},V_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},K_=parseFloat,H_=parseInt,Cf=typeof ta=="object"&&ta&&ta.Object===Object&&ta,$_=typeof self=="object"&&self&&self.Object===Object&&self,Ie=Cf||$_||Function("return this")(),Nu=e&&!e.nodeType&&e,si=Nu&&!0&&i&&!i.nodeType&&i,If=si&&si.exports===Nu,bu=If&&Cf.process,fn=function(){try{var O=si&&si.require&&si.require("util").types;return O||bu&&bu.binding&&bu.binding("util")}catch{}}(),Of=fn&&fn.isArrayBuffer,Sf=fn&&fn.isDate,Af=fn&&fn.isMap,Pf=fn&&fn.isRegExp,Lf=fn&&fn.isSet,Mf=fn&&fn.isTypedArray;function Qe(O,D,M){switch(M.length){case 0:return O.call(D);case 1:return O.call(D,M[0]);case 2:return O.call(D,M[0],M[1]);case 3:return O.call(D,M[0],M[1],M[2])}return O.apply(D,M)}function q_(O,D,M,$){for(var vt=-1,kt=O==null?0:O.length;++vt<kt;){var ge=O[vt];D($,ge,M(ge),O)}return $}function cn(O,D){for(var M=-1,$=O==null?0:O.length;++M<$&&D(O[M],M,O)!==!1;);return O}function J_(O,D){for(var M=O==null?0:O.length;M--&&D(O[M],M,O)!==!1;);return O}function Df(O,D){for(var M=-1,$=O==null?0:O.length;++M<$;)if(!D(O[M],M,O))return!1;return!0}function Ir(O,D){for(var M=-1,$=O==null?0:O.length,vt=0,kt=[];++M<$;){var ge=O[M];D(ge,M,O)&&(kt[vt++]=ge)}return kt}function Ya(O,D){var M=O==null?0:O.length;return!!M&&ji(O,D,0)>-1}function Gu(O,D,M){for(var $=-1,vt=O==null?0:O.length;++$<vt;)if(M(D,O[$]))return!0;return!1}function Qt(O,D){for(var M=-1,$=O==null?0:O.length,vt=Array($);++M<$;)vt[M]=D(O[M],M,O);return vt}function Or(O,D){for(var M=-1,$=D.length,vt=O.length;++M<$;)O[vt+M]=D[M];return O}function ku(O,D,M,$){var vt=-1,kt=O==null?0:O.length;for($&&kt&&(M=O[++vt]);++vt<kt;)M=D(M,O[vt],vt,O);return M}function Q_(O,D,M,$){var vt=O==null?0:O.length;for($&&vt&&(M=O[--vt]);vt--;)M=D(M,O[vt],vt,O);return M}function Uu(O,D){for(var M=-1,$=O==null?0:O.length;++M<$;)if(D(O[M],M,O))return!0;return!1}var tg=Wu("length");function eg(O){return O.split("")}function ng(O){return O.match(Zi)||[]}function Ff(O,D,M){var $;return M(O,function(vt,kt,ge){if(D(vt,kt,ge))return $=kt,!1}),$}function Za(O,D,M,$){for(var vt=O.length,kt=M+($?1:-1);$?kt--:++kt<vt;)if(D(O[kt],kt,O))return kt;return-1}function ji(O,D,M){return D===D?pg(O,D,M):Za(O,Nf,M)}function rg(O,D,M,$){for(var vt=M-1,kt=O.length;++vt<kt;)if($(O[vt],D))return vt;return-1}function Nf(O){return O!==O}function bf(O,D){var M=O==null?0:O.length;return M?Bu(O,D)/M:mt}function Wu(O){return function(D){return D==null?t:D[O]}}function Xu(O){return function(D){return O==null?t:O[D]}}function Gf(O,D,M,$,vt){return vt(O,function(kt,ge,Zt){M=$?($=!1,kt):D(M,kt,ge,Zt)}),M}function ig(O,D){var M=O.length;for(O.sort(D);M--;)O[M]=O[M].value;return O}function Bu(O,D){for(var M,$=-1,vt=O.length;++$<vt;){var kt=D(O[$]);kt!==t&&(M=M===t?kt:M+kt)}return M}function Yu(O,D){for(var M=-1,$=Array(O);++M<O;)$[M]=D(M);return $}function og(O,D){return Qt(D,function(M){return[M,O[M]]})}function kf(O){return O&&O.slice(0,Bf(O)+1).replace(No,"")}function tn(O){return function(D){return O(D)}}function Zu(O,D){return Qt(D,function(M){return O[M]})}function Go(O,D){return O.has(D)}function Uf(O,D){for(var M=-1,$=O.length;++M<$&&ji(D,O[M],0)>-1;);return M}function Wf(O,D){for(var M=O.length;M--&&ji(D,O[M],0)>-1;);return M}function ag(O,D){for(var M=O.length,$=0;M--;)O[M]===D&&++$;return $}var sg=Xu(Z_),ug=Xu(z_);function lg(O){return"\\"+V_[O]}function hg(O,D){return O==null?t:O[D]}function Vi(O){return W_.test(O)}function fg(O){return X_.test(O)}function cg(O){for(var D,M=[];!(D=O.next()).done;)M.push(D.value);return M}function zu(O){var D=-1,M=Array(O.size);return O.forEach(function($,vt){M[++D]=[vt,$]}),M}function Xf(O,D){return function(M){return O(D(M))}}function Sr(O,D){for(var M=-1,$=O.length,vt=0,kt=[];++M<$;){var ge=O[M];(ge===D||ge===d)&&(O[M]=d,kt[vt++]=M)}return kt}function za(O){var D=-1,M=Array(O.size);return O.forEach(function($){M[++D]=$}),M}function dg(O){var D=-1,M=Array(O.size);return O.forEach(function($){M[++D]=[$,$]}),M}function pg(O,D,M){for(var $=M-1,vt=O.length;++$<vt;)if(O[$]===D)return $;return-1}function vg(O,D,M){for(var $=M+1;$--;)if(O[$]===D)return $;return $}function Ki(O){return Vi(O)?gg(O):tg(O)}function On(O){return Vi(O)?yg(O):eg(O)}function Bf(O){for(var D=O.length;D--&&oi.test(O.charAt(D)););return D}var _g=Xu(j_);function gg(O){for(var D=Fu.lastIndex=0;Fu.test(O);)++D;return D}function yg(O){return O.match(Fu)||[]}function mg(O){return O.match(U_)||[]}var Eg=function O(D){D=D==null?Ie:Hi.defaults(Ie.Object(),D,Hi.pick(Ie,B_));var M=D.Array,$=D.Date,vt=D.Error,kt=D.Function,ge=D.Math,Zt=D.Object,ju=D.RegExp,Tg=D.String,dn=D.TypeError,ja=M.prototype,xg=kt.prototype,$i=Zt.prototype,Va=D["__core-js_shared__"],Ka=xg.toString,Xt=$i.hasOwnProperty,wg=0,Yf=function(){var a=/[^.]+$/.exec(Va&&Va.keys&&Va.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Ha=$i.toString,Rg=Ka.call(Zt),Cg=Ie._,Ig=ju("^"+Ka.call(Xt).replace(Bi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$a=If?D.Buffer:t,Ar=D.Symbol,qa=D.Uint8Array,Zf=$a?$a.allocUnsafe:t,Ja=Xf(Zt.getPrototypeOf,Zt),zf=Zt.create,jf=$i.propertyIsEnumerable,Qa=ja.splice,Vf=Ar?Ar.isConcatSpreadable:t,ko=Ar?Ar.iterator:t,ui=Ar?Ar.toStringTag:t,ts=function(){try{var a=di(Zt,"defineProperty");return a({},"",{}),a}catch{}}(),Og=D.clearTimeout!==Ie.clearTimeout&&D.clearTimeout,Sg=$&&$.now!==Ie.Date.now&&$.now,Ag=D.setTimeout!==Ie.setTimeout&&D.setTimeout,es=ge.ceil,ns=ge.floor,Vu=Zt.getOwnPropertySymbols,Pg=$a?$a.isBuffer:t,Kf=D.isFinite,Lg=ja.join,Mg=Xf(Zt.keys,Zt),ye=ge.max,Pe=ge.min,Dg=$.now,Fg=D.parseInt,Hf=ge.random,Ng=ja.reverse,Ku=di(D,"DataView"),Uo=di(D,"Map"),Hu=di(D,"Promise"),qi=di(D,"Set"),Wo=di(D,"WeakMap"),Xo=di(Zt,"create"),rs=Wo&&new Wo,Ji={},bg=pi(Ku),Gg=pi(Uo),kg=pi(Hu),Ug=pi(qi),Wg=pi(Wo),is=Ar?Ar.prototype:t,Bo=is?is.valueOf:t,$f=is?is.toString:t;function E(a){if(ie(a)&&!gt(a)&&!(a instanceof Lt)){if(a instanceof pn)return a;if(Xt.call(a,"__wrapped__"))return qc(a)}return new pn(a)}var Qi=function(){function a(){}return function(s){if(!ee(s))return{};if(zf)return zf(s);a.prototype=s;var f=new a;return a.prototype=t,f}}();function os(){}function pn(a,s){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=t}E.templateSettings={escape:ba,evaluate:Fo,interpolate:Cr,variable:"",imports:{_:E}},E.prototype=os.prototype,E.prototype.constructor=E,pn.prototype=Qi(os.prototype),pn.prototype.constructor=pn;function Lt(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=pt,this.__views__=[]}function Xg(){var a=new Lt(this.__wrapped__);return a.__actions__=Ye(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=Ye(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=Ye(this.__views__),a}function Bg(){if(this.__filtered__){var a=new Lt(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function Yg(){var a=this.__wrapped__.value(),s=this.__dir__,f=gt(a),p=s<0,g=f?a.length:0,T=em(0,g,this.__views__),x=T.start,R=T.end,S=R-x,N=p?R:x-1,b=this.__iteratees__,k=b.length,z=0,et=Pe(S,this.__takeCount__);if(!f||!p&&g==S&&et==S)return Ec(a,this.__actions__);var at=[];t:for(;S--&&z<et;){N+=s;for(var wt=-1,st=a[N];++wt<k;){var At=b[wt],Dt=At.iteratee,rn=At.type,Ue=Dt(st);if(rn==H)st=Ue;else if(!Ue){if(rn==rt)continue t;break t}}at[z++]=st}return at}Lt.prototype=Qi(os.prototype),Lt.prototype.constructor=Lt;function li(a){var s=-1,f=a==null?0:a.length;for(this.clear();++s<f;){var p=a[s];this.set(p[0],p[1])}}function Zg(){this.__data__=Xo?Xo(null):{},this.size=0}function zg(a){var s=this.has(a)&&delete this.__data__[a];return this.size-=s?1:0,s}function jg(a){var s=this.__data__;if(Xo){var f=s[a];return f===h?t:f}return Xt.call(s,a)?s[a]:t}function Vg(a){var s=this.__data__;return Xo?s[a]!==t:Xt.call(s,a)}function Kg(a,s){var f=this.__data__;return this.size+=this.has(a)?0:1,f[a]=Xo&&s===t?h:s,this}li.prototype.clear=Zg,li.prototype.delete=zg,li.prototype.get=jg,li.prototype.has=Vg,li.prototype.set=Kg;function er(a){var s=-1,f=a==null?0:a.length;for(this.clear();++s<f;){var p=a[s];this.set(p[0],p[1])}}function Hg(){this.__data__=[],this.size=0}function $g(a){var s=this.__data__,f=as(s,a);if(f<0)return!1;var p=s.length-1;return f==p?s.pop():Qa.call(s,f,1),--this.size,!0}function qg(a){var s=this.__data__,f=as(s,a);return f<0?t:s[f][1]}function Jg(a){return as(this.__data__,a)>-1}function Qg(a,s){var f=this.__data__,p=as(f,a);return p<0?(++this.size,f.push([a,s])):f[p][1]=s,this}er.prototype.clear=Hg,er.prototype.delete=$g,er.prototype.get=qg,er.prototype.has=Jg,er.prototype.set=Qg;function nr(a){var s=-1,f=a==null?0:a.length;for(this.clear();++s<f;){var p=a[s];this.set(p[0],p[1])}}function ty(){this.size=0,this.__data__={hash:new li,map:new(Uo||er),string:new li}}function ey(a){var s=ys(this,a).delete(a);return this.size-=s?1:0,s}function ny(a){return ys(this,a).get(a)}function ry(a){return ys(this,a).has(a)}function iy(a,s){var f=ys(this,a),p=f.size;return f.set(a,s),this.size+=f.size==p?0:1,this}nr.prototype.clear=ty,nr.prototype.delete=ey,nr.prototype.get=ny,nr.prototype.has=ry,nr.prototype.set=iy;function hi(a){var s=-1,f=a==null?0:a.length;for(this.__data__=new nr;++s<f;)this.add(a[s])}function oy(a){return this.__data__.set(a,h),this}function ay(a){return this.__data__.has(a)}hi.prototype.add=hi.prototype.push=oy,hi.prototype.has=ay;function Sn(a){var s=this.__data__=new er(a);this.size=s.size}function sy(){this.__data__=new er,this.size=0}function uy(a){var s=this.__data__,f=s.delete(a);return this.size=s.size,f}function ly(a){return this.__data__.get(a)}function hy(a){return this.__data__.has(a)}function fy(a,s){var f=this.__data__;if(f instanceof er){var p=f.__data__;if(!Uo||p.length<r-1)return p.push([a,s]),this.size=++f.size,this;f=this.__data__=new nr(p)}return f.set(a,s),this.size=f.size,this}Sn.prototype.clear=sy,Sn.prototype.delete=uy,Sn.prototype.get=ly,Sn.prototype.has=hy,Sn.prototype.set=fy;function qf(a,s){var f=gt(a),p=!f&&vi(a),g=!f&&!p&&Fr(a),T=!f&&!p&&!g&&ro(a),x=f||p||g||T,R=x?Yu(a.length,Tg):[],S=R.length;for(var N in a)(s||Xt.call(a,N))&&!(x&&(N=="length"||g&&(N=="offset"||N=="parent")||T&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||ar(N,S)))&&R.push(N);return R}function Jf(a){var s=a.length;return s?a[al(0,s-1)]:t}function cy(a,s){return ms(Ye(a),fi(s,0,a.length))}function dy(a){return ms(Ye(a))}function $u(a,s,f){(f!==t&&!An(a[s],f)||f===t&&!(s in a))&&rr(a,s,f)}function Yo(a,s,f){var p=a[s];(!(Xt.call(a,s)&&An(p,f))||f===t&&!(s in a))&&rr(a,s,f)}function as(a,s){for(var f=a.length;f--;)if(An(a[f][0],s))return f;return-1}function py(a,s,f,p){return Pr(a,function(g,T,x){s(p,g,f(g),x)}),p}function Qf(a,s){return a&&Bn(s,we(s),a)}function vy(a,s){return a&&Bn(s,ze(s),a)}function rr(a,s,f){s=="__proto__"&&ts?ts(a,s,{configurable:!0,enumerable:!0,value:f,writable:!0}):a[s]=f}function qu(a,s){for(var f=-1,p=s.length,g=M(p),T=a==null;++f<p;)g[f]=T?t:Ll(a,s[f]);return g}function fi(a,s,f){return a===a&&(f!==t&&(a=a<=f?a:f),s!==t&&(a=a>=s?a:s)),a}function vn(a,s,f,p,g,T){var x,R=s&_,S=s&v,N=s&y;if(f&&(x=g?f(a,p,g,T):f(a)),x!==t)return x;if(!ee(a))return a;var b=gt(a);if(b){if(x=rm(a),!R)return Ye(a,x)}else{var k=Le(a),z=k==qe||k==kn;if(Fr(a))return wc(a,R);if(k==Te||k==_t||z&&!g){if(x=S||z?{}:Bc(a),!R)return S?jy(a,vy(x,a)):zy(a,Qf(x,a))}else{if(!zt[k])return g?a:{};x=im(a,k,R)}}T||(T=new Sn);var et=T.get(a);if(et)return et;T.set(a,x),gd(a)?a.forEach(function(st){x.add(vn(st,s,f,st,a,T))}):vd(a)&&a.forEach(function(st,At){x.set(At,vn(st,s,f,At,a,T))});var at=N?S?gl:_l:S?ze:we,wt=b?t:at(a);return cn(wt||a,function(st,At){wt&&(At=st,st=a[At]),Yo(x,At,vn(st,s,f,At,a,T))}),x}function _y(a){var s=we(a);return function(f){return tc(f,a,s)}}function tc(a,s,f){var p=f.length;if(a==null)return!p;for(a=Zt(a);p--;){var g=f[p],T=s[g],x=a[g];if(x===t&&!(g in a)||!T(x))return!1}return!0}function ec(a,s,f){if(typeof a!="function")throw new dn(u);return $o(function(){a.apply(t,f)},s)}function Zo(a,s,f,p){var g=-1,T=Ya,x=!0,R=a.length,S=[],N=s.length;if(!R)return S;f&&(s=Qt(s,tn(f))),p?(T=Gu,x=!1):s.length>=r&&(T=Go,x=!1,s=new hi(s));t:for(;++g<R;){var b=a[g],k=f==null?b:f(b);if(b=p||b!==0?b:0,x&&k===k){for(var z=N;z--;)if(s[z]===k)continue t;S.push(b)}else T(s,k,p)||S.push(b)}return S}var Pr=Sc(Xn),nc=Sc(Qu,!0);function gy(a,s){var f=!0;return Pr(a,function(p,g,T){return f=!!s(p,g,T),f}),f}function ss(a,s,f){for(var p=-1,g=a.length;++p<g;){var T=a[p],x=s(T);if(x!=null&&(R===t?x===x&&!nn(x):f(x,R)))var R=x,S=T}return S}function yy(a,s,f,p){var g=a.length;for(f=Tt(f),f<0&&(f=-f>g?0:g+f),p=p===t||p>g?g:Tt(p),p<0&&(p+=g),p=f>p?0:md(p);f<p;)a[f++]=s;return a}function rc(a,s){var f=[];return Pr(a,function(p,g,T){s(p,g,T)&&f.push(p)}),f}function Oe(a,s,f,p,g){var T=-1,x=a.length;for(f||(f=am),g||(g=[]);++T<x;){var R=a[T];s>0&&f(R)?s>1?Oe(R,s-1,f,p,g):Or(g,R):p||(g[g.length]=R)}return g}var Ju=Ac(),ic=Ac(!0);function Xn(a,s){return a&&Ju(a,s,we)}function Qu(a,s){return a&&ic(a,s,we)}function us(a,s){return Ir(s,function(f){return sr(a[f])})}function ci(a,s){s=Mr(s,a);for(var f=0,p=s.length;a!=null&&f<p;)a=a[Yn(s[f++])];return f&&f==p?a:t}function oc(a,s,f){var p=s(a);return gt(a)?p:Or(p,f(a))}function Ge(a){return a==null?a===t?wr:un:ui&&ui in Zt(a)?tm(a):dm(a)}function tl(a,s){return a>s}function my(a,s){return a!=null&&Xt.call(a,s)}function Ey(a,s){return a!=null&&s in Zt(a)}function Ty(a,s,f){return a>=Pe(s,f)&&a<ye(s,f)}function el(a,s,f){for(var p=f?Gu:Ya,g=a[0].length,T=a.length,x=T,R=M(T),S=1/0,N=[];x--;){var b=a[x];x&&s&&(b=Qt(b,tn(s))),S=Pe(b.length,S),R[x]=!f&&(s||g>=120&&b.length>=120)?new hi(x&&b):t}b=a[0];var k=-1,z=R[0];t:for(;++k<g&&N.length<S;){var et=b[k],at=s?s(et):et;if(et=f||et!==0?et:0,!(z?Go(z,at):p(N,at,f))){for(x=T;--x;){var wt=R[x];if(!(wt?Go(wt,at):p(a[x],at,f)))continue t}z&&z.push(at),N.push(et)}}return N}function xy(a,s,f,p){return Xn(a,function(g,T,x){s(p,f(g),T,x)}),p}function zo(a,s,f){s=Mr(s,a),a=jc(a,s);var p=a==null?a:a[Yn(gn(s))];return p==null?t:Qe(p,a,f)}function ac(a){return ie(a)&&Ge(a)==_t}function wy(a){return ie(a)&&Ge(a)==Rn}function Ry(a){return ie(a)&&Ge(a)==St}function jo(a,s,f,p,g){return a===s?!0:a==null||s==null||!ie(a)&&!ie(s)?a!==a&&s!==s:Cy(a,s,f,p,jo,g)}function Cy(a,s,f,p,g,T){var x=gt(a),R=gt(s),S=x?dt:Le(a),N=R?dt:Le(s);S=S==_t?Te:S,N=N==_t?Te:N;var b=S==Te,k=N==Te,z=S==N;if(z&&Fr(a)){if(!Fr(s))return!1;x=!0,b=!1}if(z&&!b)return T||(T=new Sn),x||ro(a)?Uc(a,s,f,p,g,T):Jy(a,s,S,f,p,g,T);if(!(f&m)){var et=b&&Xt.call(a,"__wrapped__"),at=k&&Xt.call(s,"__wrapped__");if(et||at){var wt=et?a.value():a,st=at?s.value():s;return T||(T=new Sn),g(wt,st,f,p,T)}}return z?(T||(T=new Sn),Qy(a,s,f,p,g,T)):!1}function Iy(a){return ie(a)&&Le(a)==Jt}function nl(a,s,f,p){var g=f.length,T=g,x=!p;if(a==null)return!T;for(a=Zt(a);g--;){var R=f[g];if(x&&R[2]?R[1]!==a[R[0]]:!(R[0]in a))return!1}for(;++g<T;){R=f[g];var S=R[0],N=a[S],b=R[1];if(x&&R[2]){if(N===t&&!(S in a))return!1}else{var k=new Sn;if(p)var z=p(N,b,S,a,s,k);if(!(z===t?jo(b,N,m|w,p,k):z))return!1}}return!0}function sc(a){if(!ee(a)||um(a))return!1;var s=sr(a)?Ig:__;return s.test(pi(a))}function Oy(a){return ie(a)&&Ge(a)==be}function Sy(a){return ie(a)&&Le(a)==ce}function Ay(a){return ie(a)&&Cs(a.length)&&!!Ht[Ge(a)]}function uc(a){return typeof a=="function"?a:a==null?je:typeof a=="object"?gt(a)?fc(a[0],a[1]):hc(a):Pd(a)}function rl(a){if(!Ho(a))return Mg(a);var s=[];for(var f in Zt(a))Xt.call(a,f)&&f!="constructor"&&s.push(f);return s}function Py(a){if(!ee(a))return cm(a);var s=Ho(a),f=[];for(var p in a)p=="constructor"&&(s||!Xt.call(a,p))||f.push(p);return f}function il(a,s){return a<s}function lc(a,s){var f=-1,p=Ze(a)?M(a.length):[];return Pr(a,function(g,T,x){p[++f]=s(g,T,x)}),p}function hc(a){var s=ml(a);return s.length==1&&s[0][2]?Zc(s[0][0],s[0][1]):function(f){return f===a||nl(f,a,s)}}function fc(a,s){return Tl(a)&&Yc(s)?Zc(Yn(a),s):function(f){var p=Ll(f,a);return p===t&&p===s?Ml(f,a):jo(s,p,m|w)}}function ls(a,s,f,p,g){a!==s&&Ju(s,function(T,x){if(g||(g=new Sn),ee(T))Ly(a,s,x,f,ls,p,g);else{var R=p?p(wl(a,x),T,x+"",a,s,g):t;R===t&&(R=T),$u(a,x,R)}},ze)}function Ly(a,s,f,p,g,T,x){var R=wl(a,f),S=wl(s,f),N=x.get(S);if(N){$u(a,f,N);return}var b=T?T(R,S,f+"",a,s,x):t,k=b===t;if(k){var z=gt(S),et=!z&&Fr(S),at=!z&&!et&&ro(S);b=S,z||et||at?gt(R)?b=R:le(R)?b=Ye(R):et?(k=!1,b=wc(S,!0)):at?(k=!1,b=Rc(S,!0)):b=[]:qo(S)||vi(S)?(b=R,vi(R)?b=Ed(R):(!ee(R)||sr(R))&&(b=Bc(S))):k=!1}k&&(x.set(S,b),g(b,S,p,T,x),x.delete(S)),$u(a,f,b)}function cc(a,s){var f=a.length;if(!!f)return s+=s<0?f:0,ar(s,f)?a[s]:t}function dc(a,s,f){s.length?s=Qt(s,function(T){return gt(T)?function(x){return ci(x,T.length===1?T[0]:T)}:T}):s=[je];var p=-1;s=Qt(s,tn(it()));var g=lc(a,function(T,x,R){var S=Qt(s,function(N){return N(T)});return{criteria:S,index:++p,value:T}});return ig(g,function(T,x){return Zy(T,x,f)})}function My(a,s){return pc(a,s,function(f,p){return Ml(a,p)})}function pc(a,s,f){for(var p=-1,g=s.length,T={};++p<g;){var x=s[p],R=ci(a,x);f(R,x)&&Vo(T,Mr(x,a),R)}return T}function Dy(a){return function(s){return ci(s,a)}}function ol(a,s,f,p){var g=p?rg:ji,T=-1,x=s.length,R=a;for(a===s&&(s=Ye(s)),f&&(R=Qt(a,tn(f)));++T<x;)for(var S=0,N=s[T],b=f?f(N):N;(S=g(R,b,S,p))>-1;)R!==a&&Qa.call(R,S,1),Qa.call(a,S,1);return a}function vc(a,s){for(var f=a?s.length:0,p=f-1;f--;){var g=s[f];if(f==p||g!==T){var T=g;ar(g)?Qa.call(a,g,1):ll(a,g)}}return a}function al(a,s){return a+ns(Hf()*(s-a+1))}function Fy(a,s,f,p){for(var g=-1,T=ye(es((s-a)/(f||1)),0),x=M(T);T--;)x[p?T:++g]=a,a+=f;return x}function sl(a,s){var f="";if(!a||s<1||s>nt)return f;do s%2&&(f+=a),s=ns(s/2),s&&(a+=a);while(s);return f}function It(a,s){return Rl(zc(a,s,je),a+"")}function Ny(a){return Jf(io(a))}function by(a,s){var f=io(a);return ms(f,fi(s,0,f.length))}function Vo(a,s,f,p){if(!ee(a))return a;s=Mr(s,a);for(var g=-1,T=s.length,x=T-1,R=a;R!=null&&++g<T;){var S=Yn(s[g]),N=f;if(S==="__proto__"||S==="constructor"||S==="prototype")return a;if(g!=x){var b=R[S];N=p?p(b,S,R):t,N===t&&(N=ee(b)?b:ar(s[g+1])?[]:{})}Yo(R,S,N),R=R[S]}return a}var _c=rs?function(a,s){return rs.set(a,s),a}:je,Gy=ts?function(a,s){return ts(a,"toString",{configurable:!0,enumerable:!1,value:Fl(s),writable:!0})}:je;function ky(a){return ms(io(a))}function _n(a,s,f){var p=-1,g=a.length;s<0&&(s=-s>g?0:g+s),f=f>g?g:f,f<0&&(f+=g),g=s>f?0:f-s>>>0,s>>>=0;for(var T=M(g);++p<g;)T[p]=a[p+s];return T}function Uy(a,s){var f;return Pr(a,function(p,g,T){return f=s(p,g,T),!f}),!!f}function hs(a,s,f){var p=0,g=a==null?p:a.length;if(typeof s=="number"&&s===s&&g<=Kt){for(;p<g;){var T=p+g>>>1,x=a[T];x!==null&&!nn(x)&&(f?x<=s:x<s)?p=T+1:g=T}return g}return ul(a,s,je,f)}function ul(a,s,f,p){var g=0,T=a==null?0:a.length;if(T===0)return 0;s=f(s);for(var x=s!==s,R=s===null,S=nn(s),N=s===t;g<T;){var b=ns((g+T)/2),k=f(a[b]),z=k!==t,et=k===null,at=k===k,wt=nn(k);if(x)var st=p||at;else N?st=at&&(p||z):R?st=at&&z&&(p||!et):S?st=at&&z&&!et&&(p||!wt):et||wt?st=!1:st=p?k<=s:k<s;st?g=b+1:T=b}return Pe(T,W)}function gc(a,s){for(var f=-1,p=a.length,g=0,T=[];++f<p;){var x=a[f],R=s?s(x):x;if(!f||!An(R,S)){var S=R;T[g++]=x===0?0:x}}return T}function yc(a){return typeof a=="number"?a:nn(a)?mt:+a}function en(a){if(typeof a=="string")return a;if(gt(a))return Qt(a,en)+"";if(nn(a))return $f?$f.call(a):"";var s=a+"";return s=="0"&&1/a==-K?"-0":s}function Lr(a,s,f){var p=-1,g=Ya,T=a.length,x=!0,R=[],S=R;if(f)x=!1,g=Gu;else if(T>=r){var N=s?null:$y(a);if(N)return za(N);x=!1,g=Go,S=new hi}else S=s?[]:R;t:for(;++p<T;){var b=a[p],k=s?s(b):b;if(b=f||b!==0?b:0,x&&k===k){for(var z=S.length;z--;)if(S[z]===k)continue t;s&&S.push(k),R.push(b)}else g(S,k,f)||(S!==R&&S.push(k),R.push(b))}return R}function ll(a,s){return s=Mr(s,a),a=jc(a,s),a==null||delete a[Yn(gn(s))]}function mc(a,s,f,p){return Vo(a,s,f(ci(a,s)),p)}function fs(a,s,f,p){for(var g=a.length,T=p?g:-1;(p?T--:++T<g)&&s(a[T],T,a););return f?_n(a,p?0:T,p?T+1:g):_n(a,p?T+1:0,p?g:T)}function Ec(a,s){var f=a;return f instanceof Lt&&(f=f.value()),ku(s,function(p,g){return g.func.apply(g.thisArg,Or([p],g.args))},f)}function hl(a,s,f){var p=a.length;if(p<2)return p?Lr(a[0]):[];for(var g=-1,T=M(p);++g<p;)for(var x=a[g],R=-1;++R<p;)R!=g&&(T[g]=Zo(T[g]||x,a[R],s,f));return Lr(Oe(T,1),s,f)}function Tc(a,s,f){for(var p=-1,g=a.length,T=s.length,x={};++p<g;){var R=p<T?s[p]:t;f(x,a[p],R)}return x}function fl(a){return le(a)?a:[]}function cl(a){return typeof a=="function"?a:je}function Mr(a,s){return gt(a)?a:Tl(a,s)?[a]:$c(Wt(a))}var Wy=It;function Dr(a,s,f){var p=a.length;return f=f===t?p:f,!s&&f>=p?a:_n(a,s,f)}var xc=Og||function(a){return Ie.clearTimeout(a)};function wc(a,s){if(s)return a.slice();var f=a.length,p=Zf?Zf(f):new a.constructor(f);return a.copy(p),p}function dl(a){var s=new a.constructor(a.byteLength);return new qa(s).set(new qa(a)),s}function Xy(a,s){var f=s?dl(a.buffer):a.buffer;return new a.constructor(f,a.byteOffset,a.byteLength)}function By(a){var s=new a.constructor(a.source,ka.exec(a));return s.lastIndex=a.lastIndex,s}function Yy(a){return Bo?Zt(Bo.call(a)):{}}function Rc(a,s){var f=s?dl(a.buffer):a.buffer;return new a.constructor(f,a.byteOffset,a.length)}function Cc(a,s){if(a!==s){var f=a!==t,p=a===null,g=a===a,T=nn(a),x=s!==t,R=s===null,S=s===s,N=nn(s);if(!R&&!N&&!T&&a>s||T&&x&&S&&!R&&!N||p&&x&&S||!f&&S||!g)return 1;if(!p&&!T&&!N&&a<s||N&&f&&g&&!p&&!T||R&&f&&g||!x&&g||!S)return-1}return 0}function Zy(a,s,f){for(var p=-1,g=a.criteria,T=s.criteria,x=g.length,R=f.length;++p<x;){var S=Cc(g[p],T[p]);if(S){if(p>=R)return S;var N=f[p];return S*(N=="desc"?-1:1)}}return a.index-s.index}function Ic(a,s,f,p){for(var g=-1,T=a.length,x=f.length,R=-1,S=s.length,N=ye(T-x,0),b=M(S+N),k=!p;++R<S;)b[R]=s[R];for(;++g<x;)(k||g<T)&&(b[f[g]]=a[g]);for(;N--;)b[R++]=a[g++];return b}function Oc(a,s,f,p){for(var g=-1,T=a.length,x=-1,R=f.length,S=-1,N=s.length,b=ye(T-R,0),k=M(b+N),z=!p;++g<b;)k[g]=a[g];for(var et=g;++S<N;)k[et+S]=s[S];for(;++x<R;)(z||g<T)&&(k[et+f[x]]=a[g++]);return k}function Ye(a,s){var f=-1,p=a.length;for(s||(s=M(p));++f<p;)s[f]=a[f];return s}function Bn(a,s,f,p){var g=!f;f||(f={});for(var T=-1,x=s.length;++T<x;){var R=s[T],S=p?p(f[R],a[R],R,f,a):t;S===t&&(S=a[R]),g?rr(f,R,S):Yo(f,R,S)}return f}function zy(a,s){return Bn(a,El(a),s)}function jy(a,s){return Bn(a,Wc(a),s)}function cs(a,s){return function(f,p){var g=gt(f)?q_:py,T=s?s():{};return g(f,a,it(p,2),T)}}function to(a){return It(function(s,f){var p=-1,g=f.length,T=g>1?f[g-1]:t,x=g>2?f[2]:t;for(T=a.length>3&&typeof T=="function"?(g--,T):t,x&&ke(f[0],f[1],x)&&(T=g<3?t:T,g=1),s=Zt(s);++p<g;){var R=f[p];R&&a(s,R,p,T)}return s})}function Sc(a,s){return function(f,p){if(f==null)return f;if(!Ze(f))return a(f,p);for(var g=f.length,T=s?g:-1,x=Zt(f);(s?T--:++T<g)&&p(x[T],T,x)!==!1;);return f}}function Ac(a){return function(s,f,p){for(var g=-1,T=Zt(s),x=p(s),R=x.length;R--;){var S=x[a?R:++g];if(f(T[S],S,T)===!1)break}return s}}function Vy(a,s,f){var p=s&C,g=Ko(a);function T(){var x=this&&this!==Ie&&this instanceof T?g:a;return x.apply(p?f:this,arguments)}return T}function Pc(a){return function(s){s=Wt(s);var f=Vi(s)?On(s):t,p=f?f[0]:s.charAt(0),g=f?Dr(f,1).join(""):s.slice(1);return p[a]()+g}}function eo(a){return function(s){return ku(Sd(Od(s).replace(G_,"")),a,"")}}function Ko(a){return function(){var s=arguments;switch(s.length){case 0:return new a;case 1:return new a(s[0]);case 2:return new a(s[0],s[1]);case 3:return new a(s[0],s[1],s[2]);case 4:return new a(s[0],s[1],s[2],s[3]);case 5:return new a(s[0],s[1],s[2],s[3],s[4]);case 6:return new a(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new a(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var f=Qi(a.prototype),p=a.apply(f,s);return ee(p)?p:f}}function Ky(a,s,f){var p=Ko(a);function g(){for(var T=arguments.length,x=M(T),R=T,S=no(g);R--;)x[R]=arguments[R];var N=T<3&&x[0]!==S&&x[T-1]!==S?[]:Sr(x,S);if(T-=N.length,T<f)return Nc(a,s,ds,g.placeholder,t,x,N,t,t,f-T);var b=this&&this!==Ie&&this instanceof g?p:a;return Qe(b,this,x)}return g}function Lc(a){return function(s,f,p){var g=Zt(s);if(!Ze(s)){var T=it(f,3);s=we(s),f=function(R){return T(g[R],R,g)}}var x=a(s,f,p);return x>-1?g[T?s[x]:x]:t}}function Mc(a){return or(function(s){var f=s.length,p=f,g=pn.prototype.thru;for(a&&s.reverse();p--;){var T=s[p];if(typeof T!="function")throw new dn(u);if(g&&!x&&gs(T)=="wrapper")var x=new pn([],!0)}for(p=x?p:f;++p<f;){T=s[p];var R=gs(T),S=R=="wrapper"?yl(T):t;S&&xl(S[0])&&S[1]==(G|A|F|X)&&!S[4].length&&S[9]==1?x=x[gs(S[0])].apply(x,S[3]):x=T.length==1&&xl(T)?x[R]():x.thru(T)}return function(){var N=arguments,b=N[0];if(x&&N.length==1&&gt(b))return x.plant(b).value();for(var k=0,z=f?s[k].apply(this,N):b;++k<f;)z=s[k].call(this,z);return z}})}function ds(a,s,f,p,g,T,x,R,S,N){var b=s&G,k=s&C,z=s&P,et=s&(A|L),at=s&B,wt=z?t:Ko(a);function st(){for(var At=arguments.length,Dt=M(At),rn=At;rn--;)Dt[rn]=arguments[rn];if(et)var Ue=no(st),on=ag(Dt,Ue);if(p&&(Dt=Ic(Dt,p,g,et)),T&&(Dt=Oc(Dt,T,x,et)),At-=on,et&&At<N){var he=Sr(Dt,Ue);return Nc(a,s,ds,st.placeholder,f,Dt,he,R,S,N-At)}var Pn=k?f:this,lr=z?Pn[a]:a;return At=Dt.length,R?Dt=pm(Dt,R):at&&At>1&&Dt.reverse(),b&&S<At&&(Dt.length=S),this&&this!==Ie&&this instanceof st&&(lr=wt||Ko(lr)),lr.apply(Pn,Dt)}return st}function Dc(a,s){return function(f,p){return xy(f,a,s(p),{})}}function ps(a,s){return function(f,p){var g;if(f===t&&p===t)return s;if(f!==t&&(g=f),p!==t){if(g===t)return p;typeof f=="string"||typeof p=="string"?(f=en(f),p=en(p)):(f=yc(f),p=yc(p)),g=a(f,p)}return g}}function pl(a){return or(function(s){return s=Qt(s,tn(it())),It(function(f){var p=this;return a(s,function(g){return Qe(g,p,f)})})})}function vs(a,s){s=s===t?" ":en(s);var f=s.length;if(f<2)return f?sl(s,a):s;var p=sl(s,es(a/Ki(s)));return Vi(s)?Dr(On(p),0,a).join(""):p.slice(0,a)}function Hy(a,s,f,p){var g=s&C,T=Ko(a);function x(){for(var R=-1,S=arguments.length,N=-1,b=p.length,k=M(b+S),z=this&&this!==Ie&&this instanceof x?T:a;++N<b;)k[N]=p[N];for(;S--;)k[N++]=arguments[++R];return Qe(z,g?f:this,k)}return x}function Fc(a){return function(s,f,p){return p&&typeof p!="number"&&ke(s,f,p)&&(f=p=t),s=ur(s),f===t?(f=s,s=0):f=ur(f),p=p===t?s<f?1:-1:ur(p),Fy(s,f,p,a)}}function _s(a){return function(s,f){return typeof s=="string"&&typeof f=="string"||(s=yn(s),f=yn(f)),a(s,f)}}function Nc(a,s,f,p,g,T,x,R,S,N){var b=s&A,k=b?x:t,z=b?t:x,et=b?T:t,at=b?t:T;s|=b?F:U,s&=~(b?U:F),s&I||(s&=~(C|P));var wt=[a,s,g,et,k,at,z,R,S,N],st=f.apply(t,wt);return xl(a)&&Vc(st,wt),st.placeholder=p,Kc(st,a,s)}function vl(a){var s=ge[a];return function(f,p){if(f=yn(f),p=p==null?0:Pe(Tt(p),292),p&&Kf(f)){var g=(Wt(f)+"e").split("e"),T=s(g[0]+"e"+(+g[1]+p));return g=(Wt(T)+"e").split("e"),+(g[0]+"e"+(+g[1]-p))}return s(f)}}var $y=qi&&1/za(new qi([,-0]))[1]==K?function(a){return new qi(a)}:Gl;function bc(a){return function(s){var f=Le(s);return f==Jt?zu(s):f==ce?dg(s):og(s,a(s))}}function ir(a,s,f,p,g,T,x,R){var S=s&P;if(!S&&typeof a!="function")throw new dn(u);var N=p?p.length:0;if(N||(s&=~(F|U),p=g=t),x=x===t?x:ye(Tt(x),0),R=R===t?R:Tt(R),N-=g?g.length:0,s&U){var b=p,k=g;p=g=t}var z=S?t:yl(a),et=[a,s,f,p,g,b,k,T,x,R];if(z&&fm(et,z),a=et[0],s=et[1],f=et[2],p=et[3],g=et[4],R=et[9]=et[9]===t?S?0:a.length:ye(et[9]-N,0),!R&&s&(A|L)&&(s&=~(A|L)),!s||s==C)var at=Vy(a,s,f);else s==A||s==L?at=Ky(a,s,R):(s==F||s==(C|F))&&!g.length?at=Hy(a,s,f,p):at=ds.apply(t,et);var wt=z?_c:Vc;return Kc(wt(at,et),a,s)}function Gc(a,s,f,p){return a===t||An(a,$i[f])&&!Xt.call(p,f)?s:a}function kc(a,s,f,p,g,T){return ee(a)&&ee(s)&&(T.set(s,a),ls(a,s,t,kc,T),T.delete(s)),a}function qy(a){return qo(a)?t:a}function Uc(a,s,f,p,g,T){var x=f&m,R=a.length,S=s.length;if(R!=S&&!(x&&S>R))return!1;var N=T.get(a),b=T.get(s);if(N&&b)return N==s&&b==a;var k=-1,z=!0,et=f&w?new hi:t;for(T.set(a,s),T.set(s,a);++k<R;){var at=a[k],wt=s[k];if(p)var st=x?p(wt,at,k,s,a,T):p(at,wt,k,a,s,T);if(st!==t){if(st)continue;z=!1;break}if(et){if(!Uu(s,function(At,Dt){if(!Go(et,Dt)&&(at===At||g(at,At,f,p,T)))return et.push(Dt)})){z=!1;break}}else if(!(at===wt||g(at,wt,f,p,T))){z=!1;break}}return T.delete(a),T.delete(s),z}function Jy(a,s,f,p,g,T,x){switch(f){case Se:if(a.byteLength!=s.byteLength||a.byteOffset!=s.byteOffset)return!1;a=a.buffer,s=s.buffer;case Rn:return!(a.byteLength!=s.byteLength||!T(new qa(a),new qa(s)));case xt:case St:case Ne:return An(+a,+s);case Ee:return a.name==s.name&&a.message==s.message;case be:case hn:return a==s+"";case Jt:var R=zu;case ce:var S=p&m;if(R||(R=za),a.size!=s.size&&!S)return!1;var N=x.get(a);if(N)return N==s;p|=w,x.set(a,s);var b=Uc(R(a),R(s),p,g,T,x);return x.delete(a),b;case Je:if(Bo)return Bo.call(a)==Bo.call(s)}return!1}function Qy(a,s,f,p,g,T){var x=f&m,R=_l(a),S=R.length,N=_l(s),b=N.length;if(S!=b&&!x)return!1;for(var k=S;k--;){var z=R[k];if(!(x?z in s:Xt.call(s,z)))return!1}var et=T.get(a),at=T.get(s);if(et&&at)return et==s&&at==a;var wt=!0;T.set(a,s),T.set(s,a);for(var st=x;++k<S;){z=R[k];var At=a[z],Dt=s[z];if(p)var rn=x?p(Dt,At,z,s,a,T):p(At,Dt,z,a,s,T);if(!(rn===t?At===Dt||g(At,Dt,f,p,T):rn)){wt=!1;break}st||(st=z=="constructor")}if(wt&&!st){var Ue=a.constructor,on=s.constructor;Ue!=on&&"constructor"in a&&"constructor"in s&&!(typeof Ue=="function"&&Ue instanceof Ue&&typeof on=="function"&&on instanceof on)&&(wt=!1)}return T.delete(a),T.delete(s),wt}function or(a){return Rl(zc(a,t,td),a+"")}function _l(a){return oc(a,we,El)}function gl(a){return oc(a,ze,Wc)}var yl=rs?function(a){return rs.get(a)}:Gl;function gs(a){for(var s=a.name+"",f=Ji[s],p=Xt.call(Ji,s)?f.length:0;p--;){var g=f[p],T=g.func;if(T==null||T==a)return g.name}return s}function no(a){var s=Xt.call(E,"placeholder")?E:a;return s.placeholder}function it(){var a=E.iteratee||Nl;return a=a===Nl?uc:a,arguments.length?a(arguments[0],arguments[1]):a}function ys(a,s){var f=a.__data__;return sm(s)?f[typeof s=="string"?"string":"hash"]:f.map}function ml(a){for(var s=we(a),f=s.length;f--;){var p=s[f],g=a[p];s[f]=[p,g,Yc(g)]}return s}function di(a,s){var f=hg(a,s);return sc(f)?f:t}function tm(a){var s=Xt.call(a,ui),f=a[ui];try{a[ui]=t;var p=!0}catch{}var g=Ha.call(a);return p&&(s?a[ui]=f:delete a[ui]),g}var El=Vu?function(a){return a==null?[]:(a=Zt(a),Ir(Vu(a),function(s){return jf.call(a,s)}))}:kl,Wc=Vu?function(a){for(var s=[];a;)Or(s,El(a)),a=Ja(a);return s}:kl,Le=Ge;(Ku&&Le(new Ku(new ArrayBuffer(1)))!=Se||Uo&&Le(new Uo)!=Jt||Hu&&Le(Hu.resolve())!=wn||qi&&Le(new qi)!=ce||Wo&&Le(new Wo)!=Qn)&&(Le=function(a){var s=Ge(a),f=s==Te?a.constructor:t,p=f?pi(f):"";if(p)switch(p){case bg:return Se;case Gg:return Jt;case kg:return wn;case Ug:return ce;case Wg:return Qn}return s});function em(a,s,f){for(var p=-1,g=f.length;++p<g;){var T=f[p],x=T.size;switch(T.type){case"drop":a+=x;break;case"dropRight":s-=x;break;case"take":s=Pe(s,a+x);break;case"takeRight":a=ye(a,s-x);break}}return{start:a,end:s}}function nm(a){var s=a.match(Wn);return s?s[1].split(Yi):[]}function Xc(a,s,f){s=Mr(s,a);for(var p=-1,g=s.length,T=!1;++p<g;){var x=Yn(s[p]);if(!(T=a!=null&&f(a,x)))break;a=a[x]}return T||++p!=g?T:(g=a==null?0:a.length,!!g&&Cs(g)&&ar(x,g)&&(gt(a)||vi(a)))}function rm(a){var s=a.length,f=new a.constructor(s);return s&&typeof a[0]=="string"&&Xt.call(a,"index")&&(f.index=a.index,f.input=a.input),f}function Bc(a){return typeof a.constructor=="function"&&!Ho(a)?Qi(Ja(a)):{}}function im(a,s,f){var p=a.constructor;switch(s){case Rn:return dl(a);case xt:case St:return new p(+a);case Se:return Xy(a,f);case Xe:case Cn:case tr:case xe:case Rr:case ue:case Un:case In:case Xi:return Rc(a,f);case Jt:return new p;case Ne:case hn:return new p(a);case be:return By(a);case ce:return new p;case Je:return Yy(a)}}function om(a,s){var f=s.length;if(!f)return a;var p=f-1;return s[p]=(f>1?"& ":"")+s[p],s=s.join(f>2?", ":" "),a.replace(ai,`{
/* [wrapped with `+s+`] */
`)}function am(a){return gt(a)||vi(a)||!!(Vf&&a&&a[Vf])}function ar(a,s){var f=typeof a;return s=s==null?nt:s,!!s&&(f=="number"||f!="symbol"&&y_.test(a))&&a>-1&&a%1==0&&a<s}function ke(a,s,f){if(!ee(f))return!1;var p=typeof s;return(p=="number"?Ze(f)&&ar(s,f.length):p=="string"&&s in f)?An(f[s],a):!1}function Tl(a,s){if(gt(a))return!1;var f=typeof a;return f=="number"||f=="symbol"||f=="boolean"||a==null||nn(a)?!0:ii.test(a)||!ri.test(a)||s!=null&&a in Zt(s)}function sm(a){var s=typeof a;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?a!=="__proto__":a===null}function xl(a){var s=gs(a),f=E[s];if(typeof f!="function"||!(s in Lt.prototype))return!1;if(a===f)return!0;var p=yl(f);return!!p&&a===p[0]}function um(a){return!!Yf&&Yf in a}var lm=Va?sr:Ul;function Ho(a){var s=a&&a.constructor,f=typeof s=="function"&&s.prototype||$i;return a===f}function Yc(a){return a===a&&!ee(a)}function Zc(a,s){return function(f){return f==null?!1:f[a]===s&&(s!==t||a in Zt(f))}}function hm(a){var s=ws(a,function(p){return f.size===c&&f.clear(),p}),f=s.cache;return s}function fm(a,s){var f=a[1],p=s[1],g=f|p,T=g<(C|P|G),x=p==G&&f==A||p==G&&f==X&&a[7].length<=s[8]||p==(G|X)&&s[7].length<=s[8]&&f==A;if(!(T||x))return a;p&C&&(a[2]=s[2],g|=f&C?0:I);var R=s[3];if(R){var S=a[3];a[3]=S?Ic(S,R,s[4]):R,a[4]=S?Sr(a[3],d):s[4]}return R=s[5],R&&(S=a[5],a[5]=S?Oc(S,R,s[6]):R,a[6]=S?Sr(a[5],d):s[6]),R=s[7],R&&(a[7]=R),p&G&&(a[8]=a[8]==null?s[8]:Pe(a[8],s[8])),a[9]==null&&(a[9]=s[9]),a[0]=s[0],a[1]=g,a}function cm(a){var s=[];if(a!=null)for(var f in Zt(a))s.push(f);return s}function dm(a){return Ha.call(a)}function zc(a,s,f){return s=ye(s===t?a.length-1:s,0),function(){for(var p=arguments,g=-1,T=ye(p.length-s,0),x=M(T);++g<T;)x[g]=p[s+g];g=-1;for(var R=M(s+1);++g<s;)R[g]=p[g];return R[s]=f(x),Qe(a,this,R)}}function jc(a,s){return s.length<2?a:ci(a,_n(s,0,-1))}function pm(a,s){for(var f=a.length,p=Pe(s.length,f),g=Ye(a);p--;){var T=s[p];a[p]=ar(T,f)?g[T]:t}return a}function wl(a,s){if(!(s==="constructor"&&typeof a[s]=="function")&&s!="__proto__")return a[s]}var Vc=Hc(_c),$o=Ag||function(a,s){return Ie.setTimeout(a,s)},Rl=Hc(Gy);function Kc(a,s,f){var p=s+"";return Rl(a,om(p,vm(nm(p),f)))}function Hc(a){var s=0,f=0;return function(){var p=Dg(),g=tt-(p-f);if(f=p,g>0){if(++s>=V)return arguments[0]}else s=0;return a.apply(t,arguments)}}function ms(a,s){var f=-1,p=a.length,g=p-1;for(s=s===t?p:s;++f<s;){var T=al(f,g),x=a[T];a[T]=a[f],a[f]=x}return a.length=s,a}var $c=hm(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(Ga,function(f,p,g,T){s.push(g?T.replace(Be,"$1"):p||f)}),s});function Yn(a){if(typeof a=="string"||nn(a))return a;var s=a+"";return s=="0"&&1/a==-K?"-0":s}function pi(a){if(a!=null){try{return Ka.call(a)}catch{}try{return a+""}catch{}}return""}function vm(a,s){return cn(lt,function(f){var p="_."+f[0];s&f[1]&&!Ya(a,p)&&a.push(p)}),a.sort()}function qc(a){if(a instanceof Lt)return a.clone();var s=new pn(a.__wrapped__,a.__chain__);return s.__actions__=Ye(a.__actions__),s.__index__=a.__index__,s.__values__=a.__values__,s}function _m(a,s,f){(f?ke(a,s,f):s===t)?s=1:s=ye(Tt(s),0);var p=a==null?0:a.length;if(!p||s<1)return[];for(var g=0,T=0,x=M(es(p/s));g<p;)x[T++]=_n(a,g,g+=s);return x}function gm(a){for(var s=-1,f=a==null?0:a.length,p=0,g=[];++s<f;){var T=a[s];T&&(g[p++]=T)}return g}function ym(){var a=arguments.length;if(!a)return[];for(var s=M(a-1),f=arguments[0],p=a;p--;)s[p-1]=arguments[p];return Or(gt(f)?Ye(f):[f],Oe(s,1))}var mm=It(function(a,s){return le(a)?Zo(a,Oe(s,1,le,!0)):[]}),Em=It(function(a,s){var f=gn(s);return le(f)&&(f=t),le(a)?Zo(a,Oe(s,1,le,!0),it(f,2)):[]}),Tm=It(function(a,s){var f=gn(s);return le(f)&&(f=t),le(a)?Zo(a,Oe(s,1,le,!0),t,f):[]});function xm(a,s,f){var p=a==null?0:a.length;return p?(s=f||s===t?1:Tt(s),_n(a,s<0?0:s,p)):[]}function wm(a,s,f){var p=a==null?0:a.length;return p?(s=f||s===t?1:Tt(s),s=p-s,_n(a,0,s<0?0:s)):[]}function Rm(a,s){return a&&a.length?fs(a,it(s,3),!0,!0):[]}function Cm(a,s){return a&&a.length?fs(a,it(s,3),!0):[]}function Im(a,s,f,p){var g=a==null?0:a.length;return g?(f&&typeof f!="number"&&ke(a,s,f)&&(f=0,p=g),yy(a,s,f,p)):[]}function Jc(a,s,f){var p=a==null?0:a.length;if(!p)return-1;var g=f==null?0:Tt(f);return g<0&&(g=ye(p+g,0)),Za(a,it(s,3),g)}function Qc(a,s,f){var p=a==null?0:a.length;if(!p)return-1;var g=p-1;return f!==t&&(g=Tt(f),g=f<0?ye(p+g,0):Pe(g,p-1)),Za(a,it(s,3),g,!0)}function td(a){var s=a==null?0:a.length;return s?Oe(a,1):[]}function Om(a){var s=a==null?0:a.length;return s?Oe(a,K):[]}function Sm(a,s){var f=a==null?0:a.length;return f?(s=s===t?1:Tt(s),Oe(a,s)):[]}function Am(a){for(var s=-1,f=a==null?0:a.length,p={};++s<f;){var g=a[s];p[g[0]]=g[1]}return p}function ed(a){return a&&a.length?a[0]:t}function Pm(a,s,f){var p=a==null?0:a.length;if(!p)return-1;var g=f==null?0:Tt(f);return g<0&&(g=ye(p+g,0)),ji(a,s,g)}function Lm(a){var s=a==null?0:a.length;return s?_n(a,0,-1):[]}var Mm=It(function(a){var s=Qt(a,fl);return s.length&&s[0]===a[0]?el(s):[]}),Dm=It(function(a){var s=gn(a),f=Qt(a,fl);return s===gn(f)?s=t:f.pop(),f.length&&f[0]===a[0]?el(f,it(s,2)):[]}),Fm=It(function(a){var s=gn(a),f=Qt(a,fl);return s=typeof s=="function"?s:t,s&&f.pop(),f.length&&f[0]===a[0]?el(f,t,s):[]});function Nm(a,s){return a==null?"":Lg.call(a,s)}function gn(a){var s=a==null?0:a.length;return s?a[s-1]:t}function bm(a,s,f){var p=a==null?0:a.length;if(!p)return-1;var g=p;return f!==t&&(g=Tt(f),g=g<0?ye(p+g,0):Pe(g,p-1)),s===s?vg(a,s,g):Za(a,Nf,g,!0)}function Gm(a,s){return a&&a.length?cc(a,Tt(s)):t}var km=It(nd);function nd(a,s){return a&&a.length&&s&&s.length?ol(a,s):a}function Um(a,s,f){return a&&a.length&&s&&s.length?ol(a,s,it(f,2)):a}function Wm(a,s,f){return a&&a.length&&s&&s.length?ol(a,s,t,f):a}var Xm=or(function(a,s){var f=a==null?0:a.length,p=qu(a,s);return vc(a,Qt(s,function(g){return ar(g,f)?+g:g}).sort(Cc)),p});function Bm(a,s){var f=[];if(!(a&&a.length))return f;var p=-1,g=[],T=a.length;for(s=it(s,3);++p<T;){var x=a[p];s(x,p,a)&&(f.push(x),g.push(p))}return vc(a,g),f}function Cl(a){return a==null?a:Ng.call(a)}function Ym(a,s,f){var p=a==null?0:a.length;return p?(f&&typeof f!="number"&&ke(a,s,f)?(s=0,f=p):(s=s==null?0:Tt(s),f=f===t?p:Tt(f)),_n(a,s,f)):[]}function Zm(a,s){return hs(a,s)}function zm(a,s,f){return ul(a,s,it(f,2))}function jm(a,s){var f=a==null?0:a.length;if(f){var p=hs(a,s);if(p<f&&An(a[p],s))return p}return-1}function Vm(a,s){return hs(a,s,!0)}function Km(a,s,f){return ul(a,s,it(f,2),!0)}function Hm(a,s){var f=a==null?0:a.length;if(f){var p=hs(a,s,!0)-1;if(An(a[p],s))return p}return-1}function $m(a){return a&&a.length?gc(a):[]}function qm(a,s){return a&&a.length?gc(a,it(s,2)):[]}function Jm(a){var s=a==null?0:a.length;return s?_n(a,1,s):[]}function Qm(a,s,f){return a&&a.length?(s=f||s===t?1:Tt(s),_n(a,0,s<0?0:s)):[]}function t0(a,s,f){var p=a==null?0:a.length;return p?(s=f||s===t?1:Tt(s),s=p-s,_n(a,s<0?0:s,p)):[]}function e0(a,s){return a&&a.length?fs(a,it(s,3),!1,!0):[]}function n0(a,s){return a&&a.length?fs(a,it(s,3)):[]}var r0=It(function(a){return Lr(Oe(a,1,le,!0))}),i0=It(function(a){var s=gn(a);return le(s)&&(s=t),Lr(Oe(a,1,le,!0),it(s,2))}),o0=It(function(a){var s=gn(a);return s=typeof s=="function"?s:t,Lr(Oe(a,1,le,!0),t,s)});function a0(a){return a&&a.length?Lr(a):[]}function s0(a,s){return a&&a.length?Lr(a,it(s,2)):[]}function u0(a,s){return s=typeof s=="function"?s:t,a&&a.length?Lr(a,t,s):[]}function Il(a){if(!(a&&a.length))return[];var s=0;return a=Ir(a,function(f){if(le(f))return s=ye(f.length,s),!0}),Yu(s,function(f){return Qt(a,Wu(f))})}function rd(a,s){if(!(a&&a.length))return[];var f=Il(a);return s==null?f:Qt(f,function(p){return Qe(s,t,p)})}var l0=It(function(a,s){return le(a)?Zo(a,s):[]}),h0=It(function(a){return hl(Ir(a,le))}),f0=It(function(a){var s=gn(a);return le(s)&&(s=t),hl(Ir(a,le),it(s,2))}),c0=It(function(a){var s=gn(a);return s=typeof s=="function"?s:t,hl(Ir(a,le),t,s)}),d0=It(Il);function p0(a,s){return Tc(a||[],s||[],Yo)}function v0(a,s){return Tc(a||[],s||[],Vo)}var _0=It(function(a){var s=a.length,f=s>1?a[s-1]:t;return f=typeof f=="function"?(a.pop(),f):t,rd(a,f)});function id(a){var s=E(a);return s.__chain__=!0,s}function g0(a,s){return s(a),a}function Es(a,s){return s(a)}var y0=or(function(a){var s=a.length,f=s?a[0]:0,p=this.__wrapped__,g=function(T){return qu(T,a)};return s>1||this.__actions__.length||!(p instanceof Lt)||!ar(f)?this.thru(g):(p=p.slice(f,+f+(s?1:0)),p.__actions__.push({func:Es,args:[g],thisArg:t}),new pn(p,this.__chain__).thru(function(T){return s&&!T.length&&T.push(t),T}))});function m0(){return id(this)}function E0(){return new pn(this.value(),this.__chain__)}function T0(){this.__values__===t&&(this.__values__=yd(this.value()));var a=this.__index__>=this.__values__.length,s=a?t:this.__values__[this.__index__++];return{done:a,value:s}}function x0(){return this}function w0(a){for(var s,f=this;f instanceof os;){var p=qc(f);p.__index__=0,p.__values__=t,s?g.__wrapped__=p:s=p;var g=p;f=f.__wrapped__}return g.__wrapped__=a,s}function R0(){var a=this.__wrapped__;if(a instanceof Lt){var s=a;return this.__actions__.length&&(s=new Lt(this)),s=s.reverse(),s.__actions__.push({func:Es,args:[Cl],thisArg:t}),new pn(s,this.__chain__)}return this.thru(Cl)}function C0(){return Ec(this.__wrapped__,this.__actions__)}var I0=cs(function(a,s,f){Xt.call(a,f)?++a[f]:rr(a,f,1)});function O0(a,s,f){var p=gt(a)?Df:gy;return f&&ke(a,s,f)&&(s=t),p(a,it(s,3))}function S0(a,s){var f=gt(a)?Ir:rc;return f(a,it(s,3))}var A0=Lc(Jc),P0=Lc(Qc);function L0(a,s){return Oe(Ts(a,s),1)}function M0(a,s){return Oe(Ts(a,s),K)}function D0(a,s,f){return f=f===t?1:Tt(f),Oe(Ts(a,s),f)}function od(a,s){var f=gt(a)?cn:Pr;return f(a,it(s,3))}function ad(a,s){var f=gt(a)?J_:nc;return f(a,it(s,3))}var F0=cs(function(a,s,f){Xt.call(a,f)?a[f].push(s):rr(a,f,[s])});function N0(a,s,f,p){a=Ze(a)?a:io(a),f=f&&!p?Tt(f):0;var g=a.length;return f<0&&(f=ye(g+f,0)),Is(a)?f<=g&&a.indexOf(s,f)>-1:!!g&&ji(a,s,f)>-1}var b0=It(function(a,s,f){var p=-1,g=typeof s=="function",T=Ze(a)?M(a.length):[];return Pr(a,function(x){T[++p]=g?Qe(s,x,f):zo(x,s,f)}),T}),G0=cs(function(a,s,f){rr(a,f,s)});function Ts(a,s){var f=gt(a)?Qt:lc;return f(a,it(s,3))}function k0(a,s,f,p){return a==null?[]:(gt(s)||(s=s==null?[]:[s]),f=p?t:f,gt(f)||(f=f==null?[]:[f]),dc(a,s,f))}var U0=cs(function(a,s,f){a[f?0:1].push(s)},function(){return[[],[]]});function W0(a,s,f){var p=gt(a)?ku:Gf,g=arguments.length<3;return p(a,it(s,4),f,g,Pr)}function X0(a,s,f){var p=gt(a)?Q_:Gf,g=arguments.length<3;return p(a,it(s,4),f,g,nc)}function B0(a,s){var f=gt(a)?Ir:rc;return f(a,Rs(it(s,3)))}function Y0(a){var s=gt(a)?Jf:Ny;return s(a)}function Z0(a,s,f){(f?ke(a,s,f):s===t)?s=1:s=Tt(s);var p=gt(a)?cy:by;return p(a,s)}function z0(a){var s=gt(a)?dy:ky;return s(a)}function j0(a){if(a==null)return 0;if(Ze(a))return Is(a)?Ki(a):a.length;var s=Le(a);return s==Jt||s==ce?a.size:rl(a).length}function V0(a,s,f){var p=gt(a)?Uu:Uy;return f&&ke(a,s,f)&&(s=t),p(a,it(s,3))}var K0=It(function(a,s){if(a==null)return[];var f=s.length;return f>1&&ke(a,s[0],s[1])?s=[]:f>2&&ke(s[0],s[1],s[2])&&(s=[s[0]]),dc(a,Oe(s,1),[])}),xs=Sg||function(){return Ie.Date.now()};function H0(a,s){if(typeof s!="function")throw new dn(u);return a=Tt(a),function(){if(--a<1)return s.apply(this,arguments)}}function sd(a,s,f){return s=f?t:s,s=a&&s==null?a.length:s,ir(a,G,t,t,t,t,s)}function ud(a,s){var f;if(typeof s!="function")throw new dn(u);return a=Tt(a),function(){return--a>0&&(f=s.apply(this,arguments)),a<=1&&(s=t),f}}var Ol=It(function(a,s,f){var p=C;if(f.length){var g=Sr(f,no(Ol));p|=F}return ir(a,p,s,f,g)}),ld=It(function(a,s,f){var p=C|P;if(f.length){var g=Sr(f,no(ld));p|=F}return ir(s,p,a,f,g)});function hd(a,s,f){s=f?t:s;var p=ir(a,A,t,t,t,t,t,s);return p.placeholder=hd.placeholder,p}function fd(a,s,f){s=f?t:s;var p=ir(a,L,t,t,t,t,t,s);return p.placeholder=fd.placeholder,p}function cd(a,s,f){var p,g,T,x,R,S,N=0,b=!1,k=!1,z=!0;if(typeof a!="function")throw new dn(u);s=yn(s)||0,ee(f)&&(b=!!f.leading,k="maxWait"in f,T=k?ye(yn(f.maxWait)||0,s):T,z="trailing"in f?!!f.trailing:z);function et(he){var Pn=p,lr=g;return p=g=t,N=he,x=a.apply(lr,Pn),x}function at(he){return N=he,R=$o(At,s),b?et(he):x}function wt(he){var Pn=he-S,lr=he-N,Ld=s-Pn;return k?Pe(Ld,T-lr):Ld}function st(he){var Pn=he-S,lr=he-N;return S===t||Pn>=s||Pn<0||k&&lr>=T}function At(){var he=xs();if(st(he))return Dt(he);R=$o(At,wt(he))}function Dt(he){return R=t,z&&p?et(he):(p=g=t,x)}function rn(){R!==t&&xc(R),N=0,p=S=g=R=t}function Ue(){return R===t?x:Dt(xs())}function on(){var he=xs(),Pn=st(he);if(p=arguments,g=this,S=he,Pn){if(R===t)return at(S);if(k)return xc(R),R=$o(At,s),et(S)}return R===t&&(R=$o(At,s)),x}return on.cancel=rn,on.flush=Ue,on}var $0=It(function(a,s){return ec(a,1,s)}),q0=It(function(a,s,f){return ec(a,yn(s)||0,f)});function J0(a){return ir(a,B)}function ws(a,s){if(typeof a!="function"||s!=null&&typeof s!="function")throw new dn(u);var f=function(){var p=arguments,g=s?s.apply(this,p):p[0],T=f.cache;if(T.has(g))return T.get(g);var x=a.apply(this,p);return f.cache=T.set(g,x)||T,x};return f.cache=new(ws.Cache||nr),f}ws.Cache=nr;function Rs(a){if(typeof a!="function")throw new dn(u);return function(){var s=arguments;switch(s.length){case 0:return!a.call(this);case 1:return!a.call(this,s[0]);case 2:return!a.call(this,s[0],s[1]);case 3:return!a.call(this,s[0],s[1],s[2])}return!a.apply(this,s)}}function Q0(a){return ud(2,a)}var tE=Wy(function(a,s){s=s.length==1&&gt(s[0])?Qt(s[0],tn(it())):Qt(Oe(s,1),tn(it()));var f=s.length;return It(function(p){for(var g=-1,T=Pe(p.length,f);++g<T;)p[g]=s[g].call(this,p[g]);return Qe(a,this,p)})}),Sl=It(function(a,s){var f=Sr(s,no(Sl));return ir(a,F,t,s,f)}),dd=It(function(a,s){var f=Sr(s,no(dd));return ir(a,U,t,s,f)}),eE=or(function(a,s){return ir(a,X,t,t,t,s)});function nE(a,s){if(typeof a!="function")throw new dn(u);return s=s===t?s:Tt(s),It(a,s)}function rE(a,s){if(typeof a!="function")throw new dn(u);return s=s==null?0:ye(Tt(s),0),It(function(f){var p=f[s],g=Dr(f,0,s);return p&&Or(g,p),Qe(a,this,g)})}function iE(a,s,f){var p=!0,g=!0;if(typeof a!="function")throw new dn(u);return ee(f)&&(p="leading"in f?!!f.leading:p,g="trailing"in f?!!f.trailing:g),cd(a,s,{leading:p,maxWait:s,trailing:g})}function oE(a){return sd(a,1)}function aE(a,s){return Sl(cl(s),a)}function sE(){if(!arguments.length)return[];var a=arguments[0];return gt(a)?a:[a]}function uE(a){return vn(a,y)}function lE(a,s){return s=typeof s=="function"?s:t,vn(a,y,s)}function hE(a){return vn(a,_|y)}function fE(a,s){return s=typeof s=="function"?s:t,vn(a,_|y,s)}function cE(a,s){return s==null||tc(a,s,we(s))}function An(a,s){return a===s||a!==a&&s!==s}var dE=_s(tl),pE=_s(function(a,s){return a>=s}),vi=ac(function(){return arguments}())?ac:function(a){return ie(a)&&Xt.call(a,"callee")&&!jf.call(a,"callee")},gt=M.isArray,vE=Of?tn(Of):wy;function Ze(a){return a!=null&&Cs(a.length)&&!sr(a)}function le(a){return ie(a)&&Ze(a)}function _E(a){return a===!0||a===!1||ie(a)&&Ge(a)==xt}var Fr=Pg||Ul,gE=Sf?tn(Sf):Ry;function yE(a){return ie(a)&&a.nodeType===1&&!qo(a)}function mE(a){if(a==null)return!0;if(Ze(a)&&(gt(a)||typeof a=="string"||typeof a.splice=="function"||Fr(a)||ro(a)||vi(a)))return!a.length;var s=Le(a);if(s==Jt||s==ce)return!a.size;if(Ho(a))return!rl(a).length;for(var f in a)if(Xt.call(a,f))return!1;return!0}function EE(a,s){return jo(a,s)}function TE(a,s,f){f=typeof f=="function"?f:t;var p=f?f(a,s):t;return p===t?jo(a,s,t,f):!!p}function Al(a){if(!ie(a))return!1;var s=Ge(a);return s==Ee||s==$e||typeof a.message=="string"&&typeof a.name=="string"&&!qo(a)}function xE(a){return typeof a=="number"&&Kf(a)}function sr(a){if(!ee(a))return!1;var s=Ge(a);return s==qe||s==kn||s==Ut||s==ln}function pd(a){return typeof a=="number"&&a==Tt(a)}function Cs(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=nt}function ee(a){var s=typeof a;return a!=null&&(s=="object"||s=="function")}function ie(a){return a!=null&&typeof a=="object"}var vd=Af?tn(Af):Iy;function wE(a,s){return a===s||nl(a,s,ml(s))}function RE(a,s,f){return f=typeof f=="function"?f:t,nl(a,s,ml(s),f)}function CE(a){return _d(a)&&a!=+a}function IE(a){if(lm(a))throw new vt(o);return sc(a)}function OE(a){return a===null}function SE(a){return a==null}function _d(a){return typeof a=="number"||ie(a)&&Ge(a)==Ne}function qo(a){if(!ie(a)||Ge(a)!=Te)return!1;var s=Ja(a);if(s===null)return!0;var f=Xt.call(s,"constructor")&&s.constructor;return typeof f=="function"&&f instanceof f&&Ka.call(f)==Rg}var Pl=Pf?tn(Pf):Oy;function AE(a){return pd(a)&&a>=-nt&&a<=nt}var gd=Lf?tn(Lf):Sy;function Is(a){return typeof a=="string"||!gt(a)&&ie(a)&&Ge(a)==hn}function nn(a){return typeof a=="symbol"||ie(a)&&Ge(a)==Je}var ro=Mf?tn(Mf):Ay;function PE(a){return a===t}function LE(a){return ie(a)&&Le(a)==Qn}function ME(a){return ie(a)&&Ge(a)==Wi}var DE=_s(il),FE=_s(function(a,s){return a<=s});function yd(a){if(!a)return[];if(Ze(a))return Is(a)?On(a):Ye(a);if(ko&&a[ko])return cg(a[ko]());var s=Le(a),f=s==Jt?zu:s==ce?za:io;return f(a)}function ur(a){if(!a)return a===0?a:0;if(a=yn(a),a===K||a===-K){var s=a<0?-1:1;return s*ut}return a===a?a:0}function Tt(a){var s=ur(a),f=s%1;return s===s?f?s-f:s:0}function md(a){return a?fi(Tt(a),0,pt):0}function yn(a){if(typeof a=="number")return a;if(nn(a))return mt;if(ee(a)){var s=typeof a.valueOf=="function"?a.valueOf():a;a=ee(s)?s+"":s}if(typeof a!="string")return a===0?a:+a;a=kf(a);var f=v_.test(a);return f||g_.test(a)?H_(a.slice(2),f?2:8):Ua.test(a)?mt:+a}function Ed(a){return Bn(a,ze(a))}function NE(a){return a?fi(Tt(a),-nt,nt):a===0?a:0}function Wt(a){return a==null?"":en(a)}var bE=to(function(a,s){if(Ho(s)||Ze(s)){Bn(s,we(s),a);return}for(var f in s)Xt.call(s,f)&&Yo(a,f,s[f])}),Td=to(function(a,s){Bn(s,ze(s),a)}),Os=to(function(a,s,f,p){Bn(s,ze(s),a,p)}),GE=to(function(a,s,f,p){Bn(s,we(s),a,p)}),kE=or(qu);function UE(a,s){var f=Qi(a);return s==null?f:Qf(f,s)}var WE=It(function(a,s){a=Zt(a);var f=-1,p=s.length,g=p>2?s[2]:t;for(g&&ke(s[0],s[1],g)&&(p=1);++f<p;)for(var T=s[f],x=ze(T),R=-1,S=x.length;++R<S;){var N=x[R],b=a[N];(b===t||An(b,$i[N])&&!Xt.call(a,N))&&(a[N]=T[N])}return a}),XE=It(function(a){return a.push(t,kc),Qe(xd,t,a)});function BE(a,s){return Ff(a,it(s,3),Xn)}function YE(a,s){return Ff(a,it(s,3),Qu)}function ZE(a,s){return a==null?a:Ju(a,it(s,3),ze)}function zE(a,s){return a==null?a:ic(a,it(s,3),ze)}function jE(a,s){return a&&Xn(a,it(s,3))}function VE(a,s){return a&&Qu(a,it(s,3))}function KE(a){return a==null?[]:us(a,we(a))}function HE(a){return a==null?[]:us(a,ze(a))}function Ll(a,s,f){var p=a==null?t:ci(a,s);return p===t?f:p}function $E(a,s){return a!=null&&Xc(a,s,my)}function Ml(a,s){return a!=null&&Xc(a,s,Ey)}var qE=Dc(function(a,s,f){s!=null&&typeof s.toString!="function"&&(s=Ha.call(s)),a[s]=f},Fl(je)),JE=Dc(function(a,s,f){s!=null&&typeof s.toString!="function"&&(s=Ha.call(s)),Xt.call(a,s)?a[s].push(f):a[s]=[f]},it),QE=It(zo);function we(a){return Ze(a)?qf(a):rl(a)}function ze(a){return Ze(a)?qf(a,!0):Py(a)}function tT(a,s){var f={};return s=it(s,3),Xn(a,function(p,g,T){rr(f,s(p,g,T),p)}),f}function eT(a,s){var f={};return s=it(s,3),Xn(a,function(p,g,T){rr(f,g,s(p,g,T))}),f}var nT=to(function(a,s,f){ls(a,s,f)}),xd=to(function(a,s,f,p){ls(a,s,f,p)}),rT=or(function(a,s){var f={};if(a==null)return f;var p=!1;s=Qt(s,function(T){return T=Mr(T,a),p||(p=T.length>1),T}),Bn(a,gl(a),f),p&&(f=vn(f,_|v|y,qy));for(var g=s.length;g--;)ll(f,s[g]);return f});function iT(a,s){return wd(a,Rs(it(s)))}var oT=or(function(a,s){return a==null?{}:My(a,s)});function wd(a,s){if(a==null)return{};var f=Qt(gl(a),function(p){return[p]});return s=it(s),pc(a,f,function(p,g){return s(p,g[0])})}function aT(a,s,f){s=Mr(s,a);var p=-1,g=s.length;for(g||(g=1,a=t);++p<g;){var T=a==null?t:a[Yn(s[p])];T===t&&(p=g,T=f),a=sr(T)?T.call(a):T}return a}function sT(a,s,f){return a==null?a:Vo(a,s,f)}function uT(a,s,f,p){return p=typeof p=="function"?p:t,a==null?a:Vo(a,s,f,p)}var Rd=bc(we),Cd=bc(ze);function lT(a,s,f){var p=gt(a),g=p||Fr(a)||ro(a);if(s=it(s,4),f==null){var T=a&&a.constructor;g?f=p?new T:[]:ee(a)?f=sr(T)?Qi(Ja(a)):{}:f={}}return(g?cn:Xn)(a,function(x,R,S){return s(f,x,R,S)}),f}function hT(a,s){return a==null?!0:ll(a,s)}function fT(a,s,f){return a==null?a:mc(a,s,cl(f))}function cT(a,s,f,p){return p=typeof p=="function"?p:t,a==null?a:mc(a,s,cl(f),p)}function io(a){return a==null?[]:Zu(a,we(a))}function dT(a){return a==null?[]:Zu(a,ze(a))}function pT(a,s,f){return f===t&&(f=s,s=t),f!==t&&(f=yn(f),f=f===f?f:0),s!==t&&(s=yn(s),s=s===s?s:0),fi(yn(a),s,f)}function vT(a,s,f){return s=ur(s),f===t?(f=s,s=0):f=ur(f),a=yn(a),Ty(a,s,f)}function _T(a,s,f){if(f&&typeof f!="boolean"&&ke(a,s,f)&&(s=f=t),f===t&&(typeof s=="boolean"?(f=s,s=t):typeof a=="boolean"&&(f=a,a=t)),a===t&&s===t?(a=0,s=1):(a=ur(a),s===t?(s=a,a=0):s=ur(s)),a>s){var p=a;a=s,s=p}if(f||a%1||s%1){var g=Hf();return Pe(a+g*(s-a+K_("1e-"+((g+"").length-1))),s)}return al(a,s)}var gT=eo(function(a,s,f){return s=s.toLowerCase(),a+(f?Id(s):s)});function Id(a){return Dl(Wt(a).toLowerCase())}function Od(a){return a=Wt(a),a&&a.replace(m_,sg).replace(k_,"")}function yT(a,s,f){a=Wt(a),s=en(s);var p=a.length;f=f===t?p:fi(Tt(f),0,p);var g=f;return f-=s.length,f>=0&&a.slice(f,g)==s}function mT(a){return a=Wt(a),a&&Do.test(a)?a.replace(Mo,ug):a}function ET(a){return a=Wt(a),a&&Au.test(a)?a.replace(Bi,"\\$&"):a}var TT=eo(function(a,s,f){return a+(f?"-":"")+s.toLowerCase()}),xT=eo(function(a,s,f){return a+(f?" ":"")+s.toLowerCase()}),wT=Pc("toLowerCase");function RT(a,s,f){a=Wt(a),s=Tt(s);var p=s?Ki(a):0;if(!s||p>=s)return a;var g=(s-p)/2;return vs(ns(g),f)+a+vs(es(g),f)}function CT(a,s,f){a=Wt(a),s=Tt(s);var p=s?Ki(a):0;return s&&p<s?a+vs(s-p,f):a}function IT(a,s,f){a=Wt(a),s=Tt(s);var p=s?Ki(a):0;return s&&p<s?vs(s-p,f)+a:a}function OT(a,s,f){return f||s==null?s=0:s&&(s=+s),Fg(Wt(a).replace(No,""),s||0)}function ST(a,s,f){return(f?ke(a,s,f):s===t)?s=1:s=Tt(s),sl(Wt(a),s)}function AT(){var a=arguments,s=Wt(a[0]);return a.length<3?s:s.replace(a[1],a[2])}var PT=eo(function(a,s,f){return a+(f?"_":"")+s.toLowerCase()});function LT(a,s,f){return f&&typeof f!="number"&&ke(a,s,f)&&(s=f=t),f=f===t?pt:f>>>0,f?(a=Wt(a),a&&(typeof s=="string"||s!=null&&!Pl(s))&&(s=en(s),!s&&Vi(a))?Dr(On(a),0,f):a.split(s,f)):[]}var MT=eo(function(a,s,f){return a+(f?" ":"")+Dl(s)});function DT(a,s,f){return a=Wt(a),f=f==null?0:fi(Tt(f),0,a.length),s=en(s),a.slice(f,f+s.length)==s}function FT(a,s,f){var p=E.templateSettings;f&&ke(a,s,f)&&(s=t),a=Wt(a),s=Os({},s,p,Gc);var g=Os({},s.imports,p.imports,Gc),T=we(g),x=Zu(g,T),R,S,N=0,b=s.interpolate||Wa,k="__p += '",z=ju((s.escape||Wa).source+"|"+b.source+"|"+(b===Cr?bo:Wa).source+"|"+(s.evaluate||Wa).source+"|$","g"),et="//# sourceURL="+(Xt.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Y_+"]")+`
`;a.replace(z,function(st,At,Dt,rn,Ue,on){return Dt||(Dt=rn),k+=a.slice(N,on).replace(E_,lg),At&&(R=!0,k+=`' +
__e(`+At+`) +
'`),Ue&&(S=!0,k+=`';
`+Ue+`;
__p += '`),Dt&&(k+=`' +
((__t = (`+Dt+`)) == null ? '' : __t) +
'`),N=on+st.length,st}),k+=`';
`;var at=Xt.call(s,"variable")&&s.variable;if(!at)k=`with (obj) {
`+k+`
}
`;else if(Ae.test(at))throw new vt(l);k=(S?k.replace(Da,""):k).replace(Lo,"$1").replace(Su,"$1;"),k="function("+(at||"obj")+`) {
`+(at?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(S?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+k+`return __p
}`;var wt=Ad(function(){return kt(T,et+"return "+k).apply(t,x)});if(wt.source=k,Al(wt))throw wt;return wt}function NT(a){return Wt(a).toLowerCase()}function bT(a){return Wt(a).toUpperCase()}function GT(a,s,f){if(a=Wt(a),a&&(f||s===t))return kf(a);if(!a||!(s=en(s)))return a;var p=On(a),g=On(s),T=Uf(p,g),x=Wf(p,g)+1;return Dr(p,T,x).join("")}function kT(a,s,f){if(a=Wt(a),a&&(f||s===t))return a.slice(0,Bf(a)+1);if(!a||!(s=en(s)))return a;var p=On(a),g=Wf(p,On(s))+1;return Dr(p,0,g).join("")}function UT(a,s,f){if(a=Wt(a),a&&(f||s===t))return a.replace(No,"");if(!a||!(s=en(s)))return a;var p=On(a),g=Uf(p,On(s));return Dr(p,g).join("")}function WT(a,s){var f=Z,p=j;if(ee(s)){var g="separator"in s?s.separator:g;f="length"in s?Tt(s.length):f,p="omission"in s?en(s.omission):p}a=Wt(a);var T=a.length;if(Vi(a)){var x=On(a);T=x.length}if(f>=T)return a;var R=f-Ki(p);if(R<1)return p;var S=x?Dr(x,0,R).join(""):a.slice(0,R);if(g===t)return S+p;if(x&&(R+=S.length-R),Pl(g)){if(a.slice(R).search(g)){var N,b=S;for(g.global||(g=ju(g.source,Wt(ka.exec(g))+"g")),g.lastIndex=0;N=g.exec(b);)var k=N.index;S=S.slice(0,k===t?R:k)}}else if(a.indexOf(en(g),R)!=R){var z=S.lastIndexOf(g);z>-1&&(S=S.slice(0,z))}return S+p}function XT(a){return a=Wt(a),a&&Na.test(a)?a.replace(Fa,_g):a}var BT=eo(function(a,s,f){return a+(f?" ":"")+s.toUpperCase()}),Dl=Pc("toUpperCase");function Sd(a,s,f){return a=Wt(a),s=f?t:s,s===t?fg(a)?mg(a):ng(a):a.match(s)||[]}var Ad=It(function(a,s){try{return Qe(a,t,s)}catch(f){return Al(f)?f:new vt(f)}}),YT=or(function(a,s){return cn(s,function(f){f=Yn(f),rr(a,f,Ol(a[f],a))}),a});function ZT(a){var s=a==null?0:a.length,f=it();return a=s?Qt(a,function(p){if(typeof p[1]!="function")throw new dn(u);return[f(p[0]),p[1]]}):[],It(function(p){for(var g=-1;++g<s;){var T=a[g];if(Qe(T[0],this,p))return Qe(T[1],this,p)}})}function zT(a){return _y(vn(a,_))}function Fl(a){return function(){return a}}function jT(a,s){return a==null||a!==a?s:a}var VT=Mc(),KT=Mc(!0);function je(a){return a}function Nl(a){return uc(typeof a=="function"?a:vn(a,_))}function HT(a){return hc(vn(a,_))}function $T(a,s){return fc(a,vn(s,_))}var qT=It(function(a,s){return function(f){return zo(f,a,s)}}),JT=It(function(a,s){return function(f){return zo(a,f,s)}});function bl(a,s,f){var p=we(s),g=us(s,p);f==null&&!(ee(s)&&(g.length||!p.length))&&(f=s,s=a,a=this,g=us(s,we(s)));var T=!(ee(f)&&"chain"in f)||!!f.chain,x=sr(a);return cn(g,function(R){var S=s[R];a[R]=S,x&&(a.prototype[R]=function(){var N=this.__chain__;if(T||N){var b=a(this.__wrapped__),k=b.__actions__=Ye(this.__actions__);return k.push({func:S,args:arguments,thisArg:a}),b.__chain__=N,b}return S.apply(a,Or([this.value()],arguments))})}),a}function QT(){return Ie._===this&&(Ie._=Cg),this}function Gl(){}function tx(a){return a=Tt(a),It(function(s){return cc(s,a)})}var ex=pl(Qt),nx=pl(Df),rx=pl(Uu);function Pd(a){return Tl(a)?Wu(Yn(a)):Dy(a)}function ix(a){return function(s){return a==null?t:ci(a,s)}}var ox=Fc(),ax=Fc(!0);function kl(){return[]}function Ul(){return!1}function sx(){return{}}function ux(){return""}function lx(){return!0}function hx(a,s){if(a=Tt(a),a<1||a>nt)return[];var f=pt,p=Pe(a,pt);s=it(s),a-=pt;for(var g=Yu(p,s);++f<a;)s(f);return g}function fx(a){return gt(a)?Qt(a,Yn):nn(a)?[a]:Ye($c(Wt(a)))}function cx(a){var s=++wg;return Wt(a)+s}var dx=ps(function(a,s){return a+s},0),px=vl("ceil"),vx=ps(function(a,s){return a/s},1),_x=vl("floor");function gx(a){return a&&a.length?ss(a,je,tl):t}function yx(a,s){return a&&a.length?ss(a,it(s,2),tl):t}function mx(a){return bf(a,je)}function Ex(a,s){return bf(a,it(s,2))}function Tx(a){return a&&a.length?ss(a,je,il):t}function xx(a,s){return a&&a.length?ss(a,it(s,2),il):t}var wx=ps(function(a,s){return a*s},1),Rx=vl("round"),Cx=ps(function(a,s){return a-s},0);function Ix(a){return a&&a.length?Bu(a,je):0}function Ox(a,s){return a&&a.length?Bu(a,it(s,2)):0}return E.after=H0,E.ary=sd,E.assign=bE,E.assignIn=Td,E.assignInWith=Os,E.assignWith=GE,E.at=kE,E.before=ud,E.bind=Ol,E.bindAll=YT,E.bindKey=ld,E.castArray=sE,E.chain=id,E.chunk=_m,E.compact=gm,E.concat=ym,E.cond=ZT,E.conforms=zT,E.constant=Fl,E.countBy=I0,E.create=UE,E.curry=hd,E.curryRight=fd,E.debounce=cd,E.defaults=WE,E.defaultsDeep=XE,E.defer=$0,E.delay=q0,E.difference=mm,E.differenceBy=Em,E.differenceWith=Tm,E.drop=xm,E.dropRight=wm,E.dropRightWhile=Rm,E.dropWhile=Cm,E.fill=Im,E.filter=S0,E.flatMap=L0,E.flatMapDeep=M0,E.flatMapDepth=D0,E.flatten=td,E.flattenDeep=Om,E.flattenDepth=Sm,E.flip=J0,E.flow=VT,E.flowRight=KT,E.fromPairs=Am,E.functions=KE,E.functionsIn=HE,E.groupBy=F0,E.initial=Lm,E.intersection=Mm,E.intersectionBy=Dm,E.intersectionWith=Fm,E.invert=qE,E.invertBy=JE,E.invokeMap=b0,E.iteratee=Nl,E.keyBy=G0,E.keys=we,E.keysIn=ze,E.map=Ts,E.mapKeys=tT,E.mapValues=eT,E.matches=HT,E.matchesProperty=$T,E.memoize=ws,E.merge=nT,E.mergeWith=xd,E.method=qT,E.methodOf=JT,E.mixin=bl,E.negate=Rs,E.nthArg=tx,E.omit=rT,E.omitBy=iT,E.once=Q0,E.orderBy=k0,E.over=ex,E.overArgs=tE,E.overEvery=nx,E.overSome=rx,E.partial=Sl,E.partialRight=dd,E.partition=U0,E.pick=oT,E.pickBy=wd,E.property=Pd,E.propertyOf=ix,E.pull=km,E.pullAll=nd,E.pullAllBy=Um,E.pullAllWith=Wm,E.pullAt=Xm,E.range=ox,E.rangeRight=ax,E.rearg=eE,E.reject=B0,E.remove=Bm,E.rest=nE,E.reverse=Cl,E.sampleSize=Z0,E.set=sT,E.setWith=uT,E.shuffle=z0,E.slice=Ym,E.sortBy=K0,E.sortedUniq=$m,E.sortedUniqBy=qm,E.split=LT,E.spread=rE,E.tail=Jm,E.take=Qm,E.takeRight=t0,E.takeRightWhile=e0,E.takeWhile=n0,E.tap=g0,E.throttle=iE,E.thru=Es,E.toArray=yd,E.toPairs=Rd,E.toPairsIn=Cd,E.toPath=fx,E.toPlainObject=Ed,E.transform=lT,E.unary=oE,E.union=r0,E.unionBy=i0,E.unionWith=o0,E.uniq=a0,E.uniqBy=s0,E.uniqWith=u0,E.unset=hT,E.unzip=Il,E.unzipWith=rd,E.update=fT,E.updateWith=cT,E.values=io,E.valuesIn=dT,E.without=l0,E.words=Sd,E.wrap=aE,E.xor=h0,E.xorBy=f0,E.xorWith=c0,E.zip=d0,E.zipObject=p0,E.zipObjectDeep=v0,E.zipWith=_0,E.entries=Rd,E.entriesIn=Cd,E.extend=Td,E.extendWith=Os,bl(E,E),E.add=dx,E.attempt=Ad,E.camelCase=gT,E.capitalize=Id,E.ceil=px,E.clamp=pT,E.clone=uE,E.cloneDeep=hE,E.cloneDeepWith=fE,E.cloneWith=lE,E.conformsTo=cE,E.deburr=Od,E.defaultTo=jT,E.divide=vx,E.endsWith=yT,E.eq=An,E.escape=mT,E.escapeRegExp=ET,E.every=O0,E.find=A0,E.findIndex=Jc,E.findKey=BE,E.findLast=P0,E.findLastIndex=Qc,E.findLastKey=YE,E.floor=_x,E.forEach=od,E.forEachRight=ad,E.forIn=ZE,E.forInRight=zE,E.forOwn=jE,E.forOwnRight=VE,E.get=Ll,E.gt=dE,E.gte=pE,E.has=$E,E.hasIn=Ml,E.head=ed,E.identity=je,E.includes=N0,E.indexOf=Pm,E.inRange=vT,E.invoke=QE,E.isArguments=vi,E.isArray=gt,E.isArrayBuffer=vE,E.isArrayLike=Ze,E.isArrayLikeObject=le,E.isBoolean=_E,E.isBuffer=Fr,E.isDate=gE,E.isElement=yE,E.isEmpty=mE,E.isEqual=EE,E.isEqualWith=TE,E.isError=Al,E.isFinite=xE,E.isFunction=sr,E.isInteger=pd,E.isLength=Cs,E.isMap=vd,E.isMatch=wE,E.isMatchWith=RE,E.isNaN=CE,E.isNative=IE,E.isNil=SE,E.isNull=OE,E.isNumber=_d,E.isObject=ee,E.isObjectLike=ie,E.isPlainObject=qo,E.isRegExp=Pl,E.isSafeInteger=AE,E.isSet=gd,E.isString=Is,E.isSymbol=nn,E.isTypedArray=ro,E.isUndefined=PE,E.isWeakMap=LE,E.isWeakSet=ME,E.join=Nm,E.kebabCase=TT,E.last=gn,E.lastIndexOf=bm,E.lowerCase=xT,E.lowerFirst=wT,E.lt=DE,E.lte=FE,E.max=gx,E.maxBy=yx,E.mean=mx,E.meanBy=Ex,E.min=Tx,E.minBy=xx,E.stubArray=kl,E.stubFalse=Ul,E.stubObject=sx,E.stubString=ux,E.stubTrue=lx,E.multiply=wx,E.nth=Gm,E.noConflict=QT,E.noop=Gl,E.now=xs,E.pad=RT,E.padEnd=CT,E.padStart=IT,E.parseInt=OT,E.random=_T,E.reduce=W0,E.reduceRight=X0,E.repeat=ST,E.replace=AT,E.result=aT,E.round=Rx,E.runInContext=O,E.sample=Y0,E.size=j0,E.snakeCase=PT,E.some=V0,E.sortedIndex=Zm,E.sortedIndexBy=zm,E.sortedIndexOf=jm,E.sortedLastIndex=Vm,E.sortedLastIndexBy=Km,E.sortedLastIndexOf=Hm,E.startCase=MT,E.startsWith=DT,E.subtract=Cx,E.sum=Ix,E.sumBy=Ox,E.template=FT,E.times=hx,E.toFinite=ur,E.toInteger=Tt,E.toLength=md,E.toLower=NT,E.toNumber=yn,E.toSafeInteger=NE,E.toString=Wt,E.toUpper=bT,E.trim=GT,E.trimEnd=kT,E.trimStart=UT,E.truncate=WT,E.unescape=XT,E.uniqueId=cx,E.upperCase=BT,E.upperFirst=Dl,E.each=od,E.eachRight=ad,E.first=ed,bl(E,function(){var a={};return Xn(E,function(s,f){Xt.call(E.prototype,f)||(a[f]=s)}),a}(),{chain:!1}),E.VERSION=n,cn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){E[a].placeholder=E}),cn(["drop","take"],function(a,s){Lt.prototype[a]=function(f){f=f===t?1:ye(Tt(f),0);var p=this.__filtered__&&!s?new Lt(this):this.clone();return p.__filtered__?p.__takeCount__=Pe(f,p.__takeCount__):p.__views__.push({size:Pe(f,pt),type:a+(p.__dir__<0?"Right":"")}),p},Lt.prototype[a+"Right"]=function(f){return this.reverse()[a](f).reverse()}}),cn(["filter","map","takeWhile"],function(a,s){var f=s+1,p=f==rt||f==Q;Lt.prototype[a]=function(g){var T=this.clone();return T.__iteratees__.push({iteratee:it(g,3),type:f}),T.__filtered__=T.__filtered__||p,T}}),cn(["head","last"],function(a,s){var f="take"+(s?"Right":"");Lt.prototype[a]=function(){return this[f](1).value()[0]}}),cn(["initial","tail"],function(a,s){var f="drop"+(s?"":"Right");Lt.prototype[a]=function(){return this.__filtered__?new Lt(this):this[f](1)}}),Lt.prototype.compact=function(){return this.filter(je)},Lt.prototype.find=function(a){return this.filter(a).head()},Lt.prototype.findLast=function(a){return this.reverse().find(a)},Lt.prototype.invokeMap=It(function(a,s){return typeof a=="function"?new Lt(this):this.map(function(f){return zo(f,a,s)})}),Lt.prototype.reject=function(a){return this.filter(Rs(it(a)))},Lt.prototype.slice=function(a,s){a=Tt(a);var f=this;return f.__filtered__&&(a>0||s<0)?new Lt(f):(a<0?f=f.takeRight(-a):a&&(f=f.drop(a)),s!==t&&(s=Tt(s),f=s<0?f.dropRight(-s):f.take(s-a)),f)},Lt.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},Lt.prototype.toArray=function(){return this.take(pt)},Xn(Lt.prototype,function(a,s){var f=/^(?:filter|find|map|reject)|While$/.test(s),p=/^(?:head|last)$/.test(s),g=E[p?"take"+(s=="last"?"Right":""):s],T=p||/^find/.test(s);!g||(E.prototype[s]=function(){var x=this.__wrapped__,R=p?[1]:arguments,S=x instanceof Lt,N=R[0],b=S||gt(x),k=function(At){var Dt=g.apply(E,Or([At],R));return p&&z?Dt[0]:Dt};b&&f&&typeof N=="function"&&N.length!=1&&(S=b=!1);var z=this.__chain__,et=!!this.__actions__.length,at=T&&!z,wt=S&&!et;if(!T&&b){x=wt?x:new Lt(this);var st=a.apply(x,R);return st.__actions__.push({func:Es,args:[k],thisArg:t}),new pn(st,z)}return at&&wt?a.apply(this,R):(st=this.thru(k),at?p?st.value()[0]:st.value():st)})}),cn(["pop","push","shift","sort","splice","unshift"],function(a){var s=ja[a],f=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",p=/^(?:pop|shift)$/.test(a);E.prototype[a]=function(){var g=arguments;if(p&&!this.__chain__){var T=this.value();return s.apply(gt(T)?T:[],g)}return this[f](function(x){return s.apply(gt(x)?x:[],g)})}}),Xn(Lt.prototype,function(a,s){var f=E[s];if(f){var p=f.name+"";Xt.call(Ji,p)||(Ji[p]=[]),Ji[p].push({name:s,func:f})}}),Ji[ds(t,P).name]=[{name:"wrapper",func:t}],Lt.prototype.clone=Xg,Lt.prototype.reverse=Bg,Lt.prototype.value=Yg,E.prototype.at=y0,E.prototype.chain=m0,E.prototype.commit=E0,E.prototype.next=T0,E.prototype.plant=w0,E.prototype.reverse=R0,E.prototype.toJSON=E.prototype.valueOf=E.prototype.value=C0,E.prototype.first=E.prototype.head,ko&&(E.prototype[ko]=x0),E},Hi=Eg();si?((si.exports=Hi)._=Hi,Nu._=Hi):Ie._=Hi}).call(ta)})(xh,xh.exports);var aA=`#version 300 es

precision highp float;

// TODO: use uniform block?
// uniform FrameState {
// };

uniform float[6] u_coordinateToPixelTransform;
uniform vec2 u_viewportSize;

in vec4 a_position;

// TODO: use mat2x3 instead of float[6]
vec2 apply(float[6] transform, vec4 coordinate) {
  float x = coordinate[0];
  float y = coordinate[1];

  return vec2(transform[0] * x + transform[2] * y + transform[4], transform[1] * x + transform[3] * y + transform[5]);
}

void main() {
  vec2 pixel = apply(u_coordinateToPixelTransform, a_position);
  // vec2 position = pixel / u_viewportSize * vec2(1, -1) * 2.0 - 1.0;

  float x = pixel[0] / u_viewportSize.x * 2.0 - 1.0;
  float y = -(pixel[1] / u_viewportSize.y * 2.0 - 1.0);

  gl_Position = vec4(x, y, 0.0, 1.0);
}
`,sA=`#version 300 es

precision highp float;
precision highp isampler2D;

// uniform Settings {
//   float u_opacity;
// };

uniform float u_opacity;
uniform vec3 u_backgroundColor;
uniform float u_backgroundColorThreshold;

uniform float u_x2Mean;
uniform float u_y2Mean;
uniform vec3 u_adfFromGeoX;
uniform vec3 u_adfFromGeoY;

uniform float[6] u_pixelToCoordinateTransform;
uniform vec2 u_viewportSize;
uniform float u_devicePixelRatio;

vec2 CRS_georef(float e1, float n1, vec3 E, vec3 N) {
  float e;
  float n;

  // if(order == 1) {
  e = E[0] + E[1] * e1 + E[2] * n1;
  n = N[0] + N[1] * e1 + N[2] * n1;

  return vec2(e, n);
}

vec2 GDALGCPTransform(float x2_mean, float y2_mean, vec3 adfFromGeoX, vec3 adfFromGeoY, vec2 point) {
  vec2 transformedPoint = CRS_georef(point.x - x2_mean, point.y - y2_mean, adfFromGeoX, adfFromGeoY);

  return transformedPoint;
}

uniform sampler2D u_tilesTexture;
uniform isampler2D u_tilePositionsTexture;
uniform isampler2D u_imagePositionsTexture;
uniform isampler2D u_scaleFactorsTexture;

out vec4 outColor;

vec2 apply(float[6] transform, vec2 coordinate) {
  float x = coordinate[0];
  float y = coordinate[1];
  return vec2(transform[0] * x + transform[2] * y + transform[4], transform[1] * x + transform[3] * y + transform[5]);
}

void main() {
  // gl_FragCoord contains canvas pixel values:
  // lower-left origin: substract y component from viewport height and
  // divide by u_devicePixelRatio to get HTML coordinates used by OpenLayers
  vec2 pixelCoords = vec2(gl_FragCoord.x / u_devicePixelRatio, u_viewportSize.y - gl_FragCoord.y / u_devicePixelRatio);

  vec2 geoCoords = apply(u_pixelToCoordinateTransform, pixelCoords);
  vec2 imageCoords = GDALGCPTransform(u_x2Mean, u_y2Mean, u_adfFromGeoX, u_adfFromGeoY, geoCoords.yx);

  ivec2 tilePositionsTextureSize = textureSize(u_tilePositionsTexture, 0);
  int tileCount = tilePositionsTextureSize.y;

  int imageX = int(round(imageCoords.x));
  int imageY = int(round(imageCoords.y));

  ivec2 tileTextureSize = textureSize(u_tilesTexture, 0);

  int texturePixelX = 0;
  int texturePixelY = 0;

  float diffX = 0.0;
  float diffY = 0.0;

  int scaleFactor = 0;

  bool found = false;

  for(int tileIndex = 0; tileIndex < tileCount; tileIndex += 1) {
    ivec4 imagePosition = texelFetch(u_imagePositionsTexture, ivec2(0, tileIndex), 0);

    int tileRegionX = imagePosition.r;
    int tileRegionY = imagePosition.g;
    int tileRegionWidth = imagePosition.b;
    int tileRegionHeight = imagePosition.a;

    if(imageX >= tileRegionX && imageX < tileRegionX + tileRegionWidth && imageY >= tileRegionY && imageY < tileRegionY + tileRegionHeight) {
      found = true;

      scaleFactor = texelFetch(u_scaleFactorsTexture, ivec2(0, tileIndex), 0).r;

      diffX = float(imageX - tileRegionX) / float(scaleFactor);
      diffY = float(imageY - tileRegionY) / float(scaleFactor);

      ivec2 tilePosition = texelFetch(u_tilePositionsTexture, ivec2(0, tileIndex), 0).rg;

      texturePixelX = tilePosition.r + int(round(diffX));
      texturePixelY = tilePosition.g + int(round(diffY));
    }
  }

  outColor = vec4(0.0, 0.0, 0.0, 0.0);

  if(found == true) {
    vec4 color = texture(u_tilesTexture, vec2(float(texturePixelX) / float(tileTextureSize.x), float(texturePixelY) / float(tileTextureSize.y)));
    outColor = vec4(color.rgb * u_opacity, color.a * u_opacity);

    vec3 backgroundDiff = color.rgb - u_backgroundColor.rgb;
    if (length(backgroundDiff) < u_backgroundColorThreshold) {
      // float s = 0.02;
      // float a = mix(0.0, color.a * u_opacity, max(length(backgroundDiff), s));
      // outColor = vec4(color.rgb * u_opacity, a);

      outColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
  }
}`,ne={ADDMAP:"addmap",WARPEDMAPADDED:"warpedmapadded",UPDATENEEDEDTILES:"updateneededtiles",WARPEDMAPENTEREXTENT:"warpedmapenterextent",WARPEDMAPLEAVEEXTENT:"warpedmapleaveextent",TILENEEDED:"tileneeded",TILEUNNEEDED:"tileunneeded",TILELOADED:"tileloaded",TILELOADINGERROR:"tileloadingerror",TILESCHANGED:"tileschanged"};function uA(i){let e=0,t=0;for(const l of i)e+=l.w*l.h,t=Math.max(t,l.w);i.sort((l,h)=>h.h-l.h);const n=Math.max(Math.ceil(Math.sqrt(e/.95)),t),r=[{x:0,y:0,w:n,h:1/0}];let o=0,u=0;for(const l of i)for(let h=r.length-1;h>=0;h--){const c=r[h];if(!(l.w>c.w||l.h>c.h)){if(l.x=c.x,l.y=c.y,u=Math.max(u,l.y+l.h),o=Math.max(o,l.x+l.w),l.w===c.w&&l.h===c.h){const d=r.pop();h<r.length&&(r[h]=d)}else l.h===c.h?(c.x+=l.w,c.w-=l.w):l.w===c.w?(c.y+=l.h,c.h-=l.h):(r.push({x:c.x+l.w,y:c.y,w:c.w-l.w,h:l.h}),c.y+=l.h,c.h-=l.h);break}}return{w:o,h:u,fill:e/(o*u)||0}}async function lA(i){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);return e}function hA(i){return new Promise((e,t)=>{const n=new Image;n.addEventListener("load",()=>e(n)),n.addEventListener("error",async()=>{try{throw await lA(i),new Error("Image failed to load by setting Image src but downloaded successfully using fetch")}catch(r){let o="Unknown Error";r instanceof Error&&(o=r.message),t(o)}}),n.crossOrigin="anonymous",n.src=i})}class nh extends xn{constructor(e,t){super(e),this.data=t}}class fA extends Gn{constructor(e,t,n,{image:r,transformer:o,triangles:u}){super(),this.visible=!1,this.currentScaleFactor=void 0,this.previousScaleFactor=void 0,this.currentScaleFactorTiles=new Map,this.previousScaleFactorTiles=new Map,this.gl=e,this.program=t,this.mapId=n,this.imageWidth=r.width,this.imageHeight=r.height,this.transformer=o,this.triangles=u,this.tilesTexture=e.createTexture(),this.scaleFactorsTexture=e.createTexture(),this.tilePositionsTexture=e.createTexture(),this.imagePositionsTexture=e.createTexture(),this.vao=e.createVertexArray(),e.bindVertexArray(this.vao),this.vao&&this.createBuffer(e,t,u,2,"a_position")}addTileNeeded(e,t,n){const r=t.zoomLevel.scaleFactor;this.currentScaleFactor!==r&&(this.previousScaleFactor=this.currentScaleFactor,this.currentScaleFactor=r),this.currentScaleFactorTiles.has(e)||(this.currentScaleFactorTiles.set(e,{tile:t,imageRequest:n,loading:!0,imageData:void 0}),this.loadTile(e,r))}deleteTileNeeded(e){this.currentScaleFactorTiles.delete(e)}createBuffer(e,t,n,r,o){const u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW);const l=e.FLOAT,h=!1,c=0,d=0,_=e.getAttribLocation(t,o);e.vertexAttribPointer(_,r,l,h,c,d),e.enableVertexAttribArray(_)}async setTileImage(e,t,n){const r=this.currentScaleFactorTiles.get(e);r&&(r.loading=!1,r.imageBitmap=await createImageBitmap(n),this.dispatchEvent(new nh(ne.TILELOADED,e))),this.updateTextures()}updateTextures(){const e=this.gl,t=[];for(let d of this.currentScaleFactorTiles.values())d.loading||t.push(d);const n=t.length,r=t.map((d,_)=>({w:d.imageBitmap.width,h:d.imageBitmap.height,index:_})),{w:o,h:u}=uA(r),l=r.map(({index:d})=>t[d].tile.zoomLevel.scaleFactor);e.bindTexture(e.TEXTURE_2D,this.scaleFactorsTexture),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.texImage2D(e.TEXTURE_2D,0,e.R32I,1,n,0,e.RED_INTEGER,e.INT,new Int32Array(l)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,this.tilesTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,o,u,0,e.RGBA,e.UNSIGNED_BYTE,null),r.forEach(d=>{const _=d.index,v=t[_].imageBitmap,y=d.x,m=d.y;e.texSubImage2D(e.TEXTURE_2D,0,y,m,v.width,v.height,e.RGBA,e.UNSIGNED_BYTE,v)});const h=r.map(d=>[d.x,d.y]);e.bindTexture(e.TEXTURE_2D,this.tilePositionsTexture),e.texImage2D(e.TEXTURE_2D,0,e.RG32I,1,n,0,e.RG_INTEGER,e.INT,new Int32Array(h.flat())),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const c=r.map(({index:d})=>{const _=t[d];return[_.imageRequest.region.x,_.imageRequest.region.y,_.imageRequest.region.width,_.imageRequest.region.height]});e.bindTexture(e.TEXTURE_2D,this.imagePositionsTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA32I,1,n,0,e.RGBA_INTEGER,e.INT,new Int32Array(c.flat())),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}async loadTile(e,t){let n;try{n=await hA(e)}catch{this.dispatchEvent(new nh(ne.TILELOADINGERROR,e))}n?this.setTileImage(e,t,n):this.dispatchEvent(new nh(ne.TILELOADINGERROR,e))}}class cA extends Sa{constructor(e){e=e||{},super(e),this.source=null,this.canvas=null,this.canvasSize=[0,0],this.gl=null,this.program=null,this.backgroundColor=[0,0,0],this.backgroundColorThreshold=0,this.uboBuffers=new Map,this.uboVariableInfo=new Map,this.warpedMapWebGLRenderers=new Map,this.mapIdsInExtent=new Set,this.source=this.getSource(),this.source&&(this.source.on(ne.WARPEDMAPADDED,this.warpedMapAdded.bind(this)),this.source.on(ne.WARPEDMAPENTEREXTENT,this.warpedMapEnterExtent.bind(this)),this.source.on(ne.WARPEDMAPLEAVEEXTENT,this.warpedMapLeaveExtent.bind(this)),this.source.on(ne.TILENEEDED,this.tileNeeded.bind(this)),this.source.on(ne.TILEUNNEEDED,this.tileUnneeded.bind(this)),this.throttledUpdateNeededTiles=xh.exports.throttle(this.source.updateNeededTiles.bind(this.source),100));const t=document.createElement("div");this.container=t,t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.classList.add("ol-layer"),t.classList.add("allmaps-warped-layer");const n=document.createElement("canvas");n.style.position="absolute",n.style.left="0",n.style.width="100%",n.style.height="100%",t.appendChild(n);const r=n.getContext("webgl2",{premultipliedAlpha:!0});if(!r)throw new Error("WebGL 2 not available");new ResizeObserver(this.onResize.bind(this)).observe(n,{box:"content-box"}),this.canvas=n,this.gl=r;const u=this.createShader(r,r.VERTEX_SHADER,aA),l=this.createShader(r,r.FRAGMENT_SHADER,sA);this.program=this.createProgram(r,u,l),r.disable(r.DEPTH_TEST)}createSettingsUniformBufferObject(){this.createUniformBufferObject("Settings",["u_opacity"])}createTransformerUniformBufferObject(){}createUniformBufferObject(e,t){const n=this.gl,r=this.program,o=n.getUniformBlockIndex(r,e),u=n.getActiveUniformBlockParameter(r,o,n.UNIFORM_BLOCK_DATA_SIZE),l=n.createBuffer();if(!l)throw new Error("Unable to create uniform buffer object");n.bindBuffer(n.UNIFORM_BUFFER,l),n.bufferData(n.UNIFORM_BUFFER,u,n.DYNAMIC_DRAW),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,0,l);const h=n.getUniformIndices(r,t);if(!h)throw new Error("Unable to get uniform indices");const c=n.getActiveUniforms(r,h,n.UNIFORM_OFFSET),d=new Map;t.forEach((v,y)=>{d.set(v,{index:h[y],offset:c[y]})}),this.uboVariableInfo.set(e,d);const _=n.getUniformBlockIndex(r,e);n.uniformBlockBinding(r,_,0),this.uboBuffers.set(e,l)}warpedMapAdded(e){const{mapId:t,image:n,transformer:r,triangles:o}=e.data,u=this.gl,l=this.program;if(u&&l){const h=new fA(u,l,t,{image:n,transformer:r,triangles:o});this.warpedMapWebGLRenderers.set(t,h),h.on(ne.TILELOADED,this.tileLoaded.bind(this))}this.changed()}warpedMapEnterExtent(e){const{mapId:t}=e.data;this.mapIdsInExtent.add(t)}warpedMapLeaveExtent(e){const{mapId:t}=e.data;this.mapIdsInExtent.delete(t)}tileNeeded(e){const{mapId:t,url:n,tile:r,imageRequest:o}=e.data;this.warpedMapWebGLRenderers.get(t).addTileNeeded(n,r,o)}tileUnneeded(e){const{mapId:t,url:n}=e.data;this.warpedMapWebGLRenderers.get(t).deleteTileNeeded(n)}tileLoaded(e){this.changed()}createShader(e,t,n){const r=e.createShader(t);if(r){if(e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;{const u=e.getShaderInfoLog(r);throw e.deleteShader(r),new Error("Failed to compile shader: "+u)}}else throw new Error("Failed to create shader")}createProgram(e,t,n){const r=e.createProgram();if(r){if(e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS))return r;{const u=e.getProgramInfoLog(r);throw e.deleteProgram(r),new Error("Failed to link program: "+u)}}else throw new Error("Failed to create program")}onResize(e){for(const t of e){let n,r,o=window.devicePixelRatio;t.devicePixelContentBoxSize?(n=t.devicePixelContentBoxSize[0].inlineSize,r=t.devicePixelContentBoxSize[0].blockSize,o=1):t.contentBoxSize?t.contentBoxSize[0]?(n=t.contentBoxSize[0].inlineSize,r=t.contentBoxSize[0].blockSize):(n=t.contentBoxSize.inlineSize,r=t.contentBoxSize.blockSize):(n=t.contentRect.width,r=t.contentRect.height);const u=Math.round(n*o),l=Math.round(r*o);this.canvasSize=[u,l]}this.changed()}resizeCanvas(e,[t,n]){const r=e.width!==t||e.height!==n;return r&&(e.width=t,e.height=n),r}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/256,parseInt(t[2],16)/256,parseInt(t[3],16)/256]:null}hideBackgroundColor(e,t){this.backgroundColor=this.hexToRgb(e),this.backgroundColorThreshold=t,this.changed()}destroy(){}render(e,t){this.canvas&&this.resizeCanvas(this.canvas,this.canvasSize);const n=[e.size[0]*window.devicePixelRatio,e.size[1]*window.devicePixelRatio];if(this.throttledUpdateNeededTiles&&this.throttledUpdateNeededTiles(n,e.extent,e.coordinateToPixelTransform),this.gl&&this.program){const r=this.gl;r.viewport(0,0,r.canvas.width,r.canvas.height),r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.useProgram(this.program);const o=r.getUniformLocation(this.program,"u_opacity");r.uniform1f(o,this.getOpacity());const u=r.getUniformLocation(this.program,"u_backgroundColor");r.uniform3fv(u,this.backgroundColor);const l=r.getUniformLocation(this.program,"u_backgroundColorThreshold");r.uniform1f(l,this.backgroundColorThreshold);const h=r.getUniformLocation(this.program,"u_viewportSize");r.uniform2f(h,Math.round(r.canvas.width/window.devicePixelRatio),Math.round(r.canvas.height/window.devicePixelRatio));const c=r.getUniformLocation(this.program,"u_coordinateToPixelTransform");r.uniform1fv(c,e.coordinateToPixelTransform);const d=r.getUniformLocation(this.program,"u_devicePixelRatio");r.uniform1f(d,window.devicePixelRatio);const _=r.getUniformLocation(this.program,"u_pixelToCoordinateTransform");r.uniform1fv(_,e.pixelToCoordinateTransform);for(let v of this.mapIdsInExtent){const y=this.warpedMapWebGLRenderers.get(v),m=y.transformer,w=r.getUniformLocation(this.program,"u_x2Mean");r.uniform1f(w,m.x2Mean);const C=r.getUniformLocation(this.program,"u_y2Mean");r.uniform1f(C,m.y2Mean);const P=r.getUniformLocation(this.program,"u_adfFromGeoX");r.uniform3f(P,m.adfFromGeoX[0],m.adfFromGeoX[1],m.adfFromGeoX[2]);const I=r.getUniformLocation(this.program,"u_adfFromGeoY");r.uniform3f(I,m.adfFromGeoY[0],m.adfFromGeoY[1],m.adfFromGeoY[2]);const A=r.getUniformLocation(this.program,"u_tilesTexture");r.uniform1i(A,0),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,y.tilesTexture);const L=r.getUniformLocation(this.program,"u_tilePositionsTexture");r.uniform1i(L,1),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,y.tilePositionsTexture);const F=r.getUniformLocation(this.program,"u_imagePositionsTexture");r.uniform1i(F,2),r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,y.imagePositionsTexture);const U=r.getUniformLocation(this.program,"u_scaleFactorsTexture");r.uniform1i(U,3),r.activeTexture(r.TEXTURE3),r.bindTexture(r.TEXTURE_2D,y.scaleFactorsTexture);const G=y.vao,X=y.triangles,B=this.gl.TRIANGLES,Z=0,j=X.length/2;r.bindVertexArray(G),r.drawArrays(B,Z,j)}}return this.container}}function wh(i){return Array.isArray(i)?`[${i.map(e=>wh(e)).join(",")}]`:typeof i=="number"?`${i}`:typeof i=="string"?`"${i}"`:typeof i=="object"&&i!==null?Object.keys(i).sort().map(e=>`${e}:${wh(i[e])}`).join("|"):String(i)}async function dA(i){const e=await crypto.subtle.digest("SHA-1",new TextEncoder().encode(i));return Array.from(new Uint8Array(e)).map(r=>r.toString(16).padStart(2,"0")).join("")}async function pA(i,e=16){return(await dA(String(i))).slice(0,e)}async function vA(i,e){return await pA(wh(i),e)}function _A(){return new Worker("/webgl2-preview/_app/assets/worker.c2c5e64f.js",{type:"module"})}class yi extends xn{constructor(e,t){super(e),this.data=t}}class gA extends rf{constructor(){super({interpolate:!0,projection:void 0,state:ti.READY,wrapX:!0}),this.tileUrls=new Set,this.worker=new _A,this.worker.onmessage=this.onWorkerMessage.bind(this)}onWorkerMessage(e){const{type:t,data:n}=e.data;if(t===ne.WARPEDMAPADDED)this.dispatchEvent(new yi(ne.WARPEDMAPADDED,n)),this.changed();else if(t===ne.WARPEDMAPENTEREXTENT)this.dispatchEvent(new yi(ne.WARPEDMAPENTEREXTENT,n));else if(t===ne.WARPEDMAPLEAVEEXTENT)this.dispatchEvent(new yi(ne.WARPEDMAPLEAVEEXTENT,n));else if(t===ne.TILENEEDED){this.dispatchEvent(new yi(ne.TILENEEDED,n));const{url:r}=n;this.tileUrls.add(r),this.dispatchEvent(new yi(ne.TILESCHANGED,[...this.tileUrls]))}else if(t===ne.TILEUNNEEDED){this.dispatchEvent(new yi(ne.TILEUNNEEDED,n));const{url:r}=n;this.tileUrls.delete(r),this.dispatchEvent(new yi(ne.TILESCHANGED,[...this.tileUrls]))}}sendWorkerMessage(e,t){this.worker.postMessage({type:e,data:t})}updateNeededTiles(e,t,n){this.sendWorkerMessage(ne.UPDATENEEDEDTILES,{size:e,extent:t,coordinateToPixelTransform:n})}async addMap(e){const t=await vA(e);this.sendWorkerMessage(ne.ADDMAP,{mapId:t,map:e})}}function yA(i){return new Gv({stroke:new Oi({color:"#E10800",width:4}),fill:new Li({color:"rgba(255, 255, 255, 0.2)"}),text:i_(i)})}function mA(i){return new Gv({stroke:new Oi({color:"#E10800",width:4}),fill:new Li({color:"rgba(255, 255, 255, 0.5)"}),text:i_(i)})}function i_(i){return new QI({scale:1.5,text:EA(i),fill:new Li({color:"#000"}),stroke:new Oi({color:"#fff",width:2})})}function EA(i){const e=i.getProperties();return String(e.uri)}var $t;(function(i){function e(n){throw new Error}i.assertNever=e,i.arrayToEnum=n=>{const r={};for(const o of n)r[o]=o;return r},i.getValidEnumValues=n=>{const r=i.objectKeys(n).filter(u=>typeof n[n[u]]!="number"),o={};for(const u of r)o[u]=n[u];return i.objectValues(o)},i.objectValues=n=>i.objectKeys(n).map(function(r){return n[r]}),i.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const r=[];for(const o in n)Object.prototype.hasOwnProperty.call(n,o)&&r.push(o);return r},i.find=(n,r)=>{for(const o of n)if(r(o))return o},i.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function t(n,r=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}i.joinValues=t})($t||($t={}));const J=$t.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Vr=i=>{switch(typeof i){case"undefined":return J.undefined;case"string":return J.string;case"number":return isNaN(i)?J.nan:J.number;case"boolean":return J.boolean;case"function":return J.function;case"bigint":return J.bigint;case"object":return Array.isArray(i)?J.array:i===null?J.null:i.then&&typeof i.then=="function"&&i.catch&&typeof i.catch=="function"?J.promise:typeof Map!="undefined"&&i instanceof Map?J.map:typeof Set!="undefined"&&i instanceof Set?J.set:typeof Date!="undefined"&&i instanceof Date?J.date:J.object;default:return J.unknown}},q=$t.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of"]),TA=i=>JSON.stringify(i,null,2).replace(/"([^"]+)":/g,"$1:");class Er extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(o){return o.message},n={_errors:[]},r=o=>{for(const u of o.issues)if(u.code==="invalid_union")u.unionErrors.map(r);else if(u.code==="invalid_return_type")r(u.returnTypeError);else if(u.code==="invalid_arguments")r(u.argumentsError);else if(u.path.length===0)n._errors.push(t(u));else{let l=n,h=0;for(;h<u.path.length;){const c=u.path[h];h===u.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(t(u))):l[c]=l[c]||{_errors:[]},l=l[c],h++}}};return r(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,null,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Er.create=i=>new Er(i);const ya=(i,e)=>{let t;switch(i.code){case q.invalid_type:i.received===J.undefined?t="Required":t=`Expected ${i.expected}, received ${i.received}`;break;case q.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(i.expected)}`;break;case q.unrecognized_keys:t=`Unrecognized key(s) in object: ${$t.joinValues(i.keys,", ")}`;break;case q.invalid_union:t="Invalid input";break;case q.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${$t.joinValues(i.options)}`;break;case q.invalid_enum_value:t=`Invalid enum value. Expected ${$t.joinValues(i.options)}, received '${i.received}'`;break;case q.invalid_arguments:t="Invalid function arguments";break;case q.invalid_return_type:t="Invalid function return type";break;case q.invalid_date:t="Invalid date";break;case q.invalid_string:i.validation!=="regex"?t=`Invalid ${i.validation}`:t="Invalid";break;case q.too_small:i.type==="array"?t=`Array must contain ${i.inclusive?"at least":"more than"} ${i.minimum} element(s)`:i.type==="string"?t=`String must contain ${i.inclusive?"at least":"over"} ${i.minimum} character(s)`:i.type==="number"?t=`Number must be greater than ${i.inclusive?"or equal to ":""}${i.minimum}`:t="Invalid input";break;case q.too_big:i.type==="array"?t=`Array must contain ${i.inclusive?"at most":"less than"} ${i.maximum} element(s)`:i.type==="string"?t=`String must contain ${i.inclusive?"at most":"under"} ${i.maximum} character(s)`:i.type==="number"?t=`Number must be less than ${i.inclusive?"or equal to ":""}${i.maximum}`:t="Invalid input";break;case q.custom:t="Invalid input";break;case q.invalid_intersection_types:t="Intersection results could not be merged";break;case q.not_multiple_of:t=`Number must be a multiple of ${i.multipleOf}`;break;default:t=e.defaultError,$t.assertNever(i)}return{message:t}};let ma=ya;const xA=i=>{ma=i},nu=i=>{const{data:e,path:t,errorMaps:n,issueData:r}=i,o=[...t,...r.path||[]],u={...r,path:o};let l="";const h=n.filter(c=>!!c).slice().reverse();for(const c of h)l=c(u,{data:e,defaultError:l}).message;return{...r,path:o,message:r.message||l}},wA=[];function ct(i,e){const t=nu({issueData:e,data:i.data,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,ma,ya].filter(n=>!!n)});i.common.issues.push(t)}class He{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if(r.status==="aborted")return Ct;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t)n.push({key:await r.key,value:await r.value});return He.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:o,value:u}=r;if(o.status==="aborted"||u.status==="aborted")return Ct;o.status==="dirty"&&e.dirty(),u.status==="dirty"&&e.dirty(),(typeof u.value!="undefined"||r.alwaysSet)&&(n[o.value]=u.value)}return{status:e.value,value:n}}}const Ct=Object.freeze({status:"aborted"}),RA=i=>({status:"dirty",value:i}),We=i=>({status:"valid",value:i}),Rh=i=>i.status==="aborted",Ch=i=>i.status==="dirty",ru=i=>i.status==="valid",Ih=i=>typeof Promise!==void 0&&i instanceof Promise;var Yt;(function(i){i.errToObj=e=>typeof e=="string"?{message:e}:e||{},i.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Yt||(Yt={}));class Hn{constructor(e,t,n,r){this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._path.concat(this._key)}}const Cp=(i,e)=>{if(ru(e))return{success:!0,data:e.value};{if(!i.common.issues.length)throw new Error("Validation failed but no issues detected.");const t=new Er(i.common.issues);return{success:!1,error:t}}};function bt(i){if(!i)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:r}=i;if(e&&(t||n))throw new Error(`Can't use "invalid" or "required" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(u,l)=>u.code!=="invalid_type"?{message:l.defaultError}:typeof l.data=="undefined"&&n?{message:n}:i.invalid_type_error?{message:i.invalid_type_error}:{message:l.defaultError},description:r}}class Nt{constructor(e){this.spa=this.safeParseAsync,this.superRefine=this._refinement,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.default=this.default.bind(this),this.describe=this.describe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Vr(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Vr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new He,ctx:{common:e.parent.common,data:e.data,parsedType:Vr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Ih(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Vr(e)},o=this._parseSync({data:e,path:r.path,parent:r});return Cp(r,o)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Vr(e)},r=this._parse({data:e,path:[],parent:n}),o=await(Ih(r)?r:Promise.resolve(r));return Cp(n,o)}refine(e,t){const n=r=>typeof t=="string"||typeof t=="undefined"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,o)=>{const u=e(r),l=()=>o.addIssue({code:q.custom,...n(r)});return typeof Promise!="undefined"&&u instanceof Promise?u.then(h=>h?!0:(l(),!1)):u?!0:(l(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new Jn({schema:this,typeName:Et.ZodEffects,effect:{type:"refinement",refinement:e}})}optional(){return Vn.create(this)}nullable(){return Ni.create(this)}nullish(){return this.optional().nullable()}array(){return $n.create(this)}promise(){return Ro.create(this)}or(e){return Ea.create([this,e])}and(e){return Ta.create(this,e)}transform(e){return new Jn({schema:this,typeName:Et.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new af({innerType:this,defaultValue:t,typeName:Et.ZodDefault})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const CA=/^c[^\s-]{8,}$/i,IA=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,OA=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;class ei extends Nt{constructor(){super(...arguments),this._regex=(e,t,n)=>this.refinement(r=>e.test(r),{validation:t,code:q.invalid_string,...Yt.errToObj(n)}),this.nonempty=e=>this.min(1,Yt.errToObj(e)),this.trim=()=>new ei({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}_parse(e){if(this._getType(e)!==J.string){const o=this._getOrReturnCtx(e);return ct(o,{code:q.invalid_type,expected:J.string,received:o.parsedType}),Ct}const n=new He;let r;for(const o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(r=this._getOrReturnCtx(e,r),ct(r,{code:q.too_small,minimum:o.value,type:"string",inclusive:!0,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(r=this._getOrReturnCtx(e,r),ct(r,{code:q.too_big,maximum:o.value,type:"string",inclusive:!0,message:o.message}),n.dirty());else if(o.kind==="email")OA.test(e.data)||(r=this._getOrReturnCtx(e,r),ct(r,{validation:"email",code:q.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")IA.test(e.data)||(r=this._getOrReturnCtx(e,r),ct(r,{validation:"uuid",code:q.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")CA.test(e.data)||(r=this._getOrReturnCtx(e,r),ct(r,{validation:"cuid",code:q.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),ct(r,{validation:"url",code:q.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),ct(r,{validation:"regex",code:q.invalid_string,message:o.message}),n.dirty())):o.kind==="trim"?e.data=e.data.trim():$t.assertNever(o);return{status:n.value,value:e.data}}_addCheck(e){return new ei({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Yt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Yt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Yt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Yt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Yt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Yt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Yt.errToObj(t)})}length(e,t){return this.min(e,t).max(e,t)}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get minLength(){let e=-1/0;return this._def.checks.map(t=>{t.kind==="min"&&(e===null||t.value>e)&&(e=t.value)}),e}get maxLength(){let e=null;return this._def.checks.map(t=>{t.kind==="max"&&(e===null||t.value<e)&&(e=t.value)}),e}}ei.create=i=>new ei({checks:[],typeName:Et.ZodString,...bt(i)});function SA(i,e){const t=(i.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=t>n?t:n,o=parseInt(i.toFixed(r).replace(".","")),u=parseInt(e.toFixed(r).replace(".",""));return o%u/Math.pow(10,r)}class Mi extends Nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._getType(e)!==J.number){const o=this._getOrReturnCtx(e);return ct(o,{code:q.invalid_type,expected:J.number,received:o.parsedType}),Ct}let n;const r=new He;for(const o of this._def.checks)o.kind==="int"?$t.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),ct(n,{code:q.invalid_type,expected:"integer",received:"float",message:o.message}),r.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),ct(n,{code:q.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,message:o.message}),r.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),ct(n,{code:q.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,message:o.message}),r.dirty()):o.kind==="multipleOf"?SA(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),ct(n,{code:q.not_multiple_of,multipleOf:o.value,message:o.message}),r.dirty()):$t.assertNever(o);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Yt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Yt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Yt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Yt.toString(t))}setLimit(e,t,n,r){return new Mi({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Yt.toString(r)}]})}_addCheck(e){return new Mi({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Yt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Yt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Yt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Yt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Yt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Yt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int")}}Mi.create=i=>new Mi({checks:[],typeName:Et.ZodNumber,...bt(i)});class iu extends Nt{_parse(e){if(this._getType(e)!==J.bigint){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_type,expected:J.bigint,received:n.parsedType}),Ct}return We(e.data)}}iu.create=i=>new iu({typeName:Et.ZodBigInt,...bt(i)});class ou extends Nt{_parse(e){if(this._getType(e)!==J.boolean){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_type,expected:J.boolean,received:n.parsedType}),Ct}return We(e.data)}}ou.create=i=>new ou({typeName:Et.ZodBoolean,...bt(i)});class au extends Nt{_parse(e){if(this._getType(e)!==J.date){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_type,expected:J.date,received:n.parsedType}),Ct}if(isNaN(e.data.getTime())){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_date}),Ct}return{status:"valid",value:new Date(e.data.getTime())}}}au.create=i=>new au({typeName:Et.ZodDate,...bt(i)});class su extends Nt{_parse(e){if(this._getType(e)!==J.undefined){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_type,expected:J.undefined,received:n.parsedType}),Ct}return We(e.data)}}su.create=i=>new su({typeName:Et.ZodUndefined,...bt(i)});class uu extends Nt{_parse(e){if(this._getType(e)!==J.null){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_type,expected:J.null,received:n.parsedType}),Ct}return We(e.data)}}uu.create=i=>new uu({typeName:Et.ZodNull,...bt(i)});class wo extends Nt{constructor(){super(...arguments),this._any=!0}_parse(e){return We(e.data)}}wo.create=i=>new wo({typeName:Et.ZodAny,...bt(i)});class Jr extends Nt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return We(e.data)}}Jr.create=i=>new Jr({typeName:Et.ZodUnknown,...bt(i)});class ni extends Nt{_parse(e){const t=this._getOrReturnCtx(e);return ct(t,{code:q.invalid_type,expected:J.never,received:t.parsedType}),Ct}}ni.create=i=>new ni({typeName:Et.ZodNever,...bt(i)});class lu extends Nt{_parse(e){if(this._getType(e)!==J.undefined){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_type,expected:J.void,received:n.parsedType}),Ct}return We(e.data)}}lu.create=i=>new lu({typeName:Et.ZodVoid,...bt(i)});class $n extends Nt{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==J.array)return ct(t,{code:q.invalid_type,expected:J.array,received:t.parsedType}),Ct;if(r.minLength!==null&&t.data.length<r.minLength.value&&(ct(t,{code:q.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(ct(t,{code:q.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all(t.data.map((u,l)=>r.type._parseAsync(new Hn(t,u,t.path,l)))).then(u=>He.mergeArray(n,u));const o=t.data.map((u,l)=>r.type._parseSync(new Hn(t,u,t.path,l)));return He.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new $n({...this._def,minLength:{value:e,message:Yt.toString(t)}})}max(e,t){return new $n({...this._def,maxLength:{value:e,message:Yt.toString(t)}})}length(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}$n.create=(i,e)=>new $n({type:i,minLength:null,maxLength:null,typeName:Et.ZodArray,...bt(e)});var hu;(function(i){i.mergeShapes=(e,t)=>({...e,...t})})(hu||(hu={}));const Ip=i=>e=>new te({...i,shape:()=>({...i.shape(),...e})});function po(i){if(i instanceof te){const e={};for(const t in i.shape){const n=i.shape[t];e[t]=Vn.create(po(n))}return new te({...i._def,shape:()=>e})}else return i instanceof $n?$n.create(po(i.element)):i instanceof Vn?Vn.create(po(i.unwrap())):i instanceof Ni?Ni.create(po(i.unwrap())):i instanceof qn?qn.create(i.items.map(e=>po(e))):i}class te extends Nt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=Ip(this._def),this.extend=Ip(this._def)}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=$t.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==J.object){const c=this._getOrReturnCtx(e);return ct(c,{code:q.invalid_type,expected:J.object,received:c.parsedType}),Ct}const{status:n,ctx:r}=this._processInputParams(e),{shape:o,keys:u}=this._getCached(),l=[];for(const c in r.data)u.includes(c)||l.push(c);const h=[];for(const c of u){const d=o[c],_=r.data[c];h.push({key:{status:"valid",value:c},value:d._parse(new Hn(r,_,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof ni){const c=this._def.unknownKeys;if(c==="passthrough")for(const d of l)h.push({key:{status:"valid",value:d},value:{status:"valid",value:r.data[d]}});else if(c==="strict")l.length>0&&(ct(r,{code:q.unrecognized_keys,keys:l}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const d of l){const _=r.data[d];h.push({key:{status:"valid",value:d},value:c._parse(new Hn(r,_,r.path,d)),alwaysSet:d in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const c=[];for(const d of h){const _=await d.key;c.push({key:_,value:await d.value,alwaysSet:d.alwaysSet})}return c}).then(c=>He.mergeObjectSync(n,c)):He.mergeObjectSync(n,h)}get shape(){return this._def.shape()}strict(e){return Yt.errToObj,new te({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var r,o,u,l;const h=(u=(o=(r=this._def).errorMap)===null||o===void 0?void 0:o.call(r,t,n).message)!==null&&u!==void 0?u:n.defaultError;return t.code==="unrecognized_keys"?{message:(l=Yt.errToObj(e).message)!==null&&l!==void 0?l:h}:{message:h}}}:{}})}strip(){return new te({...this._def,unknownKeys:"strip"})}passthrough(){return new te({...this._def,unknownKeys:"passthrough"})}setKey(e,t){return this.augment({[e]:t})}merge(e){return new te({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>hu.mergeShapes(this._def.shape(),e._def.shape()),typeName:Et.ZodObject})}catchall(e){return new te({...this._def,catchall:e})}pick(e){const t={};return $t.objectKeys(e).map(n=>{this.shape[n]&&(t[n]=this.shape[n])}),new te({...this._def,shape:()=>t})}omit(e){const t={};return $t.objectKeys(this.shape).map(n=>{$t.objectKeys(e).indexOf(n)===-1&&(t[n]=this.shape[n])}),new te({...this._def,shape:()=>t})}deepPartial(){return po(this)}partial(e){const t={};if(e)return $t.objectKeys(this.shape).map(n=>{$t.objectKeys(e).indexOf(n)===-1?t[n]=this.shape[n]:t[n]=this.shape[n].optional()}),new te({...this._def,shape:()=>t});for(const n in this.shape){const r=this.shape[n];t[n]=r.optional()}return new te({...this._def,shape:()=>t})}required(){const e={};for(const t in this.shape){let r=this.shape[t];for(;r instanceof Vn;)r=r._def.innerType;e[t]=r}return new te({...this._def,shape:()=>e})}}te.create=(i,e)=>new te({shape:()=>i,unknownKeys:"strip",catchall:ni.create(),typeName:Et.ZodObject,...bt(e)});te.strictCreate=(i,e)=>new te({shape:()=>i,unknownKeys:"strict",catchall:ni.create(),typeName:Et.ZodObject,...bt(e)});te.lazycreate=(i,e)=>new te({shape:i,unknownKeys:"strip",catchall:ni.create(),typeName:Et.ZodObject,...bt(e)});class Ea extends Nt{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function r(o){for(const l of o)if(l.result.status==="valid")return l.result;for(const l of o)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const u=o.map(l=>new Er(l.ctx.common.issues));return ct(t,{code:q.invalid_union,unionErrors:u}),Ct}if(t.common.async)return Promise.all(n.map(async o=>{const u={...t,common:{...t.common,issues:[]},parent:null};return{result:await o._parseAsync({data:t.data,path:t.path,parent:u}),ctx:u}})).then(r);{let o;const u=[];for(const h of n){const c={...t,common:{...t.common,issues:[]},parent:null},d=h._parseSync({data:t.data,path:t.path,parent:c});if(d.status==="valid")return d;d.status==="dirty"&&!o&&(o={result:d,ctx:c}),c.common.issues.length&&u.push(c.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;const l=u.map(h=>new Er(h));return ct(t,{code:q.invalid_union,unionErrors:l}),Ct}}get options(){return this._def.options}}Ea.create=(i,e)=>new Ea({options:i,typeName:Et.ZodUnion,...bt(e)});class Iu extends Nt{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==J.object)return ct(t,{code:q.invalid_type,expected:J.object,received:t.parsedType}),Ct;const n=this.discriminator,r=t.data[n],o=this.options.get(r);return o?t.common.async?o._parseAsync({data:t.data,path:t.path,parent:t}):o._parseSync({data:t.data,path:t.path,parent:t}):(ct(t,{code:q.invalid_union_discriminator,options:this.validDiscriminatorValues,path:[n]}),Ct)}get discriminator(){return this._def.discriminator}get validDiscriminatorValues(){return Array.from(this.options.keys())}get options(){return this._def.options}static create(e,t,n){const r=new Map;try{t.forEach(o=>{const u=o.shape[e].value;r.set(u,o)})}catch{throw new Error("The discriminator value could not be extracted from all the provided schemas")}if(r.size!==t.length)throw new Error("Some of the discriminator values are not unique");return new Iu({typeName:Et.ZodDiscriminatedUnion,discriminator:e,options:r,...bt(n)})}}function Oh(i,e){const t=Vr(i),n=Vr(e);if(i===e)return{valid:!0,data:i};if(t===J.object&&n===J.object){const r=$t.objectKeys(e),o=$t.objectKeys(i).filter(l=>r.indexOf(l)!==-1),u={...i,...e};for(const l of o){const h=Oh(i[l],e[l]);if(!h.valid)return{valid:!1};u[l]=h.data}return{valid:!0,data:u}}else if(t===J.array&&n===J.array){if(i.length!==e.length)return{valid:!1};const r=[];for(let o=0;o<i.length;o++){const u=i[o],l=e[o],h=Oh(u,l);if(!h.valid)return{valid:!1};r.push(h.data)}return{valid:!0,data:r}}else return t===J.date&&n===J.date&&+i==+e?{valid:!0,data:i}:{valid:!1}}class Ta extends Nt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(o,u)=>{if(Rh(o)||Rh(u))return Ct;const l=Oh(o.value,u.value);return l.valid?((Ch(o)||Ch(u))&&t.dirty(),{status:t.value,value:l.data}):(ct(n,{code:q.invalid_intersection_types}),Ct)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,u])=>r(o,u)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Ta.create=(i,e,t)=>new Ta({left:i,right:e,typeName:Et.ZodIntersection,...bt(t)});class qn extends Nt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.array)return ct(n,{code:q.invalid_type,expected:J.array,received:n.parsedType}),Ct;if(n.data.length<this._def.items.length)return ct(n,{code:q.too_small,minimum:this._def.items.length,inclusive:!0,type:"array"}),Ct;!this._def.rest&&n.data.length>this._def.items.length&&(ct(n,{code:q.too_big,maximum:this._def.items.length,inclusive:!0,type:"array"}),t.dirty());const o=n.data.map((u,l)=>{const h=this._def.items[l]||this._def.rest;return h?h._parse(new Hn(n,u,n.path,l)):null}).filter(u=>!!u);return n.common.async?Promise.all(o).then(u=>He.mergeArray(t,u)):He.mergeArray(t,o)}get items(){return this._def.items}rest(e){return new qn({...this._def,rest:e})}}qn.create=(i,e)=>new qn({items:i,typeName:Et.ZodTuple,rest:null,...bt(e)});class xa extends Nt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.object)return ct(n,{code:q.invalid_type,expected:J.object,received:n.parsedType}),Ct;const r=[],o=this._def.keyType,u=this._def.valueType;for(const l in n.data)r.push({key:o._parse(new Hn(n,l,n.path,l)),value:u._parse(new Hn(n,n.data[l],n.path,l))});return n.common.async?He.mergeObjectAsync(t,r):He.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof Nt?new xa({keyType:e,valueType:t,typeName:Et.ZodRecord,...bt(n)}):new xa({keyType:ei.create(),valueType:e,typeName:Et.ZodRecord,...bt(t)})}}class fu extends Nt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.map)return ct(n,{code:q.invalid_type,expected:J.map,received:n.parsedType}),Ct;const r=this._def.keyType,o=this._def.valueType,u=[...n.data.entries()].map(([l,h],c)=>({key:r._parse(new Hn(n,l,n.path,[c,"key"])),value:o._parse(new Hn(n,h,n.path,[c,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const h of u){const c=await h.key,d=await h.value;if(c.status==="aborted"||d.status==="aborted")return Ct;(c.status==="dirty"||d.status==="dirty")&&t.dirty(),l.set(c.value,d.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const h of u){const c=h.key,d=h.value;if(c.status==="aborted"||d.status==="aborted")return Ct;(c.status==="dirty"||d.status==="dirty")&&t.dirty(),l.set(c.value,d.value)}return{status:t.value,value:l}}}}fu.create=(i,e,t)=>new fu({valueType:e,keyType:i,typeName:Et.ZodMap,...bt(t)});class Di extends Nt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.set)return ct(n,{code:q.invalid_type,expected:J.set,received:n.parsedType}),Ct;const r=this._def;r.minSize!==null&&n.data.size<r.minSize.value&&(ct(n,{code:q.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&n.data.size>r.maxSize.value&&(ct(n,{code:q.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,message:r.maxSize.message}),t.dirty());const o=this._def.valueType;function u(h){const c=new Set;for(const d of h){if(d.status==="aborted")return Ct;d.status==="dirty"&&t.dirty(),c.add(d.value)}return{status:t.value,value:c}}const l=[...n.data.values()].map((h,c)=>o._parse(new Hn(n,h,n.path,c)));return n.common.async?Promise.all(l).then(h=>u(h)):u(l)}min(e,t){return new Di({...this._def,minSize:{value:e,message:Yt.toString(t)}})}max(e,t){return new Di({...this._def,maxSize:{value:e,message:Yt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Di.create=(i,e)=>new Di({valueType:i,minSize:null,maxSize:null,typeName:Et.ZodSet,...bt(e)});class Fi extends Nt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==J.function)return ct(t,{code:q.invalid_type,expected:J.function,received:t.parsedType}),Ct;function n(l,h){return nu({data:l,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ma,ya].filter(c=>!!c),issueData:{code:q.invalid_arguments,argumentsError:h}})}function r(l,h){return nu({data:l,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,ma,ya].filter(c=>!!c),issueData:{code:q.invalid_return_type,returnTypeError:h}})}const o={errorMap:t.common.contextualErrorMap},u=t.data;return this._def.returns instanceof Ro?We(async(...l)=>{const h=new Er([]),c=await this._def.args.parseAsync(l,o).catch(v=>{throw h.addIssue(n(l,v)),h}),d=await u(...c);return await this._def.returns._def.type.parseAsync(d,o).catch(v=>{throw h.addIssue(r(d,v)),h})}):We((...l)=>{const h=this._def.args.safeParse(l,o);if(!h.success)throw new Er([n(l,h.error)]);const c=u(...h.data),d=this._def.returns.safeParse(c,o);if(!d.success)throw new Er([r(c,d.error)]);return d.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Fi({...this._def,args:qn.create(e).rest(Jr.create())})}returns(e){return new Fi({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}}Fi.create=(i,e,t)=>new Fi({args:i?i.rest(Jr.create()):qn.create([]).rest(Jr.create()),returns:e||Jr.create(),typeName:Et.ZodFunction,...bt(t)});class cu extends Nt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}cu.create=(i,e)=>new cu({getter:i,typeName:Et.ZodLazy,...bt(e)});class du extends Nt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ct(t,{code:q.invalid_literal,expected:this._def.value}),Ct}return{status:"valid",value:e.data}}get value(){return this._def.value}}du.create=(i,e)=>new du({value:i,typeName:Et.ZodLiteral,...bt(e)});function AA(i,e){return new Ou({values:i,typeName:Et.ZodEnum,...bt(e)})}class Ou extends Nt{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return ct(t,{expected:$t.joinValues(n),received:t.parsedType,code:q.invalid_type}),Ct}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),n=this._def.values;return ct(t,{received:t.data,code:q.invalid_enum_value,options:n}),Ct}return We(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}}Ou.create=AA;class pu extends Nt{_parse(e){const t=$t.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==J.string&&n.parsedType!==J.number){const r=$t.objectValues(t);return ct(n,{expected:$t.joinValues(r),received:n.parsedType,code:q.invalid_type}),Ct}if(t.indexOf(e.data)===-1){const r=$t.objectValues(t);return ct(n,{received:n.data,code:q.invalid_enum_value,options:r}),Ct}return We(e.data)}get enum(){return this._def.values}}pu.create=(i,e)=>new pu({values:i,typeName:Et.ZodNativeEnum,...bt(e)});class Ro extends Nt{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==J.promise&&t.common.async===!1)return ct(t,{code:q.invalid_type,expected:J.promise,received:t.parsedType}),Ct;const n=t.parsedType===J.promise?t.data:Promise.resolve(t.data);return We(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Ro.create=(i,e)=>new Ro({type:i,typeName:Et.ZodPromise,...bt(e)});class Jn extends Nt{innerType(){return this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null;if(r.type==="preprocess"){const u=r.transform(n.data);return n.common.async?Promise.resolve(u).then(l=>this._def.schema._parseAsync({data:l,path:n.path,parent:n})):this._def.schema._parseSync({data:u,path:n.path,parent:n})}const o={addIssue:u=>{ct(n,u),u.fatal?t.abort():t.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),r.type==="refinement"){const u=l=>{const h=r.refinement(l,o);if(n.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?Ct:(l.status==="dirty"&&t.dirty(),u(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?Ct:(l.status==="dirty"&&t.dirty(),u(l.value).then(()=>({status:t.value,value:l.value}))))}if(r.type==="transform")if(n.common.async===!1){const u=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ru(u))return u;const l=r.transform(u.value,o);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(u=>ru(u)?Promise.resolve(r.transform(u.value,o)).then(l=>({status:t.value,value:l})):u);$t.assertNever(r)}}Jn.create=(i,e,t)=>new Jn({schema:i,typeName:Et.ZodEffects,effect:e,...bt(t)});Jn.createWithPreprocess=(i,e,t)=>new Jn({schema:e,effect:{type:"preprocess",transform:i},typeName:Et.ZodEffects,...bt(t)});class Vn extends Nt{_parse(e){return this._getType(e)===J.undefined?We(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Vn.create=(i,e)=>new Vn({innerType:i,typeName:Et.ZodOptional,...bt(e)});class Ni extends Nt{_parse(e){return this._getType(e)===J.null?We(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ni.create=(i,e)=>new Ni({innerType:i,typeName:Et.ZodNullable,...bt(e)});class af extends Nt{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===J.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}af.create=(i,e)=>new Vn({innerType:i,typeName:Et.ZodOptional,...bt(e)});class vu extends Nt{_parse(e){if(this._getType(e)!==J.nan){const n=this._getOrReturnCtx(e);return ct(n,{code:q.invalid_type,expected:J.nan,received:n.parsedType}),Ct}return{status:"valid",value:e.data}}}vu.create=i=>new vu({typeName:Et.ZodNaN,...bt(i)});const o_=(i,e={},t)=>i?wo.create().superRefine((n,r)=>{if(!i(n)){const o=typeof e=="function"?e(n):e,u=typeof o=="string"?{message:o}:o;r.addIssue({code:"custom",...u,fatal:t})}}):wo.create(),PA={object:te.lazycreate};var Et;(function(i){i.ZodString="ZodString",i.ZodNumber="ZodNumber",i.ZodNaN="ZodNaN",i.ZodBigInt="ZodBigInt",i.ZodBoolean="ZodBoolean",i.ZodDate="ZodDate",i.ZodUndefined="ZodUndefined",i.ZodNull="ZodNull",i.ZodAny="ZodAny",i.ZodUnknown="ZodUnknown",i.ZodNever="ZodNever",i.ZodVoid="ZodVoid",i.ZodArray="ZodArray",i.ZodObject="ZodObject",i.ZodUnion="ZodUnion",i.ZodDiscriminatedUnion="ZodDiscriminatedUnion",i.ZodIntersection="ZodIntersection",i.ZodTuple="ZodTuple",i.ZodRecord="ZodRecord",i.ZodMap="ZodMap",i.ZodSet="ZodSet",i.ZodFunction="ZodFunction",i.ZodLazy="ZodLazy",i.ZodLiteral="ZodLiteral",i.ZodEnum="ZodEnum",i.ZodEffects="ZodEffects",i.ZodNativeEnum="ZodNativeEnum",i.ZodOptional="ZodOptional",i.ZodNullable="ZodNullable",i.ZodDefault="ZodDefault",i.ZodPromise="ZodPromise"})(Et||(Et={}));const LA=(i,e={message:`Input not instance of ${i.name}`})=>o_(t=>t instanceof i,e,!0),a_=ei.create,s_=Mi.create,MA=vu.create,DA=iu.create,u_=ou.create,FA=au.create,NA=su.create,bA=uu.create,GA=wo.create,kA=Jr.create,UA=ni.create,WA=lu.create,XA=$n.create,BA=te.create,YA=te.strictCreate,ZA=Ea.create,zA=Iu.create,jA=Ta.create,VA=qn.create,KA=xa.create,HA=fu.create,$A=Di.create,qA=Fi.create,JA=cu.create,QA=du.create,tP=Ou.create,eP=pu.create,nP=Ro.create,Op=Jn.create,rP=Vn.create,iP=Ni.create,oP=Jn.createWithPreprocess,aP=()=>a_().optional(),sP=()=>s_().optional(),uP=()=>u_().optional();var Rt=Object.freeze({__proto__:null,getParsedType:Vr,ZodParsedType:J,makeIssue:nu,EMPTY_PATH:wA,addIssueToContext:ct,ParseStatus:He,INVALID:Ct,DIRTY:RA,OK:We,isAborted:Rh,isDirty:Ch,isValid:ru,isAsync:Ih,ZodType:Nt,ZodString:ei,ZodNumber:Mi,ZodBigInt:iu,ZodBoolean:ou,ZodDate:au,ZodUndefined:su,ZodNull:uu,ZodAny:wo,ZodUnknown:Jr,ZodNever:ni,ZodVoid:lu,ZodArray:$n,get objectUtil(){return hu},ZodObject:te,ZodUnion:Ea,ZodDiscriminatedUnion:Iu,ZodIntersection:Ta,ZodTuple:qn,ZodRecord:xa,ZodMap:fu,ZodSet:Di,ZodFunction:Fi,ZodLazy:cu,ZodLiteral:du,ZodEnum:Ou,ZodNativeEnum:pu,ZodPromise:Ro,ZodEffects:Jn,ZodTransformer:Jn,ZodOptional:Vn,ZodNullable:Ni,ZodDefault:af,ZodNaN:vu,custom:o_,Schema:Nt,ZodSchema:Nt,late:PA,get ZodFirstPartyTypeKind(){return Et},any:GA,array:XA,bigint:DA,boolean:u_,date:FA,discriminatedUnion:zA,effect:Op,enum:tP,function:qA,instanceof:LA,intersection:jA,lazy:JA,literal:QA,map:HA,nan:MA,nativeEnum:eP,never:UA,null:bA,nullable:iP,number:s_,object:BA,oboolean:uP,onumber:sP,optional:rP,ostring:aP,preprocess:oP,promise:nP,record:KA,set:$A,strictObject:YA,string:a_,transformer:Op,tuple:VA,undefined:NA,union:ZA,unknown:kA,void:WA,ZodIssueCode:q,quotelessJson:TA,ZodError:Er,defaultErrorMap:ya,get overrideErrorMap(){return ma},setErrorMap:xA});const wa=Rt.tuple([Rt.number(),Rt.number()]),l_=Rt.enum(["ImageService2","ImageService3"]),lP=/^<svg\s+width="\d+"\s+height="\d+"\s*>\s*<polygon\s+points="(\d+,\d+\s+){2,}\d+,\d+"\s*\/>\s*<\/svg>$/,hP=Rt.object({type:Rt.literal("SvgSelector"),value:Rt.string().regex(lP)}),fP=Rt.object({source:Rt.string().url(),service:Rt.array(Rt.object({"@id":Rt.string().url(),type:l_})).length(1),selector:hP}),cP=Rt.object({type:Rt.literal("FeatureCollection"),purpose:Rt.string().default("gcp-georeferencing").optional(),features:Rt.array(Rt.object({type:Rt.literal("Feature"),properties:Rt.object({pixelCoords:wa}),geometry:Rt.object({type:Rt.literal("Point"),coordinates:wa})}))}),h_=Rt.object({id:Rt.string().optional(),type:Rt.literal("Annotation"),"@context":Rt.string().url().array().optional(),motivation:Rt.string().default("georeferencing").optional(),target:fP,body:cP}),dP=Rt.object({id:Rt.string().optional(),type:Rt.literal("AnnotationPage"),"@context":Rt.string().url().array().optional(),items:Rt.array(h_)});function pP(i){return i.body.features.map(e=>({image:e.properties.pixelCoords,world:e.geometry.coordinates}))}function vP(i){var l,h;const t=i.target.selector.value,n=/width="(?<width>\d+)"/.exec(t),r=/height="(?<height>\d+)"/.exec(t),o=(l=n==null?void 0:n.groups)==null?void 0:l.width,u=(h=r==null?void 0:r.groups)==null?void 0:h.height;if(!o||!u)throw new Error("Could not parse image dimensions");return{width:parseInt(o),height:parseInt(u)}}function _P(i){return i.target.service[0]["@id"]}function gP(i){const t=i.target.selector.value,n=/points="(?<points>.+)"/.exec(t),r=n==null?void 0:n.groups;if(r&&r.points){const o=r.points.split(" ");if(o.length>=3)return o.map(u=>{const l=u.split(",");if(l.length===2)return[parseInt(l[0]),parseInt(l[1])];throw new Error("Could not parse pixel mask")});throw new Error("Could not parse pixel mask")}else throw new Error("Could not parse pixel mask")}function Sp(i){return{id:i.id,version:1,image:{uri:_P(i),type:"ImageService2",...vP(i)},pixelMask:gP(i),gcps:pP(i)}}function yP(i){if(i&&i.type==="AnnotationPage")try{return dP.parse(i).items.map(t=>Sp(t))}catch(e){throw e}else try{const e=h_.parse(i);return[Sp(e)]}catch(e){throw e}}const mP=Rt.object({image:wa,world:wa}),EP=Rt.object({uri:Rt.string().url(),width:Rt.number(),height:Rt.number(),type:l_}),TP=wa.array().min(3),xP=Rt.object({id:Rt.string().optional(),version:Rt.number().min(1).max(1).default(1),gcps:mP.array(),pixelMask:TP,image:EP});Rt.array(xP);const Ap=Number.POSITIVE_INFINITY,wP=3,Po={MPARMERR:"PARAMETER ERROR",MINTERR:"INTERNAL ERROR",MUNSOLVABLE:"NOT SOLVABLE",MNPTERR:"NOT ENOUGH POINTS"};class RP{constructor(e,t,n,r){this.dfGCPPixel=e,this.dfGCPLine=t,this.dfGCPX=n,this.dfGCPY=r}}class CP{constructor(){this.count=0,this.e1=[],this.n1=[],this.e2=[],this.n2=[],this.status=[]}}class IP{constructor(){this.x1Mean=0,this.y1Mean=0,this.x2Mean=0,this.y2Mean=0,this.bReversed=!1,this.nOrder=1,this.bRefine=!1,this.dfTolerance=-1,this.nMinimumGcps=-1,this.nRefCount=1,this.pasGCPList=[],this.nGCPCount=0,this.adfToGeoX=[],this.adfToGeoY=[],this.adfFromGeoX=[],this.adfFromGeoY=[],this.adfToGeoX=[],this.adfToGeoY=[],this.adfFromGeoX=[],this.adfFromGeoY=[]}}class OP{constructor(e=0){this.n=e,this.v=[]}getM(e,t){return this.v[(e-1)*this.n+t-1]}setM(e,t,n){this.v[(e-1)*this.n+t-1]=n}}function SP(i,e,t){return AP(i,e,t,!1,-1,-1)}function AP(i,e,t,n,r,o){const u=i.length;let l=new CP,h=0,c=0,d=0,_=0;e=1;const v=new IP;if(v.bReversed=t,v.nOrder=e,v.bRefine=n,v.dfTolerance=r,v.nMinimumGcps=o,v.nRefCount=1,v.pasGCPList=i,v.nGCPCount=u,u===0)throw new Error("NOT ENOUGH POINTS");if(n)throw new Error("remove_outliers not implemented");{let y=[],m=[],w=[],C=[],P=[];for(let I=0;I<u;I++)P[I]=1,y[I]=i[I].dfGCPX,m[I]=i[I].dfGCPY,w[I]=i[I].dfGCPPixel,C[I]=i[I].dfGCPLine,h+=i[I].dfGCPPixel,c+=i[I].dfGCPLine,d+=i[I].dfGCPX,_+=i[I].dfGCPY;v.x1Mean=h/u,v.y1Mean=c/u,v.x2Mean=d/u,v.y2Mean=_/u,l.count=u,l.e1=w,l.n1=C,l.e2=y,l.n2=m,l.status=P,PP(v,l,v.adfToGeoX,v.adfToGeoY,v.adfFromGeoX,v.adfFromGeoY,e)}return v}function PP(i,e,t,n,r,o,u){let l;if(u<1||u>wP)throw new Error(Po.MPARMERR);Pp(e,i.x1Mean,i.y1Mean,t,n,u),l=e.e1,e.e1=e.e2,e.e2=l,l=e.n1,e.n1=e.n2,e.n2=l,Pp(e,i.x2Mean,i.y2Mean,r,o,u),l=e.e1,e.e1=e.e2,e.e2=l,l=e.n1,e.n1=e.n2,e.n2=l}function Pp(i,e,t,n,r,o){const u=new OP;let l=[],h=[],c=0,d=0;for(d=c=0;d<i.count;d++)i.status[d]>0&&c++;if(u.n=(o+1)*(o+2)/2,c<u.n)throw new Error(Po.MNPTERR);u.v=[],c===u.n?MP(i,u,e,t,l,h,n,r):LP(i,u,e,t,l,h,n,r)}function LP(i,e,t,n,r,o,u,l){let h=0;for(let c=1;c<=e.n;c++){for(let d=c;d<=e.n;d++)e.setM(c,d,0);r[c-1]=o[c-1]=0}for(let c=0;c<i.count;c++)if(i.status[c]>0){h++;for(let d=1;d<=e.n;d++){for(let _=d;_<=e.n;_++)e.setM(d,_,e.getM(d,_)+aa(d,i.e1[c]-t,i.n1[c]-n)*aa(_,i.e1[c]-t,i.n1[c]-n));r[d-1]+=i.e2[c]*aa(d,i.e1[c]-t,i.n1[c]-n),o[d-1]+=i.n2[c]*aa(d,i.e1[c]-t,i.n1[c]-n)}}if(h<=e.n)throw new Error(Po.MINTERR);for(let c=2;c<=e.n;c++)for(let d=1;d<c;d++)e.setM(c,d,e.getM(d,c));return f_(e,r,o,u,l)}function MP(i,e,t,n,r,o,u,l){let h=1;for(let c=0;c<i.count;c++)if(i.status[c]>0){for(let d=1;d<=e.n;d++)e.setM(h,d,aa(d,i.e1[c]-t,i.n1[c]-n));r[h-1]=i.e2[c],o[h-1]=i.n2[c],h++}if(h-1!==e.n)throw new Error(Po.MINTERR);return f_(e,r,o,u,l)}function f_(i,e,t,n,r){for(let o=1;o<=i.n;o++){let u=o,l=i.getM(o,u),h=o;for(let c=o+1;c<=i.n;c++)Math.abs(i.getM(c,u))>Math.abs(l)&&(l=i.getM(c,u),h=c);if(l===0)throw new Error(Po.MUNSOLVABLE);if(h!==o){for(let y=1;y<=i.n;y++){const m=i.getM(h,y),w=i.getM(o,y);i.setM(h,y,w),i.setM(o,y,m)}const c=e[h-1],d=e[o-1];e[o-1]=c,e[h-1]=d;const _=t[h-1],v=t[o-1];t[h-1]=v,t[o-1]=_}for(let c=1;c<=i.n;c++)if(c!==o){const d=i.getM(c,u)/l;for(let _=u;_<=i.n;_++){const v=d*i.getM(o,_);i.setM(c,_,i.getM(c,_)-v)}e[c-1]-=d*e[o-1],t[c-1]-=d*t[o-1]}}for(let o=1;o<=i.n;o++)n[o-1]=e[o-1]/i.getM(o,o),r[o-1]=t[o-1]/i.getM(o,o)}function aa(i,e,t){switch(i){case 1:return 1;case 2:return e;case 3:return t;case 4:return e*e;case 5:return e*t;case 6:return t*t;case 7:return e*e*e;case 8:return e*e*t;case 9:return e*t*t;case 10:return t*t*t}return 0}function DP(i,e,t){const n=t.length,r=i,o=[];r.bReversed&&(e=!e);for(let u=0;u<n;u++){if(t[u].x===Ap||t[u].y===Ap)throw new Error("HUGE_VAL");let l;e?l=Lp(t[u].x-r.x2Mean,t[u].y-r.y2Mean,r.adfFromGeoX,r.adfFromGeoY,r.nOrder):l=Lp(t[u].x-r.x1Mean,t[u].y-r.y1Mean,r.adfToGeoX,r.adfToGeoY,r.nOrder),o[u]={x:l[0],y:l[1]}}return o}function Lp(i,e,t,n,r){let o=0,u=0,l=0,h=0,c=0,d=0,_=0,v,y;if(r===1)return v=t[0]+t[1]*i+t[2]*e,y=n[0]+n[1]*i+n[2]*e,[v,y];if(r===2)return c=i*i,_=e*e,d=i*e,v=t[0]+t[1]*i+t[2]*e+t[3]*c+t[4]*d+t[5]*_,y=n[0]+n[1]*i+n[2]*e+n[3]*c+n[4]*d+n[5]*_,[v,y];if(r===3)return c=i*i,d=i*e,_=e*e,o=i*c,u=c*e,l=i*_,h=e*_,v=t[0]+t[1]*i+t[2]*e+t[3]*c+t[4]*d+t[5]*_+t[6]*o+t[7]*u+t[8]*l+t[9]*h,y=n[0]+n[1]*i+n[2]*e+n[3]*c+n[4]*d+n[5]*_+n[6]*o+n[7]*u+n[8]*l+n[9]*h,[v,y];throw new Error(Po.MPARMERR)}function c_(i,e){const n=[{x:e[0],y:e[1]}],r=DP(i,!1,n);return[r[0].y,r[0].x]}function FP(i){const e=i.map(n=>new RP(n.image[0],n.image[1],n.world[1],n.world[0]));return SP(e,0,!1)}var Ve=63710088e-1,d_={centimeters:Ve*100,centimetres:Ve*100,degrees:Ve/111325,feet:Ve*3.28084,inches:Ve*39.37,kilometers:Ve/1e3,kilometres:Ve/1e3,meters:Ve,metres:Ve,miles:Ve/1609.344,millimeters:Ve*1e3,millimetres:Ve*1e3,nauticalmiles:Ve/1852,radians:1,yards:Ve*1.0936};function NP(i,e,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=e||{},n.geometry=i,n}function bP(i,e,t){if(t===void 0&&(t={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Mp(i[0])||!Mp(i[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:i};return NP(n,e,t)}function GP(i,e){e===void 0&&(e="kilometers");var t=d_[e];if(!t)throw new Error(e+" units is invalid");return i*t}function kP(i,e){e===void 0&&(e="kilometers");var t=d_[e];if(!t)throw new Error(e+" units is invalid");return i/t}function Sh(i){var e=i%(2*Math.PI);return e*180/Math.PI}function Fn(i){var e=i%360;return e*Math.PI/180}function Mp(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Ra(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function p_(i,e,t){if(t===void 0&&(t={}),t.final===!0)return UP(i,e);var n=Ra(i),r=Ra(e),o=Fn(n[0]),u=Fn(r[0]),l=Fn(n[1]),h=Fn(r[1]),c=Math.sin(u-o)*Math.cos(h),d=Math.cos(l)*Math.sin(h)-Math.sin(l)*Math.cos(h)*Math.cos(u-o);return Sh(Math.atan2(c,d))}function UP(i,e){var t=p_(e,i);return t=(t+180)%360,t}function WP(i,e,t,n){n===void 0&&(n={});var r=Ra(i),o=Fn(r[0]),u=Fn(r[1]),l=Fn(t),h=kP(e,n.units),c=Math.asin(Math.sin(u)*Math.cos(h)+Math.cos(u)*Math.sin(h)*Math.cos(l)),d=o+Math.atan2(Math.sin(l)*Math.sin(h)*Math.cos(u),Math.cos(h)-Math.sin(u)*Math.sin(c)),_=Sh(d),v=Sh(c);return bP([_,v],n.properties)}function Ah(i,e,t){t===void 0&&(t={});var n=Ra(i),r=Ra(e),o=Fn(r[1]-n[1]),u=Fn(r[0]-n[0]),l=Fn(n[1]),h=Fn(r[1]),c=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(h);return GP(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),t.units)}function XP(i,e){var t=Ah(i,e),n=p_(i,e),r=WP(i,t/2,n);return r}function ea(i){return{type:"Point",coordinates:i}}function BP(i,e,t=.01,n=8){const r=e.map(l=>({image:l,world:c_(i,l)})),u=Array.from(Array(r.length-1)).map((l,h)=>({from:r[h],to:r[h+1]})).map(l=>Ph(i,l,t,n)).flat(1);return{type:"Polygon",coordinates:[[u[0].from.world,...u.map(l=>l.to.world)]]}}function Ph(i,e,t,n,r=0){const o=[(e.from.image[0]+e.to.image[0])/2,(e.from.image[1]+e.to.image[1])/2],u=XP(ea(e.from.world),ea(e.to.world)),l=ea(c_(i,o)),h=Ah(ea(e.from.world),ea(e.to.world));if(Ah(u,l)/h>t&&r<n){const d={image:o,world:l.coordinates};return[Ph(i,{from:e.from,to:d},t,r+1),Ph(i,{from:d,to:e.to},t,r+1)].flat(1)}else return e}const{window:Dp}=Nx;function Fp(i,e,t){const n=i.slice();return n[24]=e[t],n[26]=t,n}function Np(i){let e,t=i[24].title+"",n,r,o;function u(){return i[11](i[26])}return{c(){e=oe("button"),n=dr(t),this.h()},l(l){e=ae(l,"BUTTON",{class:!0});var h=Me(e);n=pr(h,t),h.forEach(de),this.h()},h(){Ot(e,"class","svelte-17ongm")},m(l,h){Xs(l,e,h),Ft(e,n),r||(o=Dn(e,"click",u),r=!0)},p(l,h){i=l,h&32&&t!==(t=i[24].title+"")&&Lx(n,t)},d(l){l&&de(e),r=!1,o()}}}function YP(i){let e,t,n,r,o,u,l,h,c,d,_,v,y,m,w,C,P,I,A,L,F,U,G,X,B,Z,j,V,tt,rt,H,Q,K,nt,ut,mt,pt,W,Kt,lt=i[5],_t=[];for(let dt=0;dt<lt.length;dt+=1)_t[dt]=Np(Fp(i,lt,dt));return{c(){e=oe("div"),t=oe("div"),n=Nr(),r=oe("footer"),o=oe("div"),u=oe("h1"),l=dr("Preview of new render module for "),h=oe("a"),c=dr("Allmaps"),d=dr(":"),_=Nr(),v=oe("div"),y=dr("Move map to ");for(let dt=0;dt<_t.length;dt+=1)_t[dt].c();m=Nr(),w=oe("hr"),C=Nr(),P=oe("div"),I=oe("label"),A=dr(`Opacity (press Space to toggle):
        `),L=oe("input"),F=Nr(),U=oe("div"),G=oe("label"),X=dr(`Remove background color:
        `),B=oe("input"),Z=Nr(),j=oe("input"),V=Nr(),tt=oe("div"),rt=oe("label"),H=dr(`Base layer opacity:
        `),Q=oe("input"),K=Nr(),nt=oe("div"),ut=oe("label"),mt=dr(`Show image outlines:
        `),pt=oe("input"),this.h()},l(dt){e=ae(dt,"DIV",{class:!0});var Ut=Me(e);t=ae(Ut,"DIV",{id:!0,class:!0}),Me(t).forEach(de),Ut.forEach(de),n=br(dt),r=ae(dt,"FOOTER",{class:!0});var xt=Me(r);o=ae(xt,"DIV",{class:!0});var St=Me(o);u=ae(St,"H1",{class:!0});var $e=Me(u);l=pr($e,"Preview of new render module for "),h=ae($e,"A",{href:!0,class:!0});var Ee=Me(h);c=pr(Ee,"Allmaps"),Ee.forEach(de),d=pr($e,":"),$e.forEach(de),_=br(St),v=ae(St,"DIV",{class:!0});var qe=Me(v);y=pr(qe,"Move map to ");for(let ce=0;ce<_t.length;ce+=1)_t[ce].l(qe);qe.forEach(de),m=br(St),w=ae(St,"HR",{class:!0}),C=br(St),P=ae(St,"DIV",{class:!0});var kn=Me(P);I=ae(kn,"LABEL",{class:!0});var Jt=Me(I);A=pr(Jt,`Opacity (press Space to toggle):
        `),L=ae(Jt,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),Jt.forEach(de),kn.forEach(de),F=br(St),U=ae(St,"DIV",{class:!0});var Ne=Me(U);G=ae(Ne,"LABEL",{class:!0});var un=Me(G);X=pr(un,`Remove background color:
        `),B=ae(un,"INPUT",{type:!0,class:!0}),Z=br(un),j=ae(un,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),un.forEach(de),Ne.forEach(de),V=br(St),tt=ae(St,"DIV",{class:!0});var Te=Me(tt);rt=ae(Te,"LABEL",{class:!0});var wn=Me(rt);H=pr(wn,`Base layer opacity:
        `),Q=ae(wn,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),wn.forEach(de),Te.forEach(de),K=br(St),nt=ae(St,"DIV",{class:!0});var ln=Me(nt);ut=ae(ln,"LABEL",{class:!0});var be=Me(ut);mt=pr(be,`Show image outlines:
        `),pt=ae(be,"INPUT",{type:!0,class:!0}),be.forEach(de),ln.forEach(de),St.forEach(de),xt.forEach(de),this.h()},h(){Ot(t,"id","ol"),Ot(t,"class","svelte-17ongm"),Ot(e,"class","container svelte-17ongm"),Ot(h,"href","https://allmaps.org"),Ot(h,"class","svelte-17ongm"),Ot(u,"class","svelte-17ongm"),Ot(v,"class","svelte-17ongm"),Ot(w,"class","svelte-17ongm"),Ot(L,"type","range"),Ot(L,"min","0"),Ot(L,"max","1"),Ot(L,"step","0.01"),Ot(L,"class","svelte-17ongm"),Ot(I,"class","svelte-17ongm"),Ot(P,"class","svelte-17ongm"),Ot(B,"type","color"),Ot(B,"class","svelte-17ongm"),Ot(j,"type","range"),Ot(j,"min","0"),Ot(j,"max","1"),Ot(j,"step","0.01"),Ot(j,"class","svelte-17ongm"),Ot(G,"class","svelte-17ongm"),Ot(U,"class","svelte-17ongm"),Ot(Q,"type","range"),Ot(Q,"min","0"),Ot(Q,"max","1"),Ot(Q,"step","0.01"),Ot(Q,"class","svelte-17ongm"),Ot(rt,"class","svelte-17ongm"),Ot(tt,"class","svelte-17ongm"),Ot(pt,"type","checkbox"),Ot(pt,"class","svelte-17ongm"),Ot(ut,"class","svelte-17ongm"),Ot(nt,"class","svelte-17ongm"),Ot(o,"class","controls svelte-17ongm"),Ot(r,"class","svelte-17ongm")},m(dt,Ut){Xs(dt,e,Ut),Ft(e,t),Xs(dt,n,Ut),Xs(dt,r,Ut),Ft(r,o),Ft(o,u),Ft(u,l),Ft(u,h),Ft(h,c),Ft(u,d),Ft(o,_),Ft(o,v),Ft(v,y);for(let xt=0;xt<_t.length;xt+=1)_t[xt].m(v,null);Ft(o,m),Ft(o,w),Ft(o,C),Ft(o,P),Ft(P,I),Ft(I,A),Ft(I,L),Gr(L,i[0]),Ft(o,F),Ft(o,U),Ft(U,G),Ft(G,X),Ft(G,B),Gr(B,i[3]),Ft(G,Z),Ft(G,j),Gr(j,i[2]),Ft(o,V),Ft(o,tt),Ft(tt,rt),Ft(rt,H),Ft(rt,Q),Gr(Q,i[1]),Ft(o,K),Ft(o,nt),Ft(nt,ut),Ft(ut,mt),Ft(ut,pt),pt.checked=i[4],W||(Kt=[Dn(Dp,"keydown",i[7]),Dn(Dp,"keyup",i[8]),Dn(L,"change",i[12]),Dn(L,"input",i[12]),Dn(B,"input",i[13]),Dn(j,"change",i[14]),Dn(j,"input",i[14]),Dn(Q,"change",i[15]),Dn(Q,"input",i[15]),Dn(pt,"change",i[16])],W=!0)},p(dt,[Ut]){if(Ut&96){lt=dt[5];let xt;for(xt=0;xt<lt.length;xt+=1){const St=Fp(dt,lt,xt);_t[xt]?_t[xt].p(St,Ut):(_t[xt]=Np(St),_t[xt].c(),_t[xt].m(v,null))}for(;xt<_t.length;xt+=1)_t[xt].d(1);_t.length=lt.length}Ut&1&&Gr(L,dt[0]),Ut&8&&Gr(B,dt[3]),Ut&4&&Gr(j,dt[2]),Ut&2&&Gr(Q,dt[1]),Ut&16&&(pt.checked=dt[4])},i:Md,o:Md,d(dt){dt&&de(e),dt&&de(n),dt&&de(r),Mx(_t,dt),W=!1,Dx(Kt)}}}function ZP(i,e,t){let n,r,o,u,l,h=[],c=1,d=1,_=0,v="#f2e7e0",y=!1,m=[];async function w(Z,j){const tt=await(await fetch(Z)).json(),rt=yP(tt);for(let H of rt){l.addMap(H);const Q=H.gcps,K=FP(Q),nt=BP(K,[...H.pixelMask,H.pixelMask[H.pixelMask.length-1]],.01,0),ut={type:"Feature",properties:{uri:H.image.uri},geometry:nt};j.addFeature(new oA().readFeature(ut,{featureProjection:"EPSG:3857"}))}}async function C(Z){const j=new IO,V=new Yv({visible:!1,source:j,style:yA});n.addLayer(V),h.push(V);for(let tt of Z.annotationUrls)await w(tt,j)}function P(Z){const V=h[Z].getSource().getExtent();n.getView().fit(V)}Fx(async()=>{const Z="https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}";r=new NS({url:Z,maxZoom:19}),t(9,o=new oS({source:r})),l=new gA,t(10,u=new cA({source:l})),n=new NO({layers:[o,u],target:"ol",view:new jr({center:C1([-71.13,42.2895]),maxZoom:22,zoom:17})});const j=new LO({style:mA});n.addInteraction(j),j.on("select",V=>{const H=`https://observablehq.com/@bertspaan/iiif-openseadragon?url=${V.selected[0].get("uri")}/info.json`;window.open(H,"_blank").focus()}),t(5,m=await fetch("layers.json").then(V=>V.json()));for(let V of m)C(V)});function I(Z){Z.code==="Space"&&t(0,c=0)}function A(Z){Z.code==="Space"&&t(0,c=1)}const L=Z=>P(Z);function F(){c=Wl(this.value),t(0,c)}function U(){v=this.value,t(3,v)}function G(){_=Wl(this.value),t(2,_)}function X(){d=Wl(this.value),t(1,d)}function B(){y=this.checked,t(4,y)}return i.$$.update=()=>{if(i.$$.dirty&1025&&(u==null||u.setOpacity(c)),i.$$.dirty&514&&(o==null||o.setOpacity(d)),i.$$.dirty&1036&&(u==null||u.hideBackgroundColor(v,_)),i.$$.dirty&16)for(let Z of h)Z.setVisible(y)},[c,d,_,v,y,m,P,I,A,o,u,L,F,U,G,X,B]}class jP extends Sx{constructor(e){super(),Ax(this,e,ZP,YP,Px,{})}}export{jP as default};
